var P=Object.defineProperty;var o=(a,e)=>P(a,"name",{value:e,configurable:!0});var w="registered as custom element";function U(a,e){console.warn(`missing implementation for ${e}(...data) in ${a.__proto__.constructor.name}`)}o(U,"NotImplemented");function C(a){return a.prototype.constructor.name.replace(/([A-Z])([a-z])/g,(e,r,t,$)=>{let x=`${r.toLowerCase()}${t}`;return $>0?`-${x}`:x})}o(C,"getElementTagName");var E=class extends HTMLElement{static{o(this,"CustomElement")}static register(e){if(!e[w]){let r=e.tagName||C(e);return customElements.define(r,e),e[w]=!0,customElements.whenDefined(r)}return Promise.resolve()}static get tagName(){return C(this)}constructor(e={}){super(),customElements.resolveScope||(customElements.resolveScope=function($){try{return $.getRootNode().host}catch(x){console.warn(x)}return window}),this._options=e;let r={childList:$=>{this.handleChildChanges(Array.from($.addedNodes),Array.from($.removedNodes)),this.render()},attributes:$=>{this.handleAttributeChange($.attributeName,$.oldValue,this.getAttribute($.attributeName)),this.render()}};this._observer=new MutationObserver($=>{this.isConnected&&$.forEach(x=>{r[x.type](x)})}),this._observer.observe(this,{childList:!0,attributes:!0});let t={mode:"open"};this._shadow=this.attachShadow(t),this._style=document.createElement("style"),this._style.textContent=this.getStyle(),this._options.header!==!1&&(this._header=document.createElement("header")),this._options.slot!==!1&&this._options.void!==!0&&(this._slot=document.createElement("slot")),this._options.footer!==!1&&(this._footer=document.createElement("footer"))}connectedCallback(){this.render()}handleChildChanges(e,r){this._options.void||U(this,"handleChildChanges")}handleAttributeChange(e,r,t){U(this,"handleAttributeChange")}getStyle(){return""}render(){this._shadow.innerHTML="",this._shadow.append(this._style),this._options.header!==!1&&this._shadow.append(this._header),this._options.slot!==!1&&this._shadow.append(this._slot),this._options.footer!==!1&&this._shadow.append(this._footer)}};var D=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","transparent","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","ALICEBLUE","ANTIQUEWHITE","AQUA","AQUAMARINE","AZURE","BEIGE","BISQUE","BLACK","BLANCHEDALMOND","BLUE","BLUEVIOLET","BROWN","BURLYWOOD","CADETBLUE","CHARTREUSE","CHOCOLATE","CORAL","CORNFLOWERBLUE","CORNSILK","CRIMSON","CYAN","DARKBLUE","DARKCYAN","DARKGOLDENROD","DARKGRAY","DARKGREEN","DARKGREY","DARKKHAKI","DARKMAGENTA","DARKOLIVEGREEN","DARKORANGE","DARKORCHID","DARKRED","DARKSALMON","DARKSEAGREEN","DARKSLATEBLUE","DARKSLATEGRAY","DARKSLATEGREY","DARKTURQUOISE","DARKVIOLET","DEEPPINK","DEEPSKYBLUE","DIMGRAY","DIMGREY","DODGERBLUE","FIREBRICK","FLORALWHITE","FORESTGREEN","FUCHSIA","GAINSBORO","GHOSTWHITE","GOLD","GOLDENROD","GRAY","GREEN","GREENYELLOW","GREY","HONEYDEW","HOTPINK","INDIANRED","INDIGO","IVORY","KHAKI","LAVENDER","LAVENDERBLUSH","LAWNGREEN","LEMONCHIFFON","LIGHTBLUE","LIGHTCORAL","LIGHTCYAN","LIGHTGOLDENRODYELLOW","LIGHTGRAY","LIGHTGREEN","LIGHTGREY","LIGHTPINK","LIGHTSALMON","LIGHTSEAGREEN","LIGHTSKYBLUE","LIGHTSLATEGRAY","LIGHTSLATEGREY","LIGHTSTEELBLUE","LIGHTYELLOW","LIME","LIMEGREEN","LINEN","MAGENTA","MAROON","MEDIUMAQUAMARINE","MEDIUMBLUE","MEDIUMORCHID","MEDIUMPURPLE","MEDIUMSEAGREEN","MEDIUMSLATEBLUE","MEDIUMSPRINGGREEN","MEDIUMTURQUOISE","MEDIUMVIOLETRED","MIDNIGHTBLUE","MINTCREAM","MISTYROSE","MOCCASIN","NAVAJOWHITE","NAVY","OLDLACE","OLIVE","OLIVEDRAB","ORANGE","ORANGERED","ORCHID","PALEGOLDENROD","PALEGREEN","PALETURQUOISE","PALEVIOLETRED","PAPAYAWHIP","PEACHPUFF","PERU","PINK","PLUM","POWDERBLUE","PURPLE","REBECCAPURPLE","RED","ROSYBROWN","ROYALBLUE","SADDLEBROWN","SALMON","SANDYBROWN","SEAGREEN","SEASHELL","SIENNA","SILVER","SKYBLUE","SLATEBLUE","SLATEGRAY","SLATEGREY","SNOW","SPRINGGREEN","STEELBLUE","TAN","TEAL","THISTLE","TOMATO","TRANSPARENT","TURQUOISE","VIOLET","WHEAT","WHITE","WHITESMOKE","YELLOW","YELLOWGREEN"],v={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",aqua:"rgb(0, 255, 255)",aquamarine:"rgb(127, 255, 212)",azure:"rgb(240, 255, 255)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",black:"rgb(0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb(0, 0, 255)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",burlywood:"rgb(222, 184, 135)",cadetblue:"rgb(95, 158, 160)",chartreuse:"rgb(127, 255, 0)",chocolate:"rgb(210, 105, 30)",coral:"rgb(255, 127, 80)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",crimson:"rgb(220, 20, 60)",cyan:"rgb(0, 255, 255)",darkblue:"rgb(0, 0, 139)",darkcyan:"rgb(0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb(0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb(85, 107, 47)",darkorange:"rgb(255, 140, 0)",darkorchid:"rgb(153, 50, 204)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkslateblue:"rgb(72, 61, 139)",darkslategray:"rgb(47, 79, 79)",darkslategrey:"rgb(47, 79, 79)",darkturquoise:"rgb(0, 206, 209)",darkviolet:"rgb(148, 0, 211)",deeppink:"rgb(255, 20, 147)",deepskyblue:"rgb(0, 191, 255)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb(30, 144, 255)",firebrick:"rgb(178, 34, 34)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb(34, 139, 34)",fuchsia:"rgb(255, 0, 255)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",goldenrod:"rgb(218, 165, 32)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",greenyellow:"rgb(173, 255, 47)",grey:"rgb(128, 128, 128)",honeydew:"rgb(240, 255, 240)",hotpink:"rgb(255, 105, 180)",indianred:"rgb(205, 92, 92)",indigo:"rgb(75, 0, 130)",ivory:"rgb(255, 255, 240)",khaki:"rgb(240, 230, 140)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lightblue:"rgb(173, 216, 230)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightsalmon:"rgb(255, 160, 122)",lightseagreen:"rgb(32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightyellow:"rgb(255, 255, 224)",lime:"rgb(0, 255, 0)",limegreen:"rgb(50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",maroon:"rgb(128, 0, 0)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb(0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumpurple:"rgb(147, 112, 219)",mediumseagreen:"rgb(60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb(0, 250, 154)",mediumturquoise:"rgb(72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb(25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navy:"rgb(0, 0, 128)",oldlace:"rgb(253, 245, 230)",olive:"rgb(128, 128, 0)",olivedrab:"rgb(107, 142, 35)",orange:"rgb(255, 165, 0)",orangered:"rgb(255, 69, 0)",orchid:"rgb(218, 112, 214)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",paleturquoise:"rgb(175, 238, 238)",palevioletred:"rgb(219, 112, 147)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",plum:"rgb(221, 160, 221)",powderblue:"rgb(176, 224, 230)",purple:"rgb(128, 0, 128)",rebeccapurple:"rgb(102, 51, 153)",red:"rgb(255, 0, 0)",rosybrown:"rgb(188, 143, 143)",royalblue:"rgb(65, 105, 225)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb(46, 139, 87)",seashell:"rgb(255, 245, 238)",sienna:"rgb(160, 82, 45)",silver:"rgb(192, 192, 192)",skyblue:"rgb(135, 206, 235)",slateblue:"rgb(106, 90, 205)",slategray:"rgb(112, 128, 144)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",springgreen:"rgb(0, 255, 127)",steelblue:"rgb(70, 130, 180)",tan:"rgb(210, 180, 140)",teal:"rgb(0, 128, 128)",thistle:"rgb(216, 191, 216)",tomato:"rgb(255, 99, 71)",transparent:"rgba(0,0,0,0)",turquoise:"rgb(64, 224, 208)",violet:"rgb(238, 130, 238)",wheat:"rgb(245, 222, 179)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellowgreen:"rgb(154, 205, 50)",ALICEBLUE:"rgb(240, 248, 255)",ANTIQUEWHITE:"rgb(250, 235, 215)",AQUA:"rgb(0, 255, 255)",AQUAMARINE:"rgb(127, 255, 212)",AZURE:"rgb(240, 255, 255)",BEIGE:"rgb(245, 245, 220)",BISQUE:"rgb(255, 228, 196)",BLACK:"rgb(0, 0, 0)",BLANCHEDALMOND:"rgb(255, 235, 205)",BLUE:"rgb(0, 0, 255)",BLUEVIOLET:"rgb(138, 43, 226)",BROWN:"rgb(165, 42, 42)",BURLYWOOD:"rgb(222, 184, 135)",CADETBLUE:"rgb(95, 158, 160)",CHARTREUSE:"rgb(127, 255, 0)",CHOCOLATE:"rgb(210, 105, 30)",CORAL:"rgb(255, 127, 80)",CORNFLOWERBLUE:"rgb(100, 149, 237)",CORNSILK:"rgb(255, 248, 220)",CRIMSON:"rgb(220, 20, 60)",CYAN:"rgb(0, 255, 255)",DARKBLUE:"rgb(0, 0, 139)",DARKCYAN:"rgb(0, 139, 139)",DARKGOLDENROD:"rgb(184, 134, 11)",DARKGRAY:"rgb(169, 169, 169)",DARKGREEN:"rgb(0, 100, 0)",DARKGREY:"rgb(169, 169, 169)",DARKKHAKI:"rgb(189, 183, 107)",DARKMAGENTA:"rgb(139, 0, 139)",DARKOLIVEGREEN:"rgb(85, 107, 47)",DARKORANGE:"rgb(255, 140, 0)",DARKORCHID:"rgb(153, 50, 204)",DARKRED:"rgb(139, 0, 0)",DARKSALMON:"rgb(233, 150, 122)",DARKSEAGREEN:"rgb(143, 188, 143)",DARKSLATEBLUE:"rgb(72, 61, 139)",DARKSLATEGRAY:"rgb(47, 79, 79)",DARKSLATEGREY:"rgb(47, 79, 79)",DARKTURQUOISE:"rgb(0, 206, 209)",DARKVIOLET:"rgb(148, 0, 211)",DEEPPINK:"rgb(255, 20, 147)",DEEPSKYBLUE:"rgb(0, 191, 255)",DIMGRAY:"rgb(105, 105, 105)",DIMGREY:"rgb(105, 105, 105)",DODGERBLUE:"rgb(30, 144, 255)",FIREBRICK:"rgb(178, 34, 34)",FLORALWHITE:"rgb(255, 250, 240)",FORESTGREEN:"rgb(34, 139, 34)",FUCHSIA:"rgb(255, 0, 255)",GAINSBORO:"rgb(220, 220, 220)",GHOSTWHITE:"rgb(248, 248, 255)",GOLD:"rgb(255, 215, 0)",GOLDENROD:"rgb(218, 165, 32)",GRAY:"rgb(128, 128, 128)",GREEN:"rgb(0, 128, 0)",GREENYELLOW:"rgb(173, 255, 47)",GREY:"rgb(128, 128, 128)",HONEYDEW:"rgb(240, 255, 240)",HOTPINK:"rgb(255, 105, 180)",INDIANRED:"rgb(205, 92, 92)",INDIGO:"rgb(75, 0, 130)",IVORY:"rgb(255, 255, 240)",KHAKI:"rgb(240, 230, 140)",LAVENDER:"rgb(230, 230, 250)",LAVENDERBLUSH:"rgb(255, 240, 245)",LAWNGREEN:"rgb(124, 252, 0)",LEMONCHIFFON:"rgb(255, 250, 205)",LIGHTBLUE:"rgb(173, 216, 230)",LIGHTCORAL:"rgb(240, 128, 128)",LIGHTCYAN:"rgb(224, 255, 255)",LIGHTGOLDENRODYELLOW:"rgb(250, 250, 210)",LIGHTGRAY:"rgb(211, 211, 211)",LIGHTGREEN:"rgb(144, 238, 144)",LIGHTGREY:"rgb(211, 211, 211)",LIGHTPINK:"rgb(255, 182, 193)",LIGHTSALMON:"rgb(255, 160, 122)",LIGHTSEAGREEN:"rgb(32, 178, 170)",LIGHTSKYBLUE:"rgb(135, 206, 250)",LIGHTSLATEGRAY:"rgb(119, 136, 153)",LIGHTSLATEGREY:"rgb(119, 136, 153)",LIGHTSTEELBLUE:"rgb(176, 196, 222)",LIGHTYELLOW:"rgb(255, 255, 224)",LIME:"rgb(0, 255, 0)",LIMEGREEN:"rgb(50, 205, 50)",LINEN:"rgb(250, 240, 230)",MAGENTA:"rgb(255, 0, 255)",MAROON:"rgb(128, 0, 0)",MEDIUMAQUAMARINE:"rgb(102, 205, 170)",MEDIUMBLUE:"rgb(0, 0, 205)",MEDIUMORCHID:"rgb(186, 85, 211)",MEDIUMPURPLE:"rgb(147, 112, 219)",MEDIUMSEAGREEN:"rgb(60, 179, 113)",MEDIUMSLATEBLUE:"rgb(123, 104, 238)",MEDIUMSPRINGGREEN:"rgb(0, 250, 154)",MEDIUMTURQUOISE:"rgb(72, 209, 204)",MEDIUMVIOLETRED:"rgb(199, 21, 133)",MIDNIGHTBLUE:"rgb(25, 25, 112)",MINTCREAM:"rgb(245, 255, 250)",MISTYROSE:"rgb(255, 228, 225)",MOCCASIN:"rgb(255, 228, 181)",NAVAJOWHITE:"rgb(255, 222, 173)",NAVY:"rgb(0, 0, 128)",OLDLACE:"rgb(253, 245, 230)",OLIVE:"rgb(128, 128, 0)",OLIVEDRAB:"rgb(107, 142, 35)",ORANGE:"rgb(255, 165, 0)",ORANGERED:"rgb(255, 69, 0)",ORCHID:"rgb(218, 112, 214)",PALEGOLDENROD:"rgb(238, 232, 170)",PALEGREEN:"rgb(152, 251, 152)",PALETURQUOISE:"rgb(175, 238, 238)",PALEVIOLETRED:"rgb(219, 112, 147)",PAPAYAWHIP:"rgb(255, 239, 213)",PEACHPUFF:"rgb(255, 218, 185)",PERU:"rgb(205, 133, 63)",PINK:"rgb(255, 192, 203)",PLUM:"rgb(221, 160, 221)",POWDERBLUE:"rgb(176, 224, 230)",PURPLE:"rgb(128, 0, 128)",REBECCAPURPLE:"rgb(102, 51, 153)",RED:"rgb(255, 0, 0)",ROSYBROWN:"rgb(188, 143, 143)",ROYALBLUE:"rgb(65, 105, 225)",SADDLEBROWN:"rgb(139, 69, 19)",SALMON:"rgb(250, 128, 114)",SANDYBROWN:"rgb(244, 164, 96)",SEAGREEN:"rgb(46, 139, 87)",SEASHELL:"rgb(255, 245, 238)",SIENNA:"rgb(160, 82, 45)",SILVER:"rgb(192, 192, 192)",SKYBLUE:"rgb(135, 206, 235)",SLATEBLUE:"rgb(106, 90, 205)",SLATEGRAY:"rgb(112, 128, 144)",SLATEGREY:"rgb(112, 128, 144)",SNOW:"rgb(255, 250, 250)",SPRINGGREEN:"rgb(0, 255, 127)",STEELBLUE:"rgb(70, 130, 180)",TAN:"rgb(210, 180, 140)",TEAL:"rgb(0, 128, 128)",THISTLE:"rgb(216, 191, 216)",TOMATO:"rgb(255, 99, 71)",TRANSPARENT:"rgba(0,0,0,0)",TURQUOISE:"rgb(64, 224, 208)",VIOLET:"rgb(238, 130, 238)",WHEAT:"rgb(245, 222, 179)",WHITE:"rgb(255, 255, 255)",WHITESMOKE:"rgb(245, 245, 245)",YELLOW:"rgb(255, 255, 0)",YELLOWGREEN:"rgb(154, 205, 50)"};function y(a,e,r,t,$,m,g){var i,n,s,f,d=r.length,h=r[0].length;if(e<1)throw new Error("degree must be at least 1 (linear)");if(e>d-1)throw new Error("degree must be less than or equal to point count - 1");if(!$)for($=[],i=0;i<d;i++)$[i]=1;if($.length<r.length&&($=$.concat($.slice(0,e))),t){if(t.length!==d+e+1)throw new Error("bad knot vector length")}else{var t=[];for(i=0;i<d+e+1;i++)t[i]=i}t.length===r.length&&(t=t.concat(t.slice(0,e)));var u=[e,t.length-1-e],L=t[u[0]],A=t[u[1]];if(g||(a=a*(A-L)+L),a<L||a>A)throw new Error("out of bounds");for(s=u[0];s<u[1]&&!(a>=t[s]&&a<=t[s+1]);s++);var l=[];for(i=0;i<d;i++){for(l[i]=[],n=0;n<h;n++)l[i][n]=r[i][n]*$[i];l[i][h]=$[i]}var b;for(f=1;f<=e+1;f++)for(i=s;i>s-e-1+f;i--)for(b=(a-t[i])/(t[i+e+1-f]-t[i]),n=0;n<h+1;n++)l[i][n]=(1-b)*l[i-1][n]+b*l[i][n];var m=m||[];for(i=0;i<h;i++)m[i]=l[s][i]/l[s][h];return m}o(y,"interpolate");var c=3,R=class{static{o(this,"BSpline")}constructor(e,r=!0){this.points=e,this.points=e.map(t=>t instanceof Array?t:[t.x,t.y]),this.formKnots(r),this.formWeights()}getLUT(e=100){let r=e-1;return[...new Array(e)].map((t,$)=>{let x=y($/r,c,this.points,this.knots,this.weights);return{x:x[0],y:x[1]}})}formKnots(e=!1){if(!e)return this.formUniformKnots();let r=[],t=this.points.length,$=t-c;for(let x=1;x<t-c;x++)r.push(x+c);for(let x=0;x<=c;x++)r=[c].concat(r);for(let x=0;x<=c;x++)r.push($+c);return this.knots=r}formUniformKnots(){return this.knots=[...new Array(this.points.length+c+1)].map((e,r)=>r)}formWeights(){return this.weights=this.points.map(e=>1)}};var p=class{static{o(this,"Point")}constructor(e,r){this.x=e,this.y=r}},O=class extends p{static{o(this,"Circle")}constructor(e,r,t){super(e,r),this.r=t}};var I=class a{static{o(this,"Vector")}constructor(e,r,t){arguments.length===1&&(t=e.z,r=e.y,e=e.x),this.x=e,this.y=r,t!==void 0&&(this.z=t)}dist(e,r,t=0){r!==void 0&&(e={x:e,y:r,z:t});let $=0;$+=(this.x-e.x)**2,$+=(this.y-e.y)**2;let x=this.z?this.z:0,g=e.z?e.z:0;return $+=(x-g)**2,$**.5}normalize(e){let r=this.dist(0,0,0);return new a(e*this.x/r,e*this.y/r,e*this.z/r)}getAngle(){return-Math.atan2(this.y,this.x)}reflect(e){let r=new a(e.x-this.x,e.y-this.y);return e.z!==void 0&&(r.z=e.z,this.z!==void 0&&(r.z-=this.z)),this.subtract(r)}add(e){let r=new a(this.x+e.x,this.y+e.y);return this.z!==void 0&&(r.z=this.z,e.z!==void 0&&(r.z+=e.z)),r}subtract(e){let r=new a(this.x-e.x,this.y-e.y);return this.z!==void 0&&(r.z=this.z,e.z!==void 0&&(r.z-=e.z)),r}scale(e=1){if(e===0)return new a(0,0,this.z===void 0?void 0:0);let r=new a(this.x*e,this.y*e);return this.z!==void 0&&(r.z=this.z*e),r}};function _(a){if(a.length!==a[0].length){console.warn("Cannot invert non-square matrices");return}var e=0,r=0,t=0,$=a.length,x=0,g=0,i=[],n=[];for(e=0;e<$;e+=1)for(i[i.length]=[],n[n.length]=[],t=0;t<$;t+=1)e==t?i[e][t]=1:i[e][t]=0,n[e][t]=a[e][t];for(e=0;e<$;e+=1){if(x=n[e][e],x==0){for(r=e+1;r<$;r+=1)if(n[r][e]!=0){for(t=0;t<$;t++)x=n[e][t],n[e][t]=n[r][t],n[r][t]=x,x=i[e][t],i[e][t]=i[r][t],i[r][t]=x;break}if(x=n[e][e],x==0)return}for(t=0;t<$;t++)n[e][t]=n[e][t]/x,i[e][t]=i[e][t]/x;for(r=0;r<$;r++)if(r!=e)for(x=n[r][e],t=0;t<$;t++)n[r][t]-=x*n[e][t],i[r][t]-=x*i[e][t]}return i}o(_,"invert");function W(a,e){var r=[],t=M(e);return a.forEach(($,x)=>{r[x]=[],t.forEach((g,i)=>{r[x][i]=$.map((n,s)=>g[s]*n).reduce((n,s)=>n+s,0)})}),r}o(W,"multiply");function M(a){return a[0].map((e,r)=>a.map(t=>t[r]))}o(M,"transpose");var N=class a{static{o(this,"Matrix")}constructor(e,r,t){t=e instanceof Array?e:t,this.data=t??[...new Array(e)].map($=>[...new Array(r)].map(x=>0)),this.rows=this.data.length,this.cols=this.data[0].length}setData(e){this.data=e}get(e,r){return this.data[e][r]}set(e,r,t){this.data[e][r]=t}row(e){return this.data[e]}col(e){var r=this.data,t=[];for(let $=0,x=r.length;$<x;$++)t.push(r[$][e]);return t}multiply(e){return new a(W(this.data,e.data))}invert(){return new a(_(this.data))}transpose(){return new a(M(this.data))}};function H(a){let e=new TextEncoder().encode(a),r=String.fromCodePoint(...e);return btoa(r)}o(H,"base64");function k(a){let e=atob(a),r=Uint8Array.from(e,t=>t.codePointAt(0));return new TextDecoder().decode(r)}o(k,"decode64");function B(a){let e=/^(.*)\/([^.]+(\.([^\/?#]+))+)(\?[^#]*)?(#.*)?$/,r=a.match(e);if(r!==null){let{[1]:t,[2]:$,[4]:x}=r;a=t}return a}o(B,"getURLbase");function K(a){if(typeof window>"u"||typeof document>"u")return!0;var e=a.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}o(K,"isInViewport");var z=String(import.meta.url),V=k("Y29uc3QgQUxQSEFCRVRJQyA9IGBhbHBoYWJldGljYDsKY29uc3QgQVVUTyA9IGBhdXRvYDsKY29uc3QgQk9UVE9NID0gYGJvdHRvbWA7CmNvbnN0IEJPVFRPTV9MRUZUID0gYGJvdHRvbi1sZWZ0YDsKY29uc3QgQk9UVE9NX1JJR0hUID0gYGJvdHRvbS1yaWdodGA7CmNvbnN0IENFTlRFUiA9IGBjZW50ZXJgOwpjb25zdCBDT05TVFJBSU4gPSB0cnVlOwpjb25zdCBDUk9TUyA9IGBjcm9zc2hhaXJgOwpjb25zdCBFTkQgPSBgZW5kYDsKY29uc3QgSEFORCA9IGBwb2ludGVyYDsKY29uc3QgSEFOR0lORyA9IGBoYW5naW5nYDsKY29uc3QgSURFT0dSQVBISUMgPSBgaWRlb2dyYXBoaWNgOwpjb25zdCBMRUZUID0gYGxlZnRgOwpjb25zdCBMVFIgPSBgbHRyYDsKY29uc3QgTUlERExFID0gYG1pZGRsZWA7CmNvbnN0IFBPSU5URVIgPSBgZGVmYXVsdGA7CmNvbnN0IFJJR0hUID0gYHJpZ2h0YDsKY29uc3QgUlRMID0gYHJ0bGA7CmNvbnN0IFNUQVJUID0gYHN0YXJ0YDsKY29uc3QgVE9QID0gYHRvcGA7CmNvbnN0IFRPUF9MRUZUID0gYHRvcC1sZWZ0YDsKY29uc3QgVE9QX1JJR0hUID0gYHRvcC1yaWdodGA7Cgpjb25zdCBwb2ludGVyID0geyB4OiAwLCB5OiAwIH07CmNvbnN0IGtleWJvYXJkID0ge307CgovLyBtYXRoIGZ1bmN0aW9ucyBhbmQgY29uc3RhbnRzCmNvbnN0IHsKICBhYnMsCiAgYWNvcywKICBhY29zaCwKICBhc2luLAogIGFzaW5oLAogIGF0YW4sCiAgYXRhbjIsCiAgYXRhbmgsCiAgY2JydCwKICBjZWlsLAogIGNsejMyLAogIGNvcywKICBjb3NoLAogIGV4cCwKICBleHBtMSwKICBmbG9vciwKICBmcm91bmQsCiAgaHlwb3QsCiAgaW11bCwKICBsb2c6IGxuLAogIGxvZzEwOiBsb2csCiAgbG9nMiwKICBtYXgsCiAgbWluLAogIHBvdywKICByb3VuZCwKICBzaWduLAogIHNpbiwKICBzaW5oLAogIHNxcnQsCiAgdGFuLAogIHRhbmgsCiAgdHJ1bmMsCn0gPSBNYXRoOwoKY29uc3QgeyBQSSwgRSB9ID0gTWF0aDsKCmZ1bmN0aW9uIGNvbnN0cmFpbih2LCBzLCBlKSB7CiAgcmV0dXJuIHYgPCBzID8gcyA6IHYgPiBlID8gZSA6IHY7Cn0KCmZ1bmN0aW9uIGNzYyh2KSB7CiAgcmV0dXJuIDEgLyBzaW4odik7Cn0KCmZ1bmN0aW9uIGN0bih2KSB7CiAgcmV0dXJuIGNvcyh2KSAvIHNpbih2KTsKfQoKZnVuY3Rpb24gZGVncmVlcyh2LCBjb25zdHJhaW4pIHsKICBsZXQgZCA9ICh2IC8gUEkpICogMTgwOwogIGlmICghY29uc3RyYWluKSByZXR1cm4gZDsKICB3aGlsZSAoZCA8IDApIGQgKz0gMzYwOwogIHJldHVybiBkICUgMzYwOwp9CgpmdW5jdGlvbiBkaXN0KHgxLCB5MSwgeDIsIHkyKSB7CiAgcmV0dXJuICgoeDIgLSB4MSkgKiogMiArICh5MiAtIHkxKSAqKiAyKSAqKiAwLjU7Cn0KCmNvbnN0IGVwc2lsb24gPSAxZS0xMDsKCmNvbnN0IGh1Z2UgPSAxXzAwMF8wMDA7CgpmdW5jdGlvbiBtYXAodiwgcywgZSwgbnMsIG5lLCBjb25zdHJhaW5lZCA9IGZhbHNlKSB7CiAgY29uc3QgaTEgPSBlIC0gcywKICAgIGkyID0gbmUgLSBucywKICAgIHAgPSB2IC0gczsKICBsZXQgciA9IG5zICsgKHAgKiBpMikgLyBpMTsKICBpZiAoY29uc3RyYWluZWQpIHJldHVybiBjb25zdHJhaW4ociwgbnMsIG5lKTsKICByZXR1cm4gcjsKfQoKZnVuY3Rpb24gcmFkaWFucyh2KSB7CiAgbGV0IHIgPSAodiAvIDE4MCkgKiBQSTsKICBpZiAoIWNvbnN0cmFpbikgcmV0dXJuIHI7CiAgd2hpbGUgKHIgPCAwKSByICs9IFRBVTsKICByZXR1cm4gciAlIFRBVTsKfQoKZnVuY3Rpb24gcmFuZG9tKGEgPSAxLCBiKSB7CiAgaWYgKGIgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGEgKiBNYXRoLnJhbmRvbSgpOwogIHJldHVybiBhICsgTWF0aC5yYW5kb20oKSAqIChiIC0gYSk7Cn0KCmNvbnN0IHNlYyA9ICh2KSA9PiAxIC8gY29zKHYpOwoKY29uc3QgVEFVID0gUEkgKiAyOwoKLy8gInB1YmxpYyIgdmFycwpsZXQgY3VycmVudFBvaW50OwpsZXQgZnJhbWU7CmxldCBmcmFtZURlbHRhOwpsZXQgaGVpZ2h0OwpsZXQgd2lkdGg7CmxldCBwbGF5aW5nOwoKLy8gImludGVybmFsIiB2YXJzCgpsZXQgX19jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBjYW52YXNgKTsKX19jYW52YXMudGFiSW5kZXggPSAwOwpfX2NhbnZhcy5hZGRFdmVudExpc3RlbmVyKGBwb2ludGVyZG93bmAsICgpID0+IF9fY2FudmFzLmZvY3VzKCkpOwpsZXQgX19jdHggPSBfX2NhbnZhcy5nZXRDb250ZXh0KGAyZGApOwoKbGV0IF9fY3VycmVudF9jdXJzb3I7CmxldCBfX2N1cnJlbnRfaGlnaGxpZ2h0X2NvbG9yOwpsZXQgX19jdXJyZW50X2h1ZTsKbGV0IF9fZHJhd19ncmlkOwpsZXQgX19kcmF3aW5nOwpsZXQgX19lbGVtZW50OwpsZXQgX19maW5pc2hlZF9zZXR1cDsKbGV0IF9fZmlyc3Q7CmxldCBfX2ZvbnQ7CmxldCBfX2dyaWRfY29sb3I7CmxldCBfX2dyaWRfc3BhY2luZzsKbGV0IF9faGlnaGxpZ2h0X2NvbG9yOwpsZXQgX19tb3ZhYmxlX3BvaW50czsKbGV0IF9fcmVkcmF3aW5nOwpsZXQgX19zdGFydF90aW1lOwpsZXQgX19zdHlsZV9zdGFjazsKbGV0IF9fdGV4dFN0cm9rZTsKbGV0IF9fbGFzdF9mcmFtZTsKCmZ1bmN0aW9uIGZpbmQocXMpIHsKICByZXR1cm4gX19lbGVtZW50LnF1ZXJ5U2VsZWN0b3IocXMpOwp9CgpmdW5jdGlvbiBmaW5kQWxsKHFzKSB7CiAgcmV0dXJuIF9fZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHFzKTsKfQoKYXN5bmMgZnVuY3Rpb24gcmVzZXQoZWxlbWVudCA9IF9fZWxlbWVudCkgewogIF9fZWxlbWVudCA9IGVsZW1lbnQ7CgogIC8vIGRlZmF1bHQgdmFyaWFibGUgdmFsdWVzCiAgX19jdXJyZW50X2N1cnNvciA9IGBhdXRvYDsKICBfX2N1cnJlbnRfaGlnaGxpZ2h0X2NvbG9yID0gYHJnYigwLDI1NCwxMjQpYDsKICBfX2N1cnJlbnRfaHVlID0gMDsKICBfX2RyYXdfZ3JpZCA9IHRydWU7CiAgX19kcmF3aW5nID0gZmFsc2U7CiAgX19maW5pc2hlZF9zZXR1cCA9IGZhbHNlOwogIF9fZm9udCA9IHsgZmFtaWx5OiBgc2Fucy1zZXJpZmAsIHNpemU6IDE2LCB3ZWlnaHQ6IDQwMCB9OwogIF9fZ3JpZF9jb2xvciA9IGBsaWdodGdyZXlgOwogIF9fZ3JpZF9zcGFjaW5nID0gMjA7CiAgX19oaWdobGlnaHRfY29sb3IgPSBmYWxzZTsKICBfX21vdmFibGVfcG9pbnRzID0gW107CiAgX19yZWRyYXdpbmcgPSBmYWxzZTsKICBfX3N0YXJ0X3RpbWUgPSBEYXRlLm5vdygpOwogIF9fc3R5bGVfc3RhY2sgPSBbXTsKICBfX3RleHRTdHJva2UgPSBgdHJhbnNwYXJlbnRgOwoKICBjdXJyZW50UG9pbnQgPSBmYWxzZTsKICBwbGF5aW5nID0gZmFsc2U7CiAgZnJhbWUgPSAwOwogIHBvaW50ZXIueCA9IDA7CiAgcG9pbnRlci55ID0gMDsKICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhrZXlib2FyZCkuZm9yRWFjaCgobikgPT4gZGVsZXRlIGtleWJvYXJkW25dKTsKCiAgLy8gbWFrZSBzdXJlIHdlIGRvbid0IGRvdWJsZS1nZW5lcmF0ZSB0aGVzZToKICBjbGVhclNsaWRlcnMoKTsKICBjbGVhckJ1dHRvbnMoKTsKCiAgLy8gcnVuIHNldHVwCiAgYXdhaXQgX19zZXR1cCgpOwogIF9fZmluaXNoZWRfc2V0dXAgPSB0cnVlOwoKICAvLyBydW4gZmlyc3QgZHJhdwogIF9fbGFzdF9mcmFtZSA9IERhdGUubm93KCk7CiAgYXdhaXQgX19kcmF3KCk7CgogIHJldHVybiB7IHdpZHRoLCBoZWlnaHQgfTsKfQoKZnVuY3Rpb24gaGFsdCgpIHsKICBwbGF5aW5nID0gZmFsc2U7CiAgX19jYW52YXMgPSB1bmRlZmluZWQ7CiAgX19jdHggPSB1bmRlZmluZWQ7CiAgX19maW5pc2hlZF9zZXR1cCA9IGZhbHNlOwogIF9fZHJhd2luZyA9IHRydWU7CiAgX19yZWRyYXdpbmcgPSB0cnVlOwogIF9fZmlyc3QgPSB1bmRlZmluZWQ7CiAgX19tb3ZhYmxlX3BvaW50cyA9IHVuZGVmaW5lZDsKICBfX2N1cnJlbnRfY3Vyc29yID0gdW5kZWZpbmVkOwogIF9fY3VycmVudF9odWUgPSAwOwogIF9fZm9udCA9IHVuZGVmaW5lZDsKICBfX3N0YXJ0X3RpbWUgPSAwOwogIGNsZWFyU2xpZGVycygpOwogIGNsZWFyQnV0dG9ucygpOwp9CgpmdW5jdGlvbiBfX2dldERlc2NyaXB0aW9uKCkgewogIGlmICh0eXBlb2YgZ2V0RGVzY3JpcHRpb24gIT09IGB1bmRlZmluZWRgKSByZXR1cm4gZ2V0RGVzY3JpcHRpb24oKTsKfQoKYXN5bmMgZnVuY3Rpb24gX19zZXR1cCgpIHsKICBpZiAodHlwZW9mIHNldHVwICE9PSBgdW5kZWZpbmVkYCkgYXdhaXQgc2V0dXAoKTsKICBpZiAodHlwZW9mIF9fbW9yZV9zZXR1cCAhPT0gYHVuZGVmaW5lZGApIGF3YWl0IF9fbW9yZV9zZXR1cCgpOwogIGlmICghd2lkdGggJiYgIWhlaWdodCkgc2V0U2l6ZSgpOwp9CgpmdW5jdGlvbiBzZXRTaXplKHcgPSA0MDAsIGggPSAyMDApIHsKICB3aWR0aCA9IF9fY2FudmFzLndpZHRoID0gdzsKICBoZWlnaHQgPSBfX2NhbnZhcy5oZWlnaHQgPSBoOwogIF9fZWxlbWVudC5zdHlsZS5tYXhXaWR0aCA9IGBjYWxjKDJlbSArICR7d2lkdGh9cHhgOwogIF9fY3R4ID0gX19jYW52YXMuZ2V0Q29udGV4dChgMmRgKTsKICBfX2RyYXcoKTsKfQoKYXN5bmMgZnVuY3Rpb24gX19kcmF3KCkgewogIGlmICghX19maW5pc2hlZF9zZXR1cCkgcmV0dXJuOwogIGlmICghX19kcmF3aW5nKSB7CiAgICBfX2RyYXdpbmcgPSB0cnVlOwogICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTsKICAgIGZyYW1lRGVsdGEgPSBub3cgLSBfX2xhc3RfZnJhbWU7CiAgICBmcmFtZSsrOwogICAgcmVzZXRUcmFuc2Zvcm0oKTsKICAgIGlmICh0eXBlb2YgZHJhdyAhPT0gYHVuZGVmaW5lZGApIGF3YWl0IGRyYXcoKTsKICAgIGlmICh0eXBlb2YgX19tb3JlX2RyYXcgIT09IGB1bmRlZmluZWRgKSBhd2FpdCBfX21vcmVfZHJhdygpOwogICAgX19kcmF3aW5nID0gZmFsc2U7CiAgICBfX2xhc3RfZnJhbWUgPSBub3c7CiAgICBpZiAocGxheWluZykgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IF9fZHJhdygpKTsKICB9Cn0KCmZ1bmN0aW9uIHJlZHJhdygpIHsKICBpZiAoX19yZWRyYXdpbmcpIHJldHVybjsKICBpZiAocGxheWluZykgcmV0dXJuOwogIF9fcmVkcmF3aW5nID0gdHJ1ZTsKICBfX2RyYXcoKTsKICBfX3JlZHJhd2luZyA9IGZhbHNlOwp9CgovLyAtLS0tLS0tLS0tLS0tLS0tLSBwb2ludGVyIGhlbHBlcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBfX2NoZWNrRm9yQ3VycmVudFBvaW50KHgsIHksIHR5cGUpIHsKICBjb25zdCBtYXRjaGVzID0gW107CiAgY29uc3QgbWF0Y2hQYWRkaW5nID0gdHlwZS5pbmNsdWRlcyhgbW91c2VgKSA/IDEwIDogMzA7CiAgX19tb3ZhYmxlX3BvaW50cy5mb3JFYWNoKChwLCBwb3MpID0+IHsKICAgIGxldCB4MiA9IHBbMF0gPT09IHVuZGVmaW5lZCA/IHAueCA6IHBbMF07CiAgICBsZXQgeTIgPSBwWzFdID09PSB1bmRlZmluZWQgPyBwLnkgOiBwWzFdOwogICAgY29uc3QgZCA9IGRpc3QoeCwgeSwgeDIsIHkyKTsKICAgIGlmIChkIDwgKHAuciA/IHAuciA6IDApICsgbWF0Y2hQYWRkaW5nKSB7CiAgICAgIG1hdGNoZXMucHVzaCh7IHAsIGQgfSk7CiAgICB9CiAgfSk7CiAgY3VycmVudFBvaW50ID0gZmFsc2U7CiAgX19jYW52YXMuc3R5bGUuY3Vyc29yID0gYGF1dG9gOwogIGlmIChtYXRjaGVzLmxlbmd0aCkgewogICAgbWF0Y2hlcy5zb3J0KChhLCBiKSA9PiBhLmQgLSBiLmQpOwogICAgY3VycmVudFBvaW50ID0gbWF0Y2hlc1swXS5wOwogICAgX19jYW52YXMuc3R5bGUuY3Vyc29yID0gYHBvaW50ZXJgOwogIH0KfQoKZnVuY3Rpb24gX190b1BvaW50ZXJFdmVudChldnQpIHsKICBsZXQgcG9pbnRlciA9IGV2dDsKICAvLyBDb252ZXJ0IG1vdXNlIG9yIHRvdWNoIGludG8gZ2VuZXJpYyBwb2ludGVyLiBXaGljaCB3ZSBuZWVkCiAgLy8gdG8gZG8gYmVjYXVzZSBDaHJvbWUgb24gTWFjT1MgaGFzIGRlY2lkZWQgdG8gbm90IGdlbmVyYXRlCiAgLy8gcG9pbnRlciBldmVudHMgd2hlbiB0aGVyZSdzIGEgbW91c2UuIFRoYW5rcyBHb29nbGUhCiAgaWYgKGV2dC50eXBlLmluY2x1ZGVzKGB0b3VjaGApKSB7CiAgICBjb25zdCB7IHRvdWNoZXMsIGNoYW5nZWRUb3VjaGVzIH0gPSBldnQub3JpZ2luYWxFdmVudCA/PyBldnQ7CiAgICBwb2ludGVyID0gdG91Y2hlc1swXSA/PyBjaGFuZ2VkVG91Y2hlc1swXTsKICB9CiAgY29uc3QgeyBjbGllbnRYLCBjbGllbnRZIH0gPSBwb2ludGVyOwogIGNvbnN0IHsgbGVmdCwgdG9wIH0gPSBfX2NhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICByZXR1cm4geyBvZmZzZXRYOiBjbGllbnRYIC0gbGVmdCwgb2Zmc2V0WTogY2xpZW50WSAtIHRvcCB9Owp9CgovLyAtLS0tLS0tLS0tLS0tLS0gcG9pbnRlciBldmVudCBoYW5kbGluZyAtLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBfX3BvaW50ZXJEb3duKHgsIHkpIHsKICBpZiAoY3VycmVudFBvaW50KSB7CiAgICBjdXJyZW50UG9pbnQuX2R4ID0gY3VycmVudFBvaW50LnggLSB4OwogICAgY3VycmVudFBvaW50Ll9keSA9IGN1cnJlbnRQb2ludC55IC0geTsKICB9CiAgaWYgKHR5cGVvZiBwb2ludGVyRG93biAhPT0gYHVuZGVmaW5lZGApIHBvaW50ZXJEb3duKHgsIHkpOwp9CgpbYHRvdWNoc3RhcnRgLCBgbW91c2Vkb3duYF0uZm9yRWFjaCgodHlwZSkgPT4gewogIF9fY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgKGV2dCkgPT4gewogICAgaWYgKF9fZmluaXNoZWRfc2V0dXApIHsKICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgY29uc3QgeyBvZmZzZXRYLCBvZmZzZXRZIH0gPSBfX3RvUG9pbnRlckV2ZW50KGV2dCk7CiAgICAgIGNvbnN0IHsgeCwgeSB9ID0gc2NyZWVuVG9Xb3JsZChvZmZzZXRYLCBvZmZzZXRZKTsKICAgICAgT2JqZWN0LmFzc2lnbihwb2ludGVyLCB7IHgsIHksIHR5cGUsIGRvd246IHRydWUsIG1hcms6IHsgeCwgeSB9IH0pOwogICAgICBfX2NoZWNrRm9yQ3VycmVudFBvaW50KHgsIHksIHR5cGUpOwogICAgICBfX3BvaW50ZXJEb3duKHgsIHkpOwogICAgfQogIH0pOwp9KTsKCmZ1bmN0aW9uIF9fcG9pbnRlclVwKHgsIHkpIHsKICBpZiAodHlwZW9mIHBvaW50ZXJVcCAhPT0gYHVuZGVmaW5lZGApIHBvaW50ZXJVcCh4LCB5KTsKICBpZiAocG9pbnRlci5tYXJrPy54ID09PSB4ICYmIHBvaW50ZXIubWFyaz8ueSA9PT0geSkgewogICAgaWYgKHR5cGVvZiBwb2ludGVyQ2xpY2sgIT09IGB1bmRlZmluZWRgKSBwb2ludGVyQ2xpY2soeCwgeSk7CiAgfQp9CgpbYHRvdWNoZW5kYCwgYG1vdXNldXBgXS5mb3JFYWNoKCh0eXBlKSA9PiB7CiAgX19jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCAoZXZ0KSA9PiB7CiAgICBpZiAoX19maW5pc2hlZF9zZXR1cCkgewogICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICBjb25zdCB7IG9mZnNldFgsIG9mZnNldFkgfSA9IF9fdG9Qb2ludGVyRXZlbnQoZXZ0KTsKICAgICAgY29uc3QgeyB4LCB5IH0gPSBzY3JlZW5Ub1dvcmxkKG9mZnNldFgsIG9mZnNldFkpOwogICAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgeCwgeSwgdHlwZSwgZG93bjogZmFsc2UsIG1hcms6IGZhbHNlIH0pOwogICAgICBfX3BvaW50ZXJVcCh4LCB5KTsKICAgIH0KICB9KTsKfSk7CgpmdW5jdGlvbiBfX3BvaW50ZXJNb3ZlKHgsIHkpIHsKICBsZXQgcG9pbnRNb3ZlZCA9IGZhbHNlOwogIGlmIChwb2ludGVyLmRvd24gJiYgY3VycmVudFBvaW50KSB7CiAgICBpZiAoY3VycmVudFBvaW50WzBdKSB7CiAgICAgIGN1cnJlbnRQb2ludFswXSA9IHggKyBjdXJyZW50UG9pbnQuX2R4OwogICAgICBjdXJyZW50UG9pbnRbMV0gPSB5ICsgY3VycmVudFBvaW50Ll9keTsKICAgIH0gZWxzZSB7CiAgICAgIGN1cnJlbnRQb2ludC54ID0geCArIGN1cnJlbnRQb2ludC5fZHg7CiAgICAgIGN1cnJlbnRQb2ludC55ID0geSArIGN1cnJlbnRQb2ludC5fZHk7CiAgICB9CiAgICBwb2ludE1vdmVkID0gdHJ1ZTsKICB9CgogIGlmICh0eXBlb2YgcG9pbnRlck1vdmUgIT09IGB1bmRlZmluZWRgKSB7CiAgICBwb2ludGVyTW92ZSh4LCB5KTsKICAgIHBvaW50ZXIuZHJhZyA9IGZhbHNlOwogICAgaWYgKHBvaW50ZXIuZG93biAmJiB0eXBlb2YgcG9pbnRlckRyYWcgIT09IGB1bmRlZmluZWRgKSB7CiAgICAgIHBvaW50ZXIuZHJhZyA9IHRydWU7CiAgICAgIHBvaW50ZXJEcmFnKHgsIHkpOwogICAgfQogIH0KICBpZiAocG9pbnRNb3ZlZCAmJiAhcGxheWluZykgcmVkcmF3KCk7Cn0KCltgdG91Y2htb3ZlYCwgYG1vdXNlbW92ZWBdLmZvckVhY2goKHR5cGUpID0+IHsKICBfX2NhbnZhcy5hZGRFdmVudExpc3RlbmVyKHR5cGUsIChldnQpID0+IHsKICAgIGlmIChfX2ZpbmlzaGVkX3NldHVwKSB7CiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIGNvbnN0IHsgb2Zmc2V0WCwgb2Zmc2V0WSB9ID0gX190b1BvaW50ZXJFdmVudChldnQpOwogICAgICBjb25zdCB7IHgsIHkgfSA9IHNjcmVlblRvV29ybGQob2Zmc2V0WCwgb2Zmc2V0WSk7CiAgICAgIE9iamVjdC5hc3NpZ24ocG9pbnRlciwgeyB4LCB5LCB0eXBlIH0pOwogICAgICBpZiAoIXBvaW50ZXIuZG93bikgX19jaGVja0ZvckN1cnJlbnRQb2ludCh4LCB5LCB0eXBlKTsKICAgICAgX19wb2ludGVyTW92ZSh4LCB5KTsKICAgIH0KICB9KTsKfSk7CgpmdW5jdGlvbiBfX3BvaW50ZXJBY3RpdmUoYWN0aXZlKSB7CiAgaWYgKHR5cGVvZiBwb2ludGVyQWN0aXZlICE9PSBgdW5kZWZpbmVkYCkgewogICAgcG9pbnRlckFjdGl2ZShhY3RpdmUpOwogIH0KfQoKW2B0b3VjaHN0YXJ0YCwgYG1vdXNlZW50ZXJgXS5mb3JFYWNoKCh0eXBlKSA9PiB7CiAgX19jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCAoKSA9PiB7CiAgICBwb2ludGVyLmFjdGl2ZSA9IHRydWU7CiAgICBfX3BvaW50ZXJBY3RpdmUodHJ1ZSk7CiAgfSk7Cn0pOwoKW2B0b3VjaGVuZGAsIGBtb3VzZWxlYXZlYF0uZm9yRWFjaCgodHlwZSkgPT4gewogIF9fY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgKCkgPT4gewogICAgcG9pbnRlci5hY3RpdmUgPSBmYWxzZTsKICAgIF9fcG9pbnRlckFjdGl2ZShmYWxzZSk7CiAgfSk7Cn0pOwoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tIGtleSBldmVudCBoYW5kbGluZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBfX3NhZmVseUludGVyY2VwdEtleShldnQpIHsKICAvLyBXZSBkb24ndCB3YW50IHRvIGludGVyZmVyZSB3aXRoIHRoZSBicm93c2VyLCBzbyB3ZSdyZSBvbmx5CiAgLy8gZ29pbmcgdG8gYWxsb3cgdW5tb2RpZmllZCBrZXlzLCBvciBzaGlmdC1tb2RpZmllZCBrZXlzLAogIC8vIGFuZCB0YWIgaGFzIHRvIGFsd2F5cyB3b3JrLiBGb3Igb2J2aW91cyByZWFzb25zLgogIGNvbnN0IHRhYiA9IGV2dC5rZXkgIT09ICJUYWIiOwogIGNvbnN0IGZ1bmN0aW9uS2V5ID0gZXZ0LmtleS5tYXRjaCgvRlxkKy8pID09PSBudWxsOwogIGNvbnN0IHNwZWNpZmljQ2hlY2sgPSB0YWIgJiYgZnVuY3Rpb25LZXk7CiAgaWYgKCFldnQuYWx0S2V5ICYmICFldnQuY3RybEtleSAmJiAhZXZ0Lm1ldGFLZXkgJiYgc3BlY2lmaWNDaGVjaykgewogICAgaWYgKGV2dC50YXJnZXQgPT09IF9fY2FudmFzKSB7CiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBfX2tleURvd24oa2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5KSB7CiAga2V5Ym9hcmRba2V5XSA9IERhdGUubm93KCk7CiAgaWYgKHR5cGVvZiBrZXlEb3duICE9PSBgdW5kZWZpbmVkYCkKICAgIGtleURvd24oa2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5KTsKfQoKX19jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihga2V5ZG93bmAsIChldnQpID0+IHsKICBfX3NhZmVseUludGVyY2VwdEtleShldnQpOwogIGNvbnN0IHsga2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5IH0gPSBldnQ7CiAgaWYgKF9fZmluaXNoZWRfc2V0dXApIF9fa2V5RG93bihrZXksIHNoaWZ0S2V5LCBhbHRLZXksIGN0cmxLZXksIG1ldGFLZXkpOwp9KTsKCmZ1bmN0aW9uIF9fa2V5VXAoa2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5KSB7CiAgZGVsZXRlIGtleWJvYXJkW2tleV07CiAgaWYgKHR5cGVvZiBrZXlVcCAhPT0gYHVuZGVmaW5lZGApCiAgICBrZXlVcChrZXksIHNoaWZ0S2V5LCBhbHRLZXksIGN0cmxLZXksIG1ldGFLZXkpOwp9CgpfX2NhbnZhcy5hZGRFdmVudExpc3RlbmVyKGBrZXl1cGAsIChldnQpID0+IHsKICBfX3NhZmVseUludGVyY2VwdEtleShldnQpOwogIGNvbnN0IHsga2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5IH0gPSBldnQ7CiAgaWYgKF9fZmluaXNoZWRfc2V0dXApIF9fa2V5VXAoa2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5KTsKfSk7CgovLyAtLS0tLS0tLS0tLS0tLS0tIHNsaWRlciBmdW5jdGlvbnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBhZGRTbGlkZXIocHJvcExhYmVsLCBhc3NpZ24sIG9wdGlvbnMgPSB7fSkgewogIGxldCB7CiAgICBtaW4sCiAgICBtYXgsCiAgICBzdGVwLAogICAgdmFsdWUsCiAgICBjbGFzc2VzID0gYHNsaWRlcmAsCiAgICB0cmFuc2Zvcm0gPSAodikgPT4gdiwKICB9ID0gb3B0aW9uczsKCiAgbWluID0gbWluID09PSB1bmRlZmluZWQgPyAwIDogbWluOwogIG1heCA9IG1heCA9PT0gdW5kZWZpbmVkID8gMSA6IG1heDsKICBzdGVwID0gc3RlcCA9PT0gdW5kZWZpbmVkID8gKG1heCAtIG1pbikgLyAxMCA6IHN0ZXA7CiAgdmFsdWUgPSB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gKG1heCAtIG1pbikgLyAyIDogdmFsdWU7CgogIC8vIGN1c3RvbSAicm91bmRpbmciLCBwdXJlbHkgZm9yIHN0cmluZ3MKICBjb25zdCByb3VuZCA9ICh2LCBkID0gNCkgPT4gewogICAgdiA9IGAke3Z9YDsKICAgIGNvbnN0IGZzID0gdi5pbmRleE9mKGAuYCk7CiAgICBpZiAoZnMgIT09IC0xKSB7CiAgICAgIGxldCBwcmVjID0gZCAtIGZzID4gMCA/IGQgLSBmcyA6IDA7CiAgICAgIHYgPSB2LnN1YnN0cmluZygwLCBmcyArIHByZWMpOwogICAgfQogICAgcmV0dXJuIHY7CiAgfTsKCiAgY29uc3QgY3JlYXRlID0gKHRhZykgPT4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpOwoKICBsZXQgc2xpZGVyID0gY3JlYXRlKGBpbnB1dGApOwogIHNsaWRlci50eXBlID0gYHJhbmdlYDsKICBzbGlkZXIubWluID0gbWluOwogIHNsaWRlci5tYXggPSBtYXg7CiAgc2xpZGVyLnN0ZXAgPSBzdGVwOwogIHNsaWRlci5zZXRBdHRyaWJ1dGUoYHZhbHVlYCwgdmFsdWUpOwogIHNsaWRlci5zZXRBdHRyaWJ1dGUoYGNsYXNzYCwgY2xhc3Nlcyk7CgogIGNvbnN0IHVwZGF0ZSA9ICh7IHZhbHVlIH0pID0+IHsKICAgIHZhbHVlRmllbGQudGV4dENvbnRlbnQgPSByb3VuZCh2YWx1ZSk7CiAgICBhc3NpZ24odHJhbnNmb3JtKHBhcnNlRmxvYXQodmFsdWUpKSk7CiAgICBpZiAoIXBsYXlpbmcpIHJlZHJhdygpOwogIH07CgogIHNsaWRlci5hZGRFdmVudExpc3RlbmVyKGBpbnB1dGAsICh7IHRhcmdldCB9KSA9PiB1cGRhdGUodGFyZ2V0KSk7CgogIGxldCB0YWJsZSA9IF9fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGB0YWJsZS5zbGlkZXItd3JhcHBlcmApOwogIGlmICghdGFibGUpIHsKICAgIHRhYmxlID0gY3JlYXRlKGB0YWJsZWApOwogICAgdGFibGUuY2xhc3NMaXN0LmFkZChgc2xpZGVyLXdyYXBwZXJgKTsKICAgIF9fZWxlbWVudC5wcmVwZW5kKHRhYmxlKTsKICB9CiAgbGV0IHRyID0gY3JlYXRlKGB0cmApOwoKICBsZXQgdGQgPSBjcmVhdGUoYHRkYCk7CiAgbGV0IGxhYmVsID0gY3JlYXRlKGBsYWJlbGApOwogIGxhYmVsLmNsYXNzTGlzdC5hZGQoYHNsaWRlci1sYWJlbGApOwogIGxhYmVsLmlubmVySFRNTCA9IHByb3BMYWJlbAogICAgLnJlcGxhY2UoL18oLispJC8sIGA8c3ViPiQxPC9zdWI+YCkKICAgIC5yZXBsYWNlKC8oXGQrKS8sIGA8c3ViPiQxPC9zdWI+YCk7CiAgdGQuYXBwZW5kKGxhYmVsKTsKICB0ci5hcHBlbmQodGQpOwoKICB0ZCA9IGNyZWF0ZShgdGRgKTsKICB0ZC5jbGFzc0xpc3QuYWRkKGBzbGlkZXItbWluYCk7CiAgdGQudGV4dENvbnRlbnQgPSByb3VuZChzbGlkZXIubWluKTsKICB0ci5hcHBlbmQodGQpOwoKICB0ZCA9IGNyZWF0ZShgdGRgKTsKICB0ZC53aWR0aCA9IGAqYDsKICB0ZC5hcHBlbmQoc2xpZGVyKTsKICB0ci5hcHBlbmQodGQpOwoKICB0ZCA9IGNyZWF0ZShgdGRgKTsKICB0ZC5jbGFzc0xpc3QuYWRkKGBzbGlkZXItbWF4YCk7CiAgdGQudGV4dENvbnRlbnQgPSByb3VuZChzbGlkZXIubWF4KTsKICB0ci5hcHBlbmQodGQpOwoKICB0ZCA9IGNyZWF0ZShgdGRgKTsKICB2YXIgdmFsdWVGaWVsZCA9IGNyZWF0ZShgbGFiZWxgKTsgLy8gZnVuY3Rpb24gc2NvcGVkCiAgdmFsdWVGaWVsZC5jbGFzc0xpc3QuYWRkKGBzbGlkZXItdmFsdWVgKTsKICB0ZC5hcHBlbmQodmFsdWVGaWVsZCk7CiAgdHIuYXBwZW5kKHRkKTsKICB0ZC5hZGRFdmVudExpc3RlbmVyKGBwb2ludGVyZG93bmAsICgpID0+IHsKICAgIGNvbnN0IHZhbHVlID0gcHJvbXB0KGBuZXcgdmFsdWU/YCwgc2xpZGVyLnZhbHVlKTsKICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkgewogICAgICBzbGlkZXIudmFsdWUgPSB2YWx1ZTsKICAgICAgdXBkYXRlKHsgdmFsdWUgfSk7CiAgICB9CiAgfSk7CgogIHRhYmxlLmFwcGVuZCh0cik7CgogIHVwZGF0ZShzbGlkZXIpOwogIHJldHVybiBzbGlkZXI7Cn0KCmZ1bmN0aW9uIGNsZWFyU2xpZGVycygpIHsKICBjb25zdCB0YWJsZSA9IF9fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGB0YWJsZS5zbGlkZXItd3JhcHBlcmApOwogIGlmICh0YWJsZSkgdGFibGUuaW5uZXJIVE1MID0gYGA7Cn0KCmZ1bmN0aW9uIGFkZEJ1dHRvbihsYWJlbCwgb25DbGljaykgewogIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYGJ1dHRvbmApOwogIGJ0bi5jbGFzc0xpc3QuYWRkKGBncmFwaGljcy1lbGVtZW50LWJ1dHRvbmApOwogIGJ0bi50ZXh0Q29udGVudCA9IGxhYmVsOwogIGJ0bi5hZGRFdmVudExpc3RlbmVyKGBjbGlja2AsICgpID0+IG9uQ2xpY2soYnRuKSk7CiAgX19lbGVtZW50LnByZXBlbmQoYnRuKTsKICByZXR1cm4gYnRuOwp9CgpmdW5jdGlvbiBjbGVhckJ1dHRvbnMoKSB7CiAgX19lbGVtZW50CiAgICAucXVlcnlTZWxlY3RvckFsbChgYnV0dG9uLmdyYXBoaWNzLWVsZW1lbnQtYnV0dG9uYCkKICAgIC5mb3JFYWNoKChlKSA9PiBlLnJlbW92ZSgpKTsKfQoKLy8gLS0tLS0tLS0tLSBnZW5lcmFsIGZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBjbGVhck1vdmFibGUoKSB7CiAgX19tb3ZhYmxlX3BvaW50cy5zcGxpY2UoMCwgX19tb3ZhYmxlX3BvaW50cy5sZW5ndGgpOwp9CgpmdW5jdGlvbiBjb3B5KCkgewogIGNvbnN0IGNvcHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBjYW52YXNgKTsKICBjb3B5LndpZHRoID0gd2lkdGg7CiAgY29weS5oZWlnaHQgPSBoZWlnaHQ7CiAgY29uc3QgY3R4ID0gY29weS5nZXRDb250ZXh0KGAyZGApOwogIGN0eC5kcmF3SW1hZ2UoX19jYW52YXMsIDAsIDAsIHdpZHRoLCBoZWlnaHQpOwogIHJldHVybiBjb3B5Owp9CgpmdW5jdGlvbiBjb2xvcihoID0gX19jdXJyZW50X2h1ZSwgcyA9IDUwLCBsID0gNTAsIGEgPSAxKSB7CiAgcmV0dXJuIGBoc2xhKCR7aH0sJHtzfSUsJHtsfSUsJHthfSlgOwp9CgpmdW5jdGlvbiBoaWdobGlnaHQoY29sb3IpIHsKICBfX2hpZ2hsaWdodF9jb2xvciA9IGNvbG9yOwogIHJlZHJhdygpOwp9CgpmdW5jdGlvbiBtaWxsaXMoKSB7CiAgcmV0dXJuIERhdGUubm93KCkgLSBfX3N0YXJ0X3RpbWU7Cn0KCmZ1bmN0aW9uIHBhdXNlKCkgewogIHBsYXlpbmcgPSBmYWxzZTsKfQoKZnVuY3Rpb24gcGxheSgpIHsKICBwbGF5aW5nID0gdHJ1ZTsKICBfX2RyYXcoKTsKfQoKZnVuY3Rpb24gcmFuZG9tQ29sb3IoYSA9IDEuMCwgY3ljbGUgPSB0cnVlKSB7CiAgaWYgKGN5Y2xlKSBfX2N1cnJlbnRfaHVlID0gKF9fY3VycmVudF9odWUgKyA3MykgJSAzNjA7CiAgcmV0dXJuIGBoc2xhKCR7X19jdXJyZW50X2h1ZX0sNTAlLDUwJSwke2F9KWA7Cn0KCmZ1bmN0aW9uIHNldE1vdmFibGUocG9pbnRzKSB7CiAgLy8gVE9ETzogc2hhcGVzCiAgaWYgKCFwb2ludHMuZm9yRWFjaCkgewogICAgcG9pbnRzID0gW3BvaW50c107CiAgfQogIHBvaW50cy5mb3JFYWNoKChwKSA9PiB7CiAgICBpZiAoX19tb3ZhYmxlX3BvaW50cy5pbmRleE9mKHApID09PSAtMSkgewogICAgICBfX21vdmFibGVfcG9pbnRzLnB1c2gocCk7CiAgICB9CiAgfSk7Cn0KCmZ1bmN0aW9uIHJlc3RvcmUoKSB7CiAgX19jdHgucmVzdG9yZSgpOwp9CgovKioKICogU2F2ZSB0aGUgY2FudmFzIGNvbnRleHQuCiAqLwpmdW5jdGlvbiBzYXZlKCkgewogIF9fY3R4LnNhdmUoKTsKfQoKZnVuY3Rpb24gdG9EYXRhVVJMKCkgewogIHJldHVybiBfX2NhbnZhcy50b0RhdGFVUkwoKTsKfQoKZnVuY3Rpb24gdG9nZ2xlUGxheSgpIHsKICBwbGF5aW5nID8gcGF1c2UoKSA6IHBsYXkoKTsKICByZXR1cm4gcGxheWluZzsKfQoKLy8gLS0tLS0tLS0tLSBkcmF3IGZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBhcmMoeCwgeSwgciwgcyA9IDAsIGUgPSBUQVUsIHdlZGdlID0gZmFsc2UpIHsKICBzdGFydCgpOwogIGlmICh3ZWRnZSkgX19jdHgubW92ZVRvKHgsIHkpOwogIF9fY3R4LmFyYyh4LCB5LCByLCBzLCBlKTsKICBpZiAod2VkZ2UpIF9fY3R4LmxpbmVUbyh4LCB5KTsKICBlbmQoKTsKfQoKZnVuY3Rpb24gYXhlcygKICBoTGFiZWwsCiAgaHMsCiAgaGUsCiAgdkxhYmVsLAogIHZzLAogIHZlLAogIGhzTGFiZWwgPSBmYWxzZSwKICBoZUxhYmVsID0gZmFsc2UsCiAgdnNMYWJlbCA9IGZhbHNlLAogIHZlTGFiZWwgPSBmYWxzZQopIHsKICBsaW5lKGhzLCAwLCBoZSwgMCk7CiAgbGluZSgwLCB2cywgMCwgdmUpOwoKICBjb25zdCBocG9zID0gMCAtIDU7CiAgdGV4dChgJHtoTGFiZWx9IOKGkmAsIHdpZHRoIC8gMiwgaHBvcywgQ0VOVEVSKTsKICB0ZXh0KGhzTGFiZWwgPyBoc0xhYmVsIDogaHMsIGhzLCBocG9zLCBDRU5URVIpOwogIHRleHQoaGVMYWJlbCA/IGhlTGFiZWwgOiBoZSwgaGUsIGhwb3MsIENFTlRFUik7CgogIGNvbnN0IHZwb3MgPSAtNTsKICB0ZXh0KGAke3ZMYWJlbH1gLCB2cG9zLCBoZWlnaHQgLyAyLCBSSUdIVCk7CiAgdGV4dChg4oaTYCwgdnBvcywgaGVpZ2h0IC8gMiArIDE2LCBSSUdIVCk7CiAgdGV4dCh2c0xhYmVsID8gdnNMYWJlbCA6IHZzLCB2cG9zLCB2cyArIDUsIFJJR0hUKTsKICB0ZXh0KHZlTGFiZWwgPyB2ZUxhYmVsIDogdmUsIHZwb3MsIHZlLCBSSUdIVCk7Cn0KCmZ1bmN0aW9uIGJlemllcihwb2ludHMpIHsKICBjb25zdCBbZmlyc3QsIC4uLnJlc3RdID0gcG9pbnRzOwogIHN0YXJ0KCk7CiAgdmVydGV4KGZpcnN0LngsIGZpcnN0LnkpOwogIGZvciAobGV0IGkgPSAwLCBlID0gcmVzdC5sZW5ndGg7IGkgPCBlOyBpICs9IDMpIHsKICAgIGxldCBbcDEsIHAyLCBwM10gPSByZXN0LnNsaWNlKGksIGkgKyAzKTsKICAgIGlmIChwMSAmJiBwMiAmJiBwMykgX19jdHguYmV6aWVyQ3VydmVUbyhwMS54LCBwMS55LCBwMi54LCBwMi55LCBwMy54LCBwMy55KTsKICB9CiAgZW5kKCk7Cn0KCmZ1bmN0aW9uIGJzcGxpbmUocG9pbnRzLCBvcGVuID0gdHJ1ZSkgewogIHN0YXJ0KCk7CiAgbmV3IEJTcGxpbmUocG9pbnRzLCBvcGVuKS5nZXRMVVQoKS5mb3JFYWNoKChwKSA9PiB2ZXJ0ZXgocC54LCBwLnkpKTsKICBlbmQoKTsKfQoKZnVuY3Rpb24gY2lyY2xlKHgsIHksIHIpIHsKICBhcmMoeCwgeSwgcik7Cn0KCmZ1bmN0aW9uIGNsZWFyKGNvbG9yID0gYHdoaXRlYCkgewogIHNhdmUoKTsKICBfX2NhbnZhcy5zdHlsZS5iYWNrZ3JvdW5kID0gY29sb3I7CiAgX19jYW52YXMud2lkdGggPSB3aWR0aDsKICBfX2N0eCA9IF9fY2FudmFzLmdldENvbnRleHQoYDJkYCk7CiAgaWYgKF9fZHJhd19ncmlkKSBncmlkKCk7CiAgcmVzdG9yZSgpOwp9CgpmdW5jdGlvbiBlbmQoY2xvc2UgPSBmYWxzZSkgewogIGlmIChjbG9zZSkgX19jdHguY2xvc2VQYXRoKCk7CiAgX19jdHguZmlsbCgpOwogIF9fY3R4LnN0cm9rZSgpOwogIGlmIChfX2N0eC5saW5lV2lkdGggJSAyID09PSAxKSB7CiAgICBfX2N0eC50cmFuc2xhdGUoLTAuNSwgLTAuNSk7CiAgfQp9CgpmdW5jdGlvbiBncmlkKCkgewogIHNhdmUoKTsKICBzZXRMaW5lV2lkdGgoMC41KTsKICBub0ZpbGwoKTsKICBzZXRTdHJva2UoX19ncmlkX2NvbG9yKTsKICBmb3IgKAogICAgbGV0IHggPSAoLTAuNSArIF9fZ3JpZF9zcGFjaW5nIC8gMikgfCAwOwogICAgeCA8IHdpZHRoOwogICAgeCArPSBfX2dyaWRfc3BhY2luZwogICkgewogICAgbGluZSh4LCAwLCB4LCBoZWlnaHQpOwogIH0KICBmb3IgKAogICAgbGV0IHkgPSAoLTAuNSArIF9fZ3JpZF9zcGFjaW5nIC8gMikgfCAwOwogICAgeSA8IGhlaWdodDsKICAgIHkgKz0gX19ncmlkX3NwYWNpbmcKICApIHsKICAgIGxpbmUoMCwgeSwgd2lkdGgsIHkpOwogIH0KICByZXN0b3JlKCk7Cn0KCmFzeW5jIGZ1bmN0aW9uIGltYWdlKGltZywgeCA9IDAsIHkgPSAwLCB3LCBoKSB7CiAgaWYgKHR5cGVvZiBpbWcgPT09IGBzdHJpbmdgKSB7CiAgICBpbWcgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGNvbnN0IHRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYGltZ2ApOwogICAgICB0YWcub25sb2FkID0gKCkgPT4gcmVzb2x2ZSh0YWcpOwogICAgICB0YWcub25lcnJvciA9ICgpID0+IHJlamVjdCgpOwogICAgICB0YWcuc3JjID0gaW1nOwogICAgfSk7CiAgfQogIF9fY3R4LmRyYXdJbWFnZShpbWcsIHgsIHksIHcgfHwgaW1nLndpZHRoLCBoIHx8IGltZy5oZWlnaHQpOwp9CgpmdW5jdGlvbiBsaW5lKHgxLCB5MSwgeDIsIHkyKSB7CiAgc3RhcnQoKTsKICB2ZXJ0ZXgoeDEsIHkxKTsKICB2ZXJ0ZXgoeDIsIHkyKTsKICBlbmQoKTsKfQoKZnVuY3Rpb24gcGxvdChmLCBhID0gMCwgYiA9IDEsIHN0ZXBzID0gMjQsIHhzY2FsZSA9IDEsIHlzY2FsZSA9IDEpIHsKICBjb25zdCBpbnRlcnZhbCA9IGIgLSBhOwogIHN0YXJ0KCk7CiAgZm9yIChsZXQgaSA9IDAsIGUgPSBzdGVwcyAtIDEsIHgsIHksIHY7IGkgPCBzdGVwczsgaSsrKSB7CiAgICB4ID0gYSArIGludGVydmFsICogKGkgLyBlKTsKICAgIHkgPSBmKHgpOwogICAgdmVydGV4KHggKiB4c2NhbGUsIHkgKiB5c2NhbGUpOwogIH0KICBlbmQoKTsKfQoKZnVuY3Rpb24gcGxvdERhdGEoZGF0YSwgeCwgeSkgewogIHN0YXJ0KCk7CiAgZGF0YS5mb3JFYWNoKChwKSA9PiB2ZXJ0ZXgocFt4XSwgcFt5XSkpOwogIGVuZCgpOwp9CgpmdW5jdGlvbiBwb2ludCh4LCB5KSB7CiAgY2lyY2xlKHgsIHksIDMpOwp9CgpmdW5jdGlvbiByZWN0KHgsIHksIHcsIGgpIHsKICBzdGFydCgpOwogIHZlcnRleCh4LCB5KTsKICB2ZXJ0ZXgoeCArIHcsIHkpOwogIHZlcnRleCh4ICsgdywgeSArIGgpOwogIHZlcnRleCh4LCB5ICsgaCk7CiAgdmVydGV4KHgsIHkpOwogIGVuZCgpOwp9CgovLyBkcmF3IGEgY2FyZGluYWwgc3BsaW5lIHdpdGggdmlydHVhbCBzdGFydCBhbmQgZW5kIHBvaW50CmZ1bmN0aW9uIHNwbGluZShwb2ludHMsIHZpcnR1YWwgPSB0cnVlLCB0aWdodG5lc3MgPSAxLCBUID0gdGlnaHRuZXNzKSB7CiAgbGV0IGNwb2ludHMgPSBwb2ludHM7CiAgaWYgKHZpcnR1YWwpIHsKICAgIGNvbnN0IGYwID0gcG9pbnRzWzBdLAogICAgICBmMSA9IHBvaW50c1sxXSwKICAgICAgZjIgPSBwb2ludHNbMl0sCiAgICAgIGZzbSA9IG5ldyBWZWN0b3IoZjAueCAvIDIgKyBmMi54IC8gMiwgZjAueSAvIDIgKyBmMi55IC8gMiksCiAgICAgIGYwciA9IG5ldyBWZWN0b3IoZjApLnJlZmxlY3QoZjEpLAogICAgICBmc3IgPSBmc20ucmVmbGVjdChmMSksCiAgICAgIGZuID0gbmV3IFZlY3RvcihmMHIueCAvIDIgKyBmc3IueCAvIDIsIGYwci55IC8gMiArIGZzci55IC8gMiksCiAgICAgIGwyID0gcG9pbnRzLmF0KC0zKSwKICAgICAgbDEgPSBwb2ludHMuYXQoLTIpLAogICAgICBsMCA9IHBvaW50cy5hdCgtMSksCiAgICAgIGxzbSA9IG5ldyBWZWN0b3IobDAueCAvIDIgKyBsMi54IC8gMiwgbDAueSAvIDIgKyBsMi55IC8gMiksCiAgICAgIGwwciA9IG5ldyBWZWN0b3IobDApLnJlZmxlY3QobDEpLAogICAgICBsbiA9IG5ldyBWZWN0b3IobDByLnggLyAyICsgbHNtLnggLyAyLCBsMHIueSAvIDIgKyBsc20ueSAvIDIpOwogICAgY3BvaW50cyA9IFtmbiwgLi4ucG9pbnRzLCBsbl07CiAgfQoKICAvLyBmb3VyIHBvaW50IHNsaWRpbmcgd2luZG93IG92ZXIgdGhlIHNlZ21lbnQKICBzdGFydCgpOwogIF9fY3R4Lm1vdmVUbyhjcG9pbnRzWzFdLngsIGNwb2ludHNbMV0ueSk7CiAgZm9yIChsZXQgaSA9IDAsIGUgPSBjcG9pbnRzLmxlbmd0aCAtIDM7IGkgPCBlOyBpKyspIHsKICAgIGxldCBbYzEsIGMyLCBjMywgYzRdID0gY3BvaW50cy5zbGljZShpLCBpICsgNCk7CiAgICBsZXQgcDIgPSB7CiAgICAgIHg6IGMyLnggKyAoYzMueCAtIGMxLngpIC8gKDYgKiBUKSwKICAgICAgeTogYzIueSArIChjMy55IC0gYzEueSkgLyAoNiAqIFQpLAogICAgfTsKICAgIGxldCBwMyA9IHsKICAgICAgeDogYzMueCAtIChjNC54IC0gYzIueCkgLyAoNiAqIFQpLAogICAgICB5OiBjMy55IC0gKGM0LnkgLSBjMi55KSAvICg2ICogVCksCiAgICB9OwogICAgX19jdHguYmV6aWVyQ3VydmVUbyhwMi54LCBwMi55LCBwMy54LCBwMy55LCBjMy54LCBjMy55KTsKICB9CiAgZW5kKCk7Cn0KCmZ1bmN0aW9uIHN0YXJ0KCkgewogIGlmIChfX2N0eC5saW5lV2lkdGggJSAyID09PSAxKSB7CiAgICBfX2N0eC50cmFuc2xhdGUoMC41LCAwLjUpOwogIH0KICBfX2N0eC5iZWdpblBhdGgoKTsKICBfX2ZpcnN0ID0gZmFsc2U7Cn0KCmZ1bmN0aW9uIHRleHQoc3RyLCB4LCB5LCB4YWxpZ24sIHlhbGlnbiA9IGBpbmhlcml0YCkgewogIHNhdmUoKTsKICBpZiAoeGFsaWduKSB7CiAgICBzZXRUZXh0QWxpZ24oeGFsaWduLCB5YWxpZ24pOwogIH0KICBfX2N0eC5maWxsVGV4dChzdHIsIHgsIHkpOwogIGlmIChfX3RleHRTdHJva2UpIHsKICAgIHNldFN0cm9rZShfX3RleHRTdHJva2UpOwogICAgX19jdHguc3Ryb2tlVGV4dChzdHIsIHgsIHkpOwogIH0KICByZXN0b3JlKCk7Cn0KCmZ1bmN0aW9uIHRyaWFuZ2xlKHgxLCB5MSwgeDIsIHkyLCB4MywgeTMpIHsKICBzdGFydCgpOwogIHZlcnRleCh4MSwgeTEpOwogIHZlcnRleCh4MiwgeTIpOwogIHZlcnRleCh4MywgeTMpOwogIHZlcnRleCh4MSwgeTEpOwogIGVuZCgpOwp9CgpmdW5jdGlvbiB2ZXJ0ZXgoeCwgeSkgewogIGlmIChfX2ZpcnN0KSB7CiAgICBfX2N0eC5saW5lVG8oeCwgeSk7CiAgfSBlbHNlIHsKICAgIF9fZmlyc3QgPSB7IHgsIHkgfTsKICAgIF9fY3R4Lm1vdmVUbyh4LCB5KTsKICB9Cn0KCi8vIC0tLS0tLS0tLS0gdHJhbnNmb3JtIGZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiByZXNldFRyYW5zZm9ybSgpIHsKICBfX2N0eC5yZXNldFRyYW5zZm9ybSgpOwp9CgpmdW5jdGlvbiByb3RhdGUoYW5nbGUgPSAwKSB7CiAgX19jdHgucm90YXRlKGFuZ2xlKTsKfQoKZnVuY3Rpb24gc2NhbGUoeCA9IDEsIHkgPSB4KSB7CiAgX19jdHguc2NhbGUoeCwgeSk7Cn0KCmZ1bmN0aW9uIHNjcmVlblRvV29ybGQoeCwgeSkgewogIGlmICh5ID09PSB1bmRlZmluZWQpIHsKICAgIHkgPSB4Lnk7CiAgICB4ID0geC54OwogIH0KCiAgbGV0IE0gPSBfX2N0eC5nZXRUcmFuc2Zvcm0oKS5pbnZlcnRTZWxmKCk7CgogIGxldCByZXQgPSB7CiAgICB4OiB4ICogTS5hICsgeSAqIE0uYyArIE0uZSwKICAgIHk6IHggKiBNLmIgKyB5ICogTS5kICsgTS5mLAogIH07CgogIHJldHVybiByZXQ7Cn0KCi8qKgogKiB0cmFuc2Zvcm1zOiB1bml2ZXJzYWwgZnJlZSB0cmFuc2Zvcm0gYmFzZWQgb24gYXBwbHlpbmcKICoKICogICAgICAgfCBhIGIgYyB8CiAqICAgbSA9IHwgZCBlIGYgfAogKiAgICAgICB8IDAgMCAxIHwKICovCmZ1bmN0aW9uIHRyYW5zZm9ybShhID0gMSwgYiA9IDAsIGMgPSAwLCBkID0gMCwgZSA9IDEsIGYgPSAwKSB7CiAgX19jdHgudHJhbnNmb3JtKGEsIGIsIGMsIGQsIGUsIGYpOwp9CgpmdW5jdGlvbiB0cmFuc2xhdGUoeCA9IDAsIHkgPSAwKSB7CiAgX19jdHgudHJhbnNsYXRlKHgsIHkpOwp9CgpmdW5jdGlvbiB3b3JsZFRvU2NyZWVuKHgsIHkpIHsKICBpZiAoeSA9PT0gdW5kZWZpbmVkKSB7CiAgICB5ID0geC55OwogICAgeCA9IHgueDsKICB9CgogIGxldCBNID0gX19jdHguZ2V0VHJhbnNmb3JtKCk7CgogIGxldCByZXQgPSB7CiAgICB4OiB4ICogTS5hICsgeSAqIE0uYyArIE0uZSwKICAgIHk6IHggKiBNLmIgKyB5ICogTS5kICsgTS5mLAogIH07CgogIHJldHVybiByZXQ7Cn0KCi8vIC0tLS0tLS0tLS0tLS0tLS0gc2V0dGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBzZXRCb3JkZXIod2lkdGggPSAxLCBjb2xvciA9IGBibGFja2ApIHsKICBpZiAoIXdpZHRoKSB7CiAgICBfX2NhbnZhcy5zdHlsZS5ib3JkZXIgPSBgbm9uZWA7CiAgfSBlbHNlIHsKICAgIF9fY2FudmFzLnN0eWxlLmJvcmRlciA9IGAke3dpZHRofXB4IHNvbGlkICR7Y29sb3J9YDsKICB9Cn0KCmZ1bmN0aW9uIHNldENvbG9yKGNvbG9yKSB7CiAgc2V0RmlsbChjb2xvcik7CiAgc2V0U3Ryb2tlKGNvbG9yKTsKfQoKZnVuY3Rpb24gc2V0Q3Jpc3AoZW5hYmxlZCA9IHRydWUpIHsKICBfX2NhbnZhcy5jbGFzc0xpc3QudG9nZ2xlKGBjcmlzcGAsIGVuYWJsZWQpOwp9CgpmdW5jdGlvbiBzZXRDdXJzb3IodHlwZSkgewogIF9fY3VycmVudF9jdXJzb3IgPSB0eXBlOwogIF9fY2FudmFzLnN0eWxlLmN1cnNvciA9IF9fY3VycmVudF9jdXJzb3I7Cn0KCmZ1bmN0aW9uIHNldEZpbGwoY29sb3IgPSBgYmxhY2tgKSB7CiAgaWYgKENTU19DT0xPUl9NQVBbY29sb3JdID09PSBfX2hpZ2hsaWdodF9jb2xvcikgewogICAgY29sb3IgPSBfX2N1cnJlbnRfaGlnaGxpZ2h0X2NvbG9yOwogIH0KICBfX2N0eC5maWxsU3R5bGUgPSBjb2xvcjsKfQoKZnVuY3Rpb24gc2V0Rm9udChmb250KSB7CiAgX19jdHguZm9udCA9IGZvbnQgfHwgYCR7X19mb250LndlaWdodH0gJHtfX2ZvbnQuc2l6ZX1weCAke19fZm9udC5mYW1pbHl9YDsKfQoKZnVuY3Rpb24gc2V0Rm9udEZhbWlseShuYW1lKSB7CiAgX19mb250LmZhbWlseSA9IG5hbWU7CiAgc2V0Rm9udCgpOwp9CmZ1bmN0aW9uIHNldEZvbnRTaXplKHB4KSB7CiAgX19mb250LnNpemUgPSBweDsKICBzZXRGb250KCk7Cn0KCmZ1bmN0aW9uIHNldEZvbnRXZWlnaHQodmFsKSB7CiAgX19mb250LndlaWdodCA9IHZhbDsKICBzZXRGb250KCk7Cn0KCmZ1bmN0aW9uIHNldEdyaWQoc3BhY2luZyA9IDIwLCBjb2xvciA9IGBsaWdodGdyZXlgKSB7CiAgX19kcmF3X2dyaWQgPSB0cnVlOwogIF9fZ3JpZF9zcGFjaW5nID0gc3BhY2luZzsKICBfX2dyaWRfY29sb3IgPSBjb2xvcjsKfQoKZnVuY3Rpb24gc2V0SGlnaGxpZ2h0Q29sb3IoY29sb3IpIHsKICBfX2N1cnJlbnRfaGlnaGxpZ2h0X2NvbG9yID0gY29sb3I7Cn0KCmZ1bmN0aW9uIHNldExpbmVEYXNoKC4uLnZhbHVlcykgewogIF9fY3R4LnNldExpbmVEYXNoKHZhbHVlcyk7Cn0KCmZ1bmN0aW9uIHNldExpbmVXaWR0aCh3aWR0aCA9IDEpIHsKICBfX2N0eC5saW5lV2lkdGggPSB3aWR0aDsKfQoKZnVuY3Rpb24gc2V0U3Ryb2tlKGNvbG9yID0gYGJsYWNrYCkgewogIGlmIChDU1NfQ09MT1JfTUFQW2NvbG9yXSA9PT0gX19oaWdobGlnaHRfY29sb3IpIHsKICAgIGNvbG9yID0gX19jdXJyZW50X2hpZ2hsaWdodF9jb2xvcjsKICB9CiAgX19jdHguc3Ryb2tlU3R5bGUgPSBjb2xvcjsKfQoKZnVuY3Rpb24gc2V0VGV4dEFsaWduKHhBbGlnbiwgeUFsaWduID0gQUxQSEFCRVRJQykgewogIF9fY3R4LnRleHRBbGlnbiA9IHhBbGlnbjsKICBfX2N0eC50ZXh0QmFzZUxpbmUgPSB5QWxpZ247Cn0KCmZ1bmN0aW9uIHNldFRleHREaXJlY3Rpb24oZGlyID0gYGluaGVyaXRgKSB7CiAgX19jdHguZGlyZWN0aW9uID0gZGlyOwp9CgpmdW5jdGlvbiBzZXRUZXh0U3Ryb2tlKGNvbG9yLCB3aWR0aCkgewogIF9fdGV4dFN0cm9rZSA9IGNvbG9yOwogIHNldExpbmVXaWR0aCh3aWR0aCk7Cn0KCi8vIC0tLS0tLS0tLS0tLS0tLS0gIm5vIC4uLiIgLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gbm9Cb3JkZXIoKSB7CiAgc2V0Qm9yZGVyKGZhbHNlKTsKfQoKZnVuY3Rpb24gbm9Db2xvcigpIHsKICBub0ZpbGwoKTsKICBub1N0cm9rZSgpOwp9CgpmdW5jdGlvbiBub0N1cnNvcigpIHsKICBfX2NhbnZhcy5zdHlsZS5jdXJzb3IgPSBgbm9uZWA7Cn0KCmZ1bmN0aW9uIG5vRmlsbCgpIHsKICBzZXRGaWxsKGB0cmFuc3BhcmVudGApOwp9CgpmdW5jdGlvbiBub0dyaWQoKSB7CiAgX19kcmF3X2dyaWQgPSBmYWxzZTsKfQoKZnVuY3Rpb24gbm9MaW5lRGFzaCgpIHsKICBfX2N0eC5zZXRMaW5lRGFzaChbXSk7Cn0KCmZ1bmN0aW9uIG5vTWFyZ2luZygpIHsKICBzZXRNYXJnaW4oMCk7Cn0KCmZ1bmN0aW9uIG5vU2hhZG93KCkgewogIHNldFNoYWRvdyhgdHJhbnNwYXJlbnRgLCAwKTsKfQoKZnVuY3Rpb24gbm9TdHJva2UoKSB7CiAgc2V0U3Ryb2tlKGB0cmFuc3BhcmVudGApOwp9CgpmdW5jdGlvbiBub1RleHRTdHJva2UoKSB7CiAgc2V0VGV4dFN0cm9rZShmYWxzZSwgdW5kZWZpbmVkKTsKfQo="),T=class extends E{static{o(this,"GraphicsElement")}handleAttributeChange(...e){}handleChildChanges(...e){}connectedCallback(){super.connectedCallback(),this.label=document.createElement("label"),this.title||(console.warn("<graphics-element> is missing a title attribute. Always caption your figures."),this.title=""),this.label.textContent=this.title,K(this)?this.loadSource():new IntersectionObserver((e,r)=>e.forEach(t=>{t.isIntersecting&&(this.loadSource(),r.disconnect())}),{threshold:.1,rootMargin:`${window.innerHeight}px`}).observe(this)}getStyle(){return`
:host([hidden]) { display: none; }
style { display: none; }
.top-title { display: flex; flex-direction: row; justify-content: space-between; }
canvas { touch-action: none; user-select: none; position: relative; z-index: 1; display: block; margin: auto; border-radius: 0; box-sizing: content-box !important; border: 1px solid lightgrey;
&.crisp { image-rendering: -moz-crisp-edges; image-rendering: -webkit-crisp-edges; image-rendering: pixelated; image-rendering: crisp-edges; }
&:focus { border: 1px solid red; }}
a { &.view-source { font-size: 60%; text-decoration: none;
&.plus { padding-left: 0.5em; }}}
button.reset { font-size: 0.5em; top: -0.35em; position: relative; }
label:not(:empty) { display: block; font-style: italic; font-size: 0.9em; text-align: right; padding-right: 1em; margin-top: 0.35em; }
`}async loadSource(e,r=this.width,t=this.height,$){if(!r&&!t&&(r=parseFloat(this.getAttribute("width")),t=parseFloat(this.getAttribute("height")),isNaN(r)&&(r=void 0),isNaN(t)&&(t=void 0)),!e)if(this.userCode)e=this.userCode;else{let s=this.getAttribute("src");if(s)e=await(await fetch(s)).text();else{let f=this.querySelector("graphics-source");f?e=f.textContent:e=`function setup() {
}
function draw() {
}
`}}if(this.userCode=e,!$)if(this.additionalSources)$=this.additionalSources;else{let s=this.querySelectorAll("source");$=await Promise.all(Array.from(s).map(f=>fetch(f.src).then(d=>d.text())))}this.additionalSources=$;let x=this.userCode;this.additionalSources.length>0&&(x=this.loadAdditionalSources(this.userCode,this.additionalSources));let g=x.matchAll(/addSlider\(['"`](.*)['"`]/g),i=[];for(let s of g)i.push(s[1]),x=x.replace(s[0],s[0]+`, (v) => (${s[1]} = v)`);if(i.length&&(x="let "+i.join(", ")+`;
`+x),x=x.replaceAll(/ from ['"].([^'"]+)['"]/g,` from "${B(location.href)}/$1"`),x.includes("function setup()")||(x=`function setup() {
}
`+x),!x.includes("setSize(")){let s="setSize();";r&&t&&(s=`setSize(${r}, ${t});`),x=x.replace("function setup() {",`function setup() {
  ${s}`)}import(`data:text/javascript;base64,${H(['"use strict";',`import { BSpline, Point, Circle, Vector, Matrix, CSS_COLOR_MAP } from "${z}";`,`const __randomId = "${Date.now()}";`,V,x,"export { reset as start, __canvas as canvas, halt, highlight, __getDescription as getDescription }"].join(`
`))}`).then(async s=>{let{start:f,canvas:d,halt:h,highlight:u,getDescription:L}=s;this.canvas=d,this.halt=()=>h(),this.highlight=b=>u(b),this.render();let{width:A,height:l}=await f(this);if(this.querySelectorAll("p").length===0)try{let b=L();if(b){let m=new DocumentFragment,S=document.createElement("div");m.append(S),S.innerHTML=b,[...S.children].forEach(Y=>this.append(Y))}}catch(b){console.error(b)}A&&l&&(this.style.width="",this.style.height="",this.width=A,this.height=l,this.setAttribute("width",A),this.setAttribute("height",l)),this.dispatchEvent(new CustomEvent("load")),this.onload&&this.onload()})}loadAdditionalSources(e,r){if(!r)return e;let t=new Array(r.length);return e+`
`+r.map(($,x)=>$.replace("function setup()",`function setup${x+1}()`).replace("function draw()",`function draw${x+1}()`)).join(`
`)+`
function __more_setup() { ${[...t].map(($,x)=>`if (typeof setup${x+1} !== \`undefined\`) setup${x+1}();`).join(`
`)} }
function __more_draw() { ${[...t].map(($,x)=>`if (typeof draw${x+1} !== \`undefined\`) draw${x+1}();`).join(`
`)} }
`}loadFromFunction(e){let r=e.toString();this.reset(r.substring(r.indexOf("{")+1,r.lastIndexOf("}")))}reset(e,r){this.halt&&this.halt(),this.crosslinked=!1,this.querySelector("button.remove-color")?.remove(),this.loadSource(e||this.userCode,this.width,this.height,r||this.additionalSources)}render(){super.render();let e=this._slot.parentNode;this.canvas&&e.insertBefore(this.canvas,this._slot),this.label&&e.insertBefore(this.label,this._slot);let r=document.createElement("div");r.classList.add("top-title");let t=document.createElement("span");t.classList.add("sources"),r.append(t);let $=document.createElement("button");$.classList.add("reset"),$.textContent=this.getAttribute("reset")||"reset",$.addEventListener("click",()=>this.reset()),r.append($);let x=this.getAttribute("src");if(x){let i=document.createElement("a");i.classList.add("view-source"),i.textContent=this.getAttribute("viewSource")||"view source",i.href=x,i.target="_blank",t.append(i)}let g=this.querySelectorAll("source");g.length&&g.forEach((i,n)=>{let{src:s}=i,f=document.createElement("a");f.classList.add("view-source","plus"),f.textContent=`[+${n+1}]`,f.href=s,f.target="_blank",t.append(f)}),this.label&&e.insertBefore(r,this.canvas),this.crosslink()}crosslink(){if(this.crosslinked)return;this.crosslinked=!0;let e=!1;if(this.querySelectorAll("p").forEach(r=>{r.querySelectorAll("*").forEach(t=>{if(!D.includes(t.tagName))return;e=!0;let $;t.classList.remove("calm"),t.addEventListener("pointerenter",()=>{$??=getComputedStyle(t)["-webkit-text-stroke-color"],this.highlight($)}),t.addEventListener("pointerleave",()=>this.highlight(!1))})}),e){let r=document.createElement("button");r.textContent="remove colors",r.classList.add("remove-color"),r.addEventListener("click",()=>{this.querySelectorAll("p").forEach(t=>{t.querySelectorAll("*").forEach($=>{D.includes($.tagName)&&$.classList.add("calm")})}),r.remove()}),this.append(r)}}},G=class extends E{static{o(this,"GraphicsSource")}constructor(){super(),this.style.display="none"}};await E.register(T),await E.register(G);export{R as BSpline,v as CSS_COLOR_MAP,O as Circle,N as Matrix,p as Point,I as Vector};
