var B=Object.defineProperty;var s=(i,e)=>B(i,"name",{value:e,configurable:!0});var T="registered as custom element";function G(i,e){console.warn(`missing implementation for ${e}(...data) in ${i.__proto__.constructor.name}`)}s(G,"NotImplemented");function w(i){return i.prototype.constructor.name.replace(/([A-Z])([a-z])/g,(e,r,t,x)=>{let a=`${r.toLowerCase()}${t}`;return x>0?`-${a}`:a})}s(w,"getElementTagName");var u=class extends HTMLElement{static{s(this,"CustomElement")}static register(e){if(!e[T]){let r=e.tagName||w(e);return customElements.define(r,e),e[T]=!0,customElements.whenDefined(r)}return Promise.resolve()}static get tagName(){return w(this)}constructor(e={}){super(),customElements.resolveScope||(customElements.resolveScope=function(x){try{return x.getRootNode().host}catch(a){console.warn(a)}return window}),this._options=e;let r={childList:x=>{this.handleChildChanges(Array.from(x.addedNodes),Array.from(x.removedNodes)),this.render()},attributes:x=>{this.handleAttributeChange(x.attributeName,x.oldValue,this.getAttribute(x.attributeName)),this.render()}};this._observer=new MutationObserver(x=>{this.isConnected&&x.forEach(a=>{r[a.type](a)})}),this._observer.observe(this,{childList:!0,attributes:!0});let t={mode:"open"};this._shadow=this.attachShadow(t),this._style=document.createElement("style"),this._style.textContent=this.getStyle(),this._options.header!==!1&&(this._header=document.createElement("header")),this._options.slot!==!1&&this._options.void!==!0&&(this._slot=document.createElement("slot")),this._options.footer!==!1&&(this._footer=document.createElement("footer"))}connectedCallback(){this.render()}handleChildChanges(e,r){this._options.void||G(this,"handleChildChanges")}handleAttributeChange(e,r,t){G(this,"handleAttributeChange")}getStyle(){return""}render(){this._shadow.innerHTML="",this._shadow.append(this._style),this._options.header!==!1&&this._shadow.append(this._header),this._options.slot!==!1&&this._shadow.append(this._slot),this._options.footer!==!1&&this._shadow.append(this._footer)}};var S=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","transparent","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","ALICEBLUE","ANTIQUEWHITE","AQUA","AQUAMARINE","AZURE","BEIGE","BISQUE","BLACK","BLANCHEDALMOND","BLUE","BLUEVIOLET","BROWN","BURLYWOOD","CADETBLUE","CHARTREUSE","CHOCOLATE","CORAL","CORNFLOWERBLUE","CORNSILK","CRIMSON","CYAN","DARKBLUE","DARKCYAN","DARKGOLDENROD","DARKGRAY","DARKGREEN","DARKGREY","DARKKHAKI","DARKMAGENTA","DARKOLIVEGREEN","DARKORANGE","DARKORCHID","DARKRED","DARKSALMON","DARKSEAGREEN","DARKSLATEBLUE","DARKSLATEGRAY","DARKSLATEGREY","DARKTURQUOISE","DARKVIOLET","DEEPPINK","DEEPSKYBLUE","DIMGRAY","DIMGREY","DODGERBLUE","FIREBRICK","FLORALWHITE","FORESTGREEN","FUCHSIA","GAINSBORO","GHOSTWHITE","GOLD","GOLDENROD","GRAY","GREEN","GREENYELLOW","GREY","HONEYDEW","HOTPINK","INDIANRED","INDIGO","IVORY","KHAKI","LAVENDER","LAVENDERBLUSH","LAWNGREEN","LEMONCHIFFON","LIGHTBLUE","LIGHTCORAL","LIGHTCYAN","LIGHTGOLDENRODYELLOW","LIGHTGRAY","LIGHTGREEN","LIGHTGREY","LIGHTPINK","LIGHTSALMON","LIGHTSEAGREEN","LIGHTSKYBLUE","LIGHTSLATEGRAY","LIGHTSLATEGREY","LIGHTSTEELBLUE","LIGHTYELLOW","LIME","LIMEGREEN","LINEN","MAGENTA","MAROON","MEDIUMAQUAMARINE","MEDIUMBLUE","MEDIUMORCHID","MEDIUMPURPLE","MEDIUMSEAGREEN","MEDIUMSLATEBLUE","MEDIUMSPRINGGREEN","MEDIUMTURQUOISE","MEDIUMVIOLETRED","MIDNIGHTBLUE","MINTCREAM","MISTYROSE","MOCCASIN","NAVAJOWHITE","NAVY","OLDLACE","OLIVE","OLIVEDRAB","ORANGE","ORANGERED","ORCHID","PALEGOLDENROD","PALEGREEN","PALETURQUOISE","PALEVIOLETRED","PAPAYAWHIP","PEACHPUFF","PERU","PINK","PLUM","POWDERBLUE","PURPLE","REBECCAPURPLE","RED","ROSYBROWN","ROYALBLUE","SADDLEBROWN","SALMON","SANDYBROWN","SEAGREEN","SEASHELL","SIENNA","SILVER","SKYBLUE","SLATEBLUE","SLATEGRAY","SLATEGREY","SNOW","SPRINGGREEN","STEELBLUE","TAN","TEAL","THISTLE","TOMATO","TRANSPARENT","TURQUOISE","VIOLET","WHEAT","WHITE","WHITESMOKE","YELLOW","YELLOWGREEN"],U={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",aqua:"rgb(0, 255, 255)",aquamarine:"rgb(127, 255, 212)",azure:"rgb(240, 255, 255)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",black:"rgb(0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb(0, 0, 255)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",burlywood:"rgb(222, 184, 135)",cadetblue:"rgb(95, 158, 160)",chartreuse:"rgb(127, 255, 0)",chocolate:"rgb(210, 105, 30)",coral:"rgb(255, 127, 80)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",crimson:"rgb(220, 20, 60)",cyan:"rgb(0, 255, 255)",darkblue:"rgb(0, 0, 139)",darkcyan:"rgb(0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb(0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb(85, 107, 47)",darkorange:"rgb(255, 140, 0)",darkorchid:"rgb(153, 50, 204)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkslateblue:"rgb(72, 61, 139)",darkslategray:"rgb(47, 79, 79)",darkslategrey:"rgb(47, 79, 79)",darkturquoise:"rgb(0, 206, 209)",darkviolet:"rgb(148, 0, 211)",deeppink:"rgb(255, 20, 147)",deepskyblue:"rgb(0, 191, 255)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb(30, 144, 255)",firebrick:"rgb(178, 34, 34)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb(34, 139, 34)",fuchsia:"rgb(255, 0, 255)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",goldenrod:"rgb(218, 165, 32)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",greenyellow:"rgb(173, 255, 47)",grey:"rgb(128, 128, 128)",honeydew:"rgb(240, 255, 240)",hotpink:"rgb(255, 105, 180)",indianred:"rgb(205, 92, 92)",indigo:"rgb(75, 0, 130)",ivory:"rgb(255, 255, 240)",khaki:"rgb(240, 230, 140)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lightblue:"rgb(173, 216, 230)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightsalmon:"rgb(255, 160, 122)",lightseagreen:"rgb(32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightyellow:"rgb(255, 255, 224)",lime:"rgb(0, 255, 0)",limegreen:"rgb(50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",maroon:"rgb(128, 0, 0)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb(0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumpurple:"rgb(147, 112, 219)",mediumseagreen:"rgb(60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb(0, 250, 154)",mediumturquoise:"rgb(72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb(25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navy:"rgb(0, 0, 128)",oldlace:"rgb(253, 245, 230)",olive:"rgb(128, 128, 0)",olivedrab:"rgb(107, 142, 35)",orange:"rgb(255, 165, 0)",orangered:"rgb(255, 69, 0)",orchid:"rgb(218, 112, 214)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",paleturquoise:"rgb(175, 238, 238)",palevioletred:"rgb(219, 112, 147)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",plum:"rgb(221, 160, 221)",powderblue:"rgb(176, 224, 230)",purple:"rgb(128, 0, 128)",rebeccapurple:"rgb(102, 51, 153)",red:"rgb(255, 0, 0)",rosybrown:"rgb(188, 143, 143)",royalblue:"rgb(65, 105, 225)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb(46, 139, 87)",seashell:"rgb(255, 245, 238)",sienna:"rgb(160, 82, 45)",silver:"rgb(192, 192, 192)",skyblue:"rgb(135, 206, 235)",slateblue:"rgb(106, 90, 205)",slategray:"rgb(112, 128, 144)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",springgreen:"rgb(0, 255, 127)",steelblue:"rgb(70, 130, 180)",tan:"rgb(210, 180, 140)",teal:"rgb(0, 128, 128)",thistle:"rgb(216, 191, 216)",tomato:"rgb(255, 99, 71)",transparent:"rgba(0,0,0,0)",turquoise:"rgb(64, 224, 208)",violet:"rgb(238, 130, 238)",wheat:"rgb(245, 222, 179)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellowgreen:"rgb(154, 205, 50)",ALICEBLUE:"rgb(240, 248, 255)",ANTIQUEWHITE:"rgb(250, 235, 215)",AQUA:"rgb(0, 255, 255)",AQUAMARINE:"rgb(127, 255, 212)",AZURE:"rgb(240, 255, 255)",BEIGE:"rgb(245, 245, 220)",BISQUE:"rgb(255, 228, 196)",BLACK:"rgb(0, 0, 0)",BLANCHEDALMOND:"rgb(255, 235, 205)",BLUE:"rgb(0, 0, 255)",BLUEVIOLET:"rgb(138, 43, 226)",BROWN:"rgb(165, 42, 42)",BURLYWOOD:"rgb(222, 184, 135)",CADETBLUE:"rgb(95, 158, 160)",CHARTREUSE:"rgb(127, 255, 0)",CHOCOLATE:"rgb(210, 105, 30)",CORAL:"rgb(255, 127, 80)",CORNFLOWERBLUE:"rgb(100, 149, 237)",CORNSILK:"rgb(255, 248, 220)",CRIMSON:"rgb(220, 20, 60)",CYAN:"rgb(0, 255, 255)",DARKBLUE:"rgb(0, 0, 139)",DARKCYAN:"rgb(0, 139, 139)",DARKGOLDENROD:"rgb(184, 134, 11)",DARKGRAY:"rgb(169, 169, 169)",DARKGREEN:"rgb(0, 100, 0)",DARKGREY:"rgb(169, 169, 169)",DARKKHAKI:"rgb(189, 183, 107)",DARKMAGENTA:"rgb(139, 0, 139)",DARKOLIVEGREEN:"rgb(85, 107, 47)",DARKORANGE:"rgb(255, 140, 0)",DARKORCHID:"rgb(153, 50, 204)",DARKRED:"rgb(139, 0, 0)",DARKSALMON:"rgb(233, 150, 122)",DARKSEAGREEN:"rgb(143, 188, 143)",DARKSLATEBLUE:"rgb(72, 61, 139)",DARKSLATEGRAY:"rgb(47, 79, 79)",DARKSLATEGREY:"rgb(47, 79, 79)",DARKTURQUOISE:"rgb(0, 206, 209)",DARKVIOLET:"rgb(148, 0, 211)",DEEPPINK:"rgb(255, 20, 147)",DEEPSKYBLUE:"rgb(0, 191, 255)",DIMGRAY:"rgb(105, 105, 105)",DIMGREY:"rgb(105, 105, 105)",DODGERBLUE:"rgb(30, 144, 255)",FIREBRICK:"rgb(178, 34, 34)",FLORALWHITE:"rgb(255, 250, 240)",FORESTGREEN:"rgb(34, 139, 34)",FUCHSIA:"rgb(255, 0, 255)",GAINSBORO:"rgb(220, 220, 220)",GHOSTWHITE:"rgb(248, 248, 255)",GOLD:"rgb(255, 215, 0)",GOLDENROD:"rgb(218, 165, 32)",GRAY:"rgb(128, 128, 128)",GREEN:"rgb(0, 128, 0)",GREENYELLOW:"rgb(173, 255, 47)",GREY:"rgb(128, 128, 128)",HONEYDEW:"rgb(240, 255, 240)",HOTPINK:"rgb(255, 105, 180)",INDIANRED:"rgb(205, 92, 92)",INDIGO:"rgb(75, 0, 130)",IVORY:"rgb(255, 255, 240)",KHAKI:"rgb(240, 230, 140)",LAVENDER:"rgb(230, 230, 250)",LAVENDERBLUSH:"rgb(255, 240, 245)",LAWNGREEN:"rgb(124, 252, 0)",LEMONCHIFFON:"rgb(255, 250, 205)",LIGHTBLUE:"rgb(173, 216, 230)",LIGHTCORAL:"rgb(240, 128, 128)",LIGHTCYAN:"rgb(224, 255, 255)",LIGHTGOLDENRODYELLOW:"rgb(250, 250, 210)",LIGHTGRAY:"rgb(211, 211, 211)",LIGHTGREEN:"rgb(144, 238, 144)",LIGHTGREY:"rgb(211, 211, 211)",LIGHTPINK:"rgb(255, 182, 193)",LIGHTSALMON:"rgb(255, 160, 122)",LIGHTSEAGREEN:"rgb(32, 178, 170)",LIGHTSKYBLUE:"rgb(135, 206, 250)",LIGHTSLATEGRAY:"rgb(119, 136, 153)",LIGHTSLATEGREY:"rgb(119, 136, 153)",LIGHTSTEELBLUE:"rgb(176, 196, 222)",LIGHTYELLOW:"rgb(255, 255, 224)",LIME:"rgb(0, 255, 0)",LIMEGREEN:"rgb(50, 205, 50)",LINEN:"rgb(250, 240, 230)",MAGENTA:"rgb(255, 0, 255)",MAROON:"rgb(128, 0, 0)",MEDIUMAQUAMARINE:"rgb(102, 205, 170)",MEDIUMBLUE:"rgb(0, 0, 205)",MEDIUMORCHID:"rgb(186, 85, 211)",MEDIUMPURPLE:"rgb(147, 112, 219)",MEDIUMSEAGREEN:"rgb(60, 179, 113)",MEDIUMSLATEBLUE:"rgb(123, 104, 238)",MEDIUMSPRINGGREEN:"rgb(0, 250, 154)",MEDIUMTURQUOISE:"rgb(72, 209, 204)",MEDIUMVIOLETRED:"rgb(199, 21, 133)",MIDNIGHTBLUE:"rgb(25, 25, 112)",MINTCREAM:"rgb(245, 255, 250)",MISTYROSE:"rgb(255, 228, 225)",MOCCASIN:"rgb(255, 228, 181)",NAVAJOWHITE:"rgb(255, 222, 173)",NAVY:"rgb(0, 0, 128)",OLDLACE:"rgb(253, 245, 230)",OLIVE:"rgb(128, 128, 0)",OLIVEDRAB:"rgb(107, 142, 35)",ORANGE:"rgb(255, 165, 0)",ORANGERED:"rgb(255, 69, 0)",ORCHID:"rgb(218, 112, 214)",PALEGOLDENROD:"rgb(238, 232, 170)",PALEGREEN:"rgb(152, 251, 152)",PALETURQUOISE:"rgb(175, 238, 238)",PALEVIOLETRED:"rgb(219, 112, 147)",PAPAYAWHIP:"rgb(255, 239, 213)",PEACHPUFF:"rgb(255, 218, 185)",PERU:"rgb(205, 133, 63)",PINK:"rgb(255, 192, 203)",PLUM:"rgb(221, 160, 221)",POWDERBLUE:"rgb(176, 224, 230)",PURPLE:"rgb(128, 0, 128)",REBECCAPURPLE:"rgb(102, 51, 153)",RED:"rgb(255, 0, 0)",ROSYBROWN:"rgb(188, 143, 143)",ROYALBLUE:"rgb(65, 105, 225)",SADDLEBROWN:"rgb(139, 69, 19)",SALMON:"rgb(250, 128, 114)",SANDYBROWN:"rgb(244, 164, 96)",SEAGREEN:"rgb(46, 139, 87)",SEASHELL:"rgb(255, 245, 238)",SIENNA:"rgb(160, 82, 45)",SILVER:"rgb(192, 192, 192)",SKYBLUE:"rgb(135, 206, 235)",SLATEBLUE:"rgb(106, 90, 205)",SLATEGRAY:"rgb(112, 128, 144)",SLATEGREY:"rgb(112, 128, 144)",SNOW:"rgb(255, 250, 250)",SPRINGGREEN:"rgb(0, 255, 127)",STEELBLUE:"rgb(70, 130, 180)",TAN:"rgb(210, 180, 140)",TEAL:"rgb(0, 128, 128)",THISTLE:"rgb(216, 191, 216)",TOMATO:"rgb(255, 99, 71)",TRANSPARENT:"rgba(0,0,0,0)",TURQUOISE:"rgb(64, 224, 208)",VIOLET:"rgb(238, 130, 238)",WHEAT:"rgb(245, 222, 179)",WHITE:"rgb(255, 255, 255)",WHITESMOKE:"rgb(245, 245, 245)",YELLOW:"rgb(255, 255, 0)",YELLOWGREEN:"rgb(154, 205, 50)"};function D(i,e,r,t,x,I,g){var $,n,o,f,c=r.length,E=r[0].length;if(e<1)throw new Error("degree must be at least 1 (linear)");if(e>c-1)throw new Error("degree must be less than or equal to point count - 1");if(!x)for(x=[],$=0;$<c;$++)x[$]=1;if(x.length<r.length&&(x=x.concat(x.slice(0,e))),t){if(t.length!==c+e+1)throw new Error("bad knot vector length")}else{var t=[];for($=0;$<c+e+1;$++)t[$]=$}t.length===r.length&&(t=t.concat(t.slice(0,e)));var l=[e,t.length-1-e],h=t[l[0]],p=t[l[1]];if(g||(i=i*(p-h)+h),i<h||i>p)throw new Error("out of bounds");for(o=l[0];o<l[1]&&!(i>=t[o]&&i<=t[o+1]);o++);var d=[];for($=0;$<c;$++){for(d[$]=[],n=0;n<E;n++)d[$][n]=r[$][n]*x[$];d[$][E]=x[$]}var O;for(f=1;f<=e+1;f++)for($=o;$>o-e-1+f;$--)for(O=(i-t[$])/(t[$+e+1-f]-t[$]),n=0;n<E+1;n++)d[$][n]=(1-O)*d[$-1][n]+O*d[$][n];var I=I||[];for($=0;$<E;$++)I[$]=d[o][$]/d[o][E];return I}s(D,"interpolate");var b=3,A=class{static{s(this,"BSpline")}constructor(e,r=!0){this.points=e,this.points=e.map(t=>t instanceof Array?t:[t.x,t.y]),this.formKnots(r),this.formWeights()}getLUT(e=100){let r=e-1;return[...new Array(e)].map((t,x)=>{let a=D(x/r,b,this.points,this.knots,this.weights);return{x:a[0],y:a[1]}})}formKnots(e=!1){if(!e)return this.formUniformKnots();let r=[],t=this.points.length,x=t-b;for(let a=1;a<t-b;a++)r.push(a+b);for(let a=0;a<=b;a++)r=[b].concat(r);for(let a=0;a<=b;a++)r.push(x+b);return this.knots=r}formUniformKnots(){return this.knots=[...new Array(this.points.length+b+1)].map((e,r)=>r)}formWeights(){return this.weights=this.points.map(e=>1)}};var L=class{static{s(this,"Point")}constructor(e,r){this.x=e,this.y=r}},N=class extends L{static{s(this,"Circle")}constructor(e,r,t){super(e,r),this.r=t}};var m=class i{static{s(this,"Vector")}constructor(e,r,t){arguments.length===1&&(t=e.z,r=e.y,e=e.x),this.x=e,this.y=r,t!==void 0&&(this.z=t)}dist(e,r,t=0){r!==void 0&&(e={x:e,y:r,z:t});let x=0;x+=(this.x-e.x)**2,x+=(this.y-e.y)**2;let a=this.z?this.z:0,g=e.z?e.z:0;return x+=(a-g)**2,x**.5}normalize(e){let r=this.dist(0,0,0);return new i(e*this.x/r,e*this.y/r,e*this.z/r)}getAngle(){return-Math.atan2(this.y,this.x)}reflect(e){let r=new i(e.x-this.x,e.y-this.y);return e.z!==void 0&&(r.z=e.z,this.z!==void 0&&(r.z-=this.z)),this.subtract(r)}add(e){let r=new i(this.x+e.x,this.y+e.y);return this.z!==void 0&&(r.z=this.z,e.z!==void 0&&(r.z+=e.z)),r}subtract(e){let r=new i(this.x-e.x,this.y-e.y);return this.z!==void 0&&(r.z=this.z,e.z!==void 0&&(r.z-=e.z)),r}scale(e=1){if(e===0)return new i(0,0,this.z===void 0?void 0:0);let r=new i(this.x*e,this.y*e);return this.z!==void 0&&(r.z=this.z*e),r}};function K(i){if(i.length!==i[0].length){console.warn("Cannot invert non-square matrices");return}var e=0,r=0,t=0,x=i.length,a=0,g=0,$=[],n=[];for(e=0;e<x;e+=1)for($[$.length]=[],n[n.length]=[],t=0;t<x;t+=1)e==t?$[e][t]=1:$[e][t]=0,n[e][t]=i[e][t];for(e=0;e<x;e+=1){if(a=n[e][e],a==0){for(r=e+1;r<x;r+=1)if(n[r][e]!=0){for(t=0;t<x;t++)a=n[e][t],n[e][t]=n[r][t],n[r][t]=a,a=$[e][t],$[e][t]=$[r][t],$[r][t]=a;break}if(a=n[e][e],a==0)return}for(t=0;t<x;t++)n[e][t]=n[e][t]/a,$[e][t]=$[e][t]/a;for(r=0;r<x;r++)if(r!=e)for(a=n[r][e],t=0;t<x;t++)n[r][t]-=a*n[e][t],$[r][t]-=a*$[e][t]}return $}s(K,"invert");function Y(i,e){var r=[],t=v(e);return i.forEach((x,a)=>{r[a]=[],t.forEach((g,$)=>{r[a][$]=x.map((n,o)=>g[o]*n).reduce((n,o)=>n+o,0)})}),r}s(Y,"multiply");function v(i){return i[0].map((e,r)=>i.map(t=>t[r]))}s(v,"transpose");var R=class i{static{s(this,"Matrix")}constructor(e,r,t){t=e instanceof Array?e:t,this.data=t??[...new Array(e)].map(x=>[...new Array(r)].map(a=>0)),this.rows=this.data.length,this.cols=this.data[0].length}setData(e){this.data=e}get(e,r){return this.data[e][r]}set(e,r,t){this.data[e][r]=t}row(e){return this.data[e]}col(e){var r=this.data,t=[];for(let x=0,a=r.length;x<a;x++)t.push(r[x][e]);return t}multiply(e){return new i(Y(this.data,e.data))}invert(){return new i(K(this.data))}transpose(){return new i(v(this.data))}};function M(i){let e=new TextEncoder().encode(i),r=String.fromCodePoint(...e);return btoa(r)}s(M,"base64");function H(i){let e=atob(i),r=Uint8Array.from(e,t=>t.codePointAt(0));return new TextDecoder().decode(r)}s(H,"decode64");function C(i){let e=/^(.*)\/([^.]+(\.([^\/?#]+))+)(\?[^#]*)?(#.*)?$/,r=i.match(e);if(r!==null){let{[1]:t,[2]:x,[4]:a}=r;i=t}return i}s(C,"getURLbase");function k(i){if(typeof window>"u"||typeof document>"u")return!0;var e=i.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}s(k,"isInViewport");var P=String(import.meta.url),_=H("Y29uc3QgQUxQSEFCRVRJQyA9IGBhbHBoYWJldGljYDsKY29uc3QgQVVUTyA9IGBhdXRvYDsKY29uc3QgQk9UVE9NID0gYGJvdHRvbWA7CmNvbnN0IEJPVFRPTV9MRUZUID0gYGJvdHRvbi1sZWZ0YDsKY29uc3QgQk9UVE9NX1JJR0hUID0gYGJvdHRvbS1yaWdodGA7CmNvbnN0IENFTlRFUiA9IGBjZW50ZXJgOwpjb25zdCBDT05TVFJBSU4gPSB0cnVlOwpjb25zdCBDUk9TUyA9IGBjcm9zc2hhaXJgOwpjb25zdCBFTkQgPSBgZW5kYDsKY29uc3QgSEFORCA9IGBwb2ludGVyYDsKY29uc3QgSEFOR0lORyA9IGBoYW5naW5nYDsKY29uc3QgSURFT0dSQVBISUMgPSBgaWRlb2dyYXBoaWNgOwpjb25zdCBMRUZUID0gYGxlZnRgOwpjb25zdCBMVFIgPSBgbHRyYDsKY29uc3QgTUlERExFID0gYG1pZGRsZWA7CmNvbnN0IFBPSU5URVIgPSBgZGVmYXVsdGA7CmNvbnN0IFJJR0hUID0gYHJpZ2h0YDsKY29uc3QgUlRMID0gYHJ0bGA7CmNvbnN0IFNUQVJUID0gYHN0YXJ0YDsKY29uc3QgVE9QID0gYHRvcGA7CmNvbnN0IFRPUF9MRUZUID0gYHRvcC1sZWZ0YDsKY29uc3QgVE9QX1JJR0hUID0gYHRvcC1yaWdodGA7Cgpjb25zdCBwb2ludGVyID0geyB4OiAwLCB5OiAwIH07CmNvbnN0IGtleWJvYXJkID0ge307CgovLyBtYXRoIGZ1bmN0aW9ucyBhbmQgY29uc3RhbnRzCmNvbnN0IHsKICBhYnMsCiAgYWNvcywKICBhY29zaCwKICBhc2luLAogIGFzaW5oLAogIGF0YW4sCiAgYXRhbjIsCiAgYXRhbmgsCiAgY2JydCwKICBjZWlsLAogIGNsejMyLAogIGNvcywKICBjb3NoLAogIGV4cCwKICBleHBtMSwKICBmbG9vciwKICBmcm91bmQsCiAgaHlwb3QsCiAgaW11bCwKICBsb2c6IGxuLAogIGxvZzEwOiBsb2csCiAgbG9nMiwKICBtYXgsCiAgbWluLAogIHBvdywKICByb3VuZCwKICBzaWduLAogIHNpbiwKICBzaW5oLAogIHNxcnQsCiAgdGFuLAogIHRhbmgsCiAgdHJ1bmMsCn0gPSBNYXRoOwpjb25zdCB7IFBJLCBFIH0gPSBNYXRoOwpjb25zdCBjb25zdHJhaW4gPSAodiwgcywgZSkgPT4gKHYgPCBzID8gcyA6IHYgPiBlID8gZSA6IHYpOwpjb25zdCBjc2MgPSAodikgPT4gMSAvIHNpbih2KTsKY29uc3QgY3RuID0gKHYpID0+IGNvcyh2KSAvIHNpbih2KTsKY29uc3QgZGVncmVlcyA9ICh2LCBjb25zdHJhaW4pID0+IHsKICBjb25zdCBkID0gKHYgLyBQSSkgKiAxODA7CiAgaWYgKCFjb25zdHJhaW4pIHJldHVybiBkOwogIHdoaWxlIChkIDwgMCkgZCArPSAzNjA7CiAgcmV0dXJuIGQgJSAzNjA7Cn07CmNvbnN0IGRpc3QgPSAoeDEsIHkxLCB4MiwgeTIpID0+ICgoeDIgLSB4MSkgKiogMiArICh5MiAtIHkxKSAqKiAyKSAqKiAwLjU7CmNvbnN0IGVwc2lsb24gPSBOdW1iZXIuTUlOX1ZBTFVFOwpjb25zdCBodWdlID0gMV8wMDBfMDAwXzAwMDsKY29uc3QgbWFwID0gKHYsIHMsIGUsIG5zLCBuZSwgY29uc3RyYWluZWQgPSBmYWxzZSkgPT4gewogIGNvbnN0IGkxID0gZSAtIHMsCiAgICBpMiA9IG5lIC0gbnMsCiAgICBwID0gdiAtIHM7CiAgbGV0IHIgPSBucyArIChwICogaTIpIC8gaTE7CiAgaWYgKGNvbnN0cmFpbmVkKSByZXR1cm4gY29uc3RyYWluKHIsIG5zLCBuZSk7CiAgcmV0dXJuIHI7Cn07CmNvbnN0IHJhZGlhbnMgPSAodikgPT4gewogIGNvbnN0IHIgPSAodiAvIDE4MCkgKiBQSTsKICBpZiAoIWNvbnN0cmFpbikgcmV0dXJuIHI7CiAgd2hpbGUgKHIgPCAwKSByICs9IFRBVTsKICByZXR1cm4gciAlIFRBVTsKfTsKY29uc3QgcmFuZG9tID0gKGEgPSAxLCBiKSA9PiB7CiAgaWYgKGIgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGEgKiBNYXRoLnJhbmRvbSgpOwogIHJldHVybiBhICsgTWF0aC5yYW5kb20oKSAqIChiIC0gYSk7Cn07CmNvbnN0IHNlYyA9ICh2KSA9PiAxIC8gY29zKHYpOwpjb25zdCBUQVUgPSBQSSAqIDI7CgovLyAicHVibGljIiB2YXJzCgpsZXQgY3VycmVudFBvaW50OwpsZXQgZnJhbWU7CmxldCBmcmFtZURlbHRhOwpsZXQgaGVpZ2h0OwpsZXQgd2lkdGg7CmxldCBwbGF5aW5nOwoKLy8gImludGVybmFsIiB2YXJzCgpsZXQgX19jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBjYW52YXNgKTsKX19jYW52YXMudGFiSW5kZXggPSAwOwpfX2NhbnZhcy5hZGRFdmVudExpc3RlbmVyKGBwb2ludGVyZG93bmAsICgpID0+IF9fY2FudmFzLmZvY3VzKCkpOwpsZXQgX19jdHggPSBfX2NhbnZhcy5nZXRDb250ZXh0KGAyZGApOwoKbGV0IF9fY3VycmVudF9jdXJzb3I7CmxldCBfX2N1cnJlbnRfaGlnaGxpZ2h0X2NvbG9yOwpsZXQgX19jdXJyZW50X2h1ZTsKbGV0IF9fZHJhd19ncmlkOwpsZXQgX19kcmF3aW5nOwpsZXQgX19lbGVtZW50OwpsZXQgX19maW5pc2hlZF9zZXR1cDsKbGV0IF9fZmlyc3Q7CmxldCBfX2ZvbnQ7CmxldCBfX2dyaWRfY29sb3I7CmxldCBfX2dyaWRfc3BhY2luZzsKbGV0IF9faGlnaGxpZ2h0X2NvbG9yOwpsZXQgX19tb3ZhYmxlX3BvaW50czsKbGV0IF9fcmVkcmF3aW5nOwpsZXQgX19zdGFydF90aW1lOwpsZXQgX19zdHlsZV9zdGFjazsKbGV0IF9fdGV4dFN0cm9rZTsKbGV0IF9fbGFzdF9mcmFtZTsKCmNvbnN0IGZpbmQgPSAocXMpID0+IHsKICByZXR1cm4gX19lbGVtZW50LnF1ZXJ5U2VsZWN0b3IocXMpOwp9OwoKY29uc3QgZmluZEFsbCA9IChxcykgPT4gewogIHJldHVybiBfX2VsZW1lbnQucXVlcnlTZWxlY3RvckFsbChxcyk7Cn07Cgpjb25zdCByZXNldCA9IGFzeW5jIChlbGVtZW50ID0gX19lbGVtZW50KSA9PiB7CiAgX19lbGVtZW50ID0gZWxlbWVudDsKCiAgLy8gZGVmYXVsdCB2YXJpYWJsZSB2YWx1ZXMKICBfX2N1cnJlbnRfY3Vyc29yID0gYGF1dG9gOwogIF9fY3VycmVudF9oaWdobGlnaHRfY29sb3IgPSBgcmdiKDAsMjU0LDEyNClgOwogIF9fY3VycmVudF9odWUgPSAwOwogIF9fZHJhd19ncmlkID0gdHJ1ZTsKICBfX2RyYXdpbmcgPSBmYWxzZTsKICBfX2ZpbmlzaGVkX3NldHVwID0gZmFsc2U7CiAgX19mb250ID0geyBmYW1pbHk6IGBzYW5zLXNlcmlmYCwgc2l6ZTogMTYsIHdlaWdodDogNDAwIH07CiAgX19ncmlkX2NvbG9yID0gYGxpZ2h0Z3JleWA7CiAgX19ncmlkX3NwYWNpbmcgPSAyMDsKICBfX2hpZ2hsaWdodF9jb2xvciA9IGZhbHNlOwogIF9fbW92YWJsZV9wb2ludHMgPSBbXTsKICBfX3JlZHJhd2luZyA9IGZhbHNlOwogIF9fc3RhcnRfdGltZSA9IERhdGUubm93KCk7CiAgX19zdHlsZV9zdGFjayA9IFtdOwogIF9fdGV4dFN0cm9rZSA9IGB0cmFuc3BhcmVudGA7CgogIGN1cnJlbnRQb2ludCA9IGZhbHNlOwogIHBsYXlpbmcgPSBmYWxzZTsKICBmcmFtZSA9IDA7CiAgcG9pbnRlci54ID0gMDsKICBwb2ludGVyLnkgPSAwOwogIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGtleWJvYXJkKS5mb3JFYWNoKChuKSA9PiBkZWxldGUga2V5Ym9hcmRbbl0pOwoKICAvLyBtYWtlIHN1cmUgd2UgZG9uJ3QgZG91YmxlLWdlbmVyYXRlIHRoZXNlOgogIGNsZWFyU2xpZGVycygpOwogIGNsZWFyQnV0dG9ucygpOwoKICAvLyBydW4gc2V0dXAKICBhd2FpdCBfX3NldHVwKCk7CiAgX19maW5pc2hlZF9zZXR1cCA9IHRydWU7CgogIC8vIHJ1biBmaXJzdCBkcmF3CiAgX19sYXN0X2ZyYW1lID0gRGF0ZS5ub3coKTsKICBhd2FpdCBfX2RyYXcoKTsKCiAgcmV0dXJuIHsgd2lkdGgsIGhlaWdodCB9Owp9OwoKY29uc3QgaGFsdCA9ICgpID0+IHsKICBwbGF5aW5nID0gZmFsc2U7CiAgX19jYW52YXMgPSB1bmRlZmluZWQ7CiAgX19jdHggPSB1bmRlZmluZWQ7CiAgX19maW5pc2hlZF9zZXR1cCA9IGZhbHNlOwogIF9fZHJhd2luZyA9IHRydWU7CiAgX19yZWRyYXdpbmcgPSB0cnVlOwogIF9fZmlyc3QgPSB1bmRlZmluZWQ7CiAgX19tb3ZhYmxlX3BvaW50cyA9IHVuZGVmaW5lZDsKICBfX2N1cnJlbnRfY3Vyc29yID0gdW5kZWZpbmVkOwogIF9fY3VycmVudF9odWUgPSAwOwogIF9fZm9udCA9IHVuZGVmaW5lZDsKICBfX3N0YXJ0X3RpbWUgPSAwOwogIGNsZWFyU2xpZGVycygpOwogIGNsZWFyQnV0dG9ucygpOwp9OwoKY29uc3QgX19zZXR1cCA9IGFzeW5jICgpID0+IHsKICBpZiAodHlwZW9mIHNldHVwICE9PSBgdW5kZWZpbmVkYCkgYXdhaXQgc2V0dXAoKTsKICBpZiAodHlwZW9mIF9fbW9yZV9zZXR1cCAhPT0gYHVuZGVmaW5lZGApIGF3YWl0IF9fbW9yZV9zZXR1cCgpOwogIGlmICghd2lkdGggJiYgIWhlaWdodCkgc2V0U2l6ZSgpOwp9OwoKY29uc3Qgc2V0U2l6ZSA9ICh3ID0gNDAwLCBoID0gMjAwKSA9PiB7CiAgd2lkdGggPSBfX2NhbnZhcy53aWR0aCA9IHc7CiAgaGVpZ2h0ID0gX19jYW52YXMuaGVpZ2h0ID0gaDsKICBfX2VsZW1lbnQuc3R5bGUubWF4V2lkdGggPSBgY2FsYygyZW0gKyAke3dpZHRofXB4YDsKICBfX2N0eCA9IF9fY2FudmFzLmdldENvbnRleHQoYDJkYCk7CiAgX19kcmF3KCk7Cn07Cgpjb25zdCBfX2RyYXcgPSBhc3luYyAoKSA9PiB7CiAgaWYgKCFfX2ZpbmlzaGVkX3NldHVwKSByZXR1cm47CiAgaWYgKCFfX2RyYXdpbmcpIHsKICAgIF9fZHJhd2luZyA9IHRydWU7CiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpOwogICAgZnJhbWVEZWx0YSA9IG5vdyAtIF9fbGFzdF9mcmFtZTsKICAgIGZyYW1lKys7CiAgICByZXNldFRyYW5zZm9ybSgpOwogICAgaWYgKHR5cGVvZiBkcmF3ICE9PSBgdW5kZWZpbmVkYCkgYXdhaXQgZHJhdygpOwogICAgaWYgKHR5cGVvZiBfX21vcmVfZHJhdyAhPT0gYHVuZGVmaW5lZGApIGF3YWl0IF9fbW9yZV9kcmF3KCk7CiAgICBfX2RyYXdpbmcgPSBmYWxzZTsKICAgIF9fbGFzdF9mcmFtZSA9IG5vdzsKICAgIGlmIChwbGF5aW5nKSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gX19kcmF3KCkpOwogIH0KfTsKCmNvbnN0IHJlZHJhdyA9ICgpID0+IHsKICBpZiAoX19yZWRyYXdpbmcpIHJldHVybjsKICBpZiAocGxheWluZykgcmV0dXJuOwogIF9fcmVkcmF3aW5nID0gdHJ1ZTsKICBfX2RyYXcoKTsKICBfX3JlZHJhd2luZyA9IGZhbHNlOwp9OwoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tIHBvaW50ZXIgaGVscGVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmNvbnN0IF9fY2hlY2tGb3JDdXJyZW50UG9pbnQgPSAoeCwgeSwgdHlwZSkgPT4gewogIGNvbnN0IG1hdGNoZXMgPSBbXTsKICBjb25zdCBtYXRjaFBhZGRpbmcgPSB0eXBlID09PSBgbW91c2VgID8gMTAgOiAzMDsKICBfX21vdmFibGVfcG9pbnRzLmZvckVhY2goKHApID0+IHsKICAgIGxldCB4MiA9IHBbMF0gPT09IHVuZGVmaW5lZCA/IHAueCA6IHBbMF07CiAgICBsZXQgeTIgPSBwWzFdID09PSB1bmRlZmluZWQgPyBwLnkgOiBwWzFdOwogICAgY29uc3QgZCA9IGRpc3QoeCwgeSwgeDIsIHkyKTsKICAgIGlmIChkIDwgKHAuciA/IHAuciA6IDApICsgbWF0Y2hQYWRkaW5nKSB7CiAgICAgIG1hdGNoZXMucHVzaCh7IHAsIGQgfSk7CiAgICB9CiAgfSk7CiAgY3VycmVudFBvaW50ID0gZmFsc2U7CiAgX19jYW52YXMuc3R5bGUuY3Vyc29yID0gYGF1dG9gOwogIGlmIChtYXRjaGVzLmxlbmd0aCkgewogICAgbWF0Y2hlcy5zb3J0KChhLCBiKSA9PiBhLmQgLSBiLmQpOwogICAgY3VycmVudFBvaW50ID0gbWF0Y2hlc1swXS5wOwogICAgX19jYW52YXMuc3R5bGUuY3Vyc29yID0gYHBvaW50ZXJgOwogIH0KfTsKCi8vIC0tLS0tLS0tLS0tLS0tLSBwb2ludGVyIGV2ZW50IGhhbmRsaW5nIC0tLS0tLS0tLS0tLS0tLS0tLS0KCmNvbnN0IF9fcG9pbnRlckRvd24gPSAoeCwgeSkgPT4gewogIGlmIChjdXJyZW50UG9pbnQpIHsKICAgIGN1cnJlbnRQb2ludC5fZHggPSBjdXJyZW50UG9pbnQueCAtIHg7CiAgICBjdXJyZW50UG9pbnQuX2R5ID0gY3VycmVudFBvaW50LnkgLSB5OwogIH0KICBpZiAodHlwZW9mIHBvaW50ZXJEb3duICE9PSBgdW5kZWZpbmVkYCkgcG9pbnRlckRvd24oeCwgeSk7Cn07CgpfX2NhbnZhcy5hZGRFdmVudExpc3RlbmVyKAogIGBwb2ludGVyZG93bmAsCiAgKHsgb2Zmc2V0WCwgb2Zmc2V0WSwgcG9pbnRlclR5cGU6IHR5cGUgfSkgPT4gewogICAgaWYgKF9fZmluaXNoZWRfc2V0dXApIHsKICAgICAgY29uc3QgeyB4LCB5IH0gPSBzY3JlZW5Ub1dvcmxkKG9mZnNldFgsIG9mZnNldFkpOwogICAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgeCwgeSwgdHlwZSwgZG93bjogdHJ1ZSwgbWFyazogeyB4LCB5IH0gfSk7CiAgICAgIGlmICh0eXBlICE9PSBgbW91c2VgKSB7CiAgICAgICAgX19jaGVja0ZvckN1cnJlbnRQb2ludCh4LCB5LCB0eXBlKTsKICAgICAgfQogICAgICBfX3BvaW50ZXJEb3duKHgsIHkpOwogICAgfQogIH0KKTsKCmNvbnN0IF9fcG9pbnRlclVwID0gKHgsIHkpID0+IHsKICBpZiAodHlwZW9mIHBvaW50ZXJVcCAhPT0gYHVuZGVmaW5lZGApIHBvaW50ZXJVcCh4LCB5KTsKICBpZiAocG9pbnRlci5tYXJrPy54ID09PSB4ICYmIHBvaW50ZXIubWFyaz8ueSA9PT0geSkgewogICAgaWYgKHR5cGVvZiBwb2ludGVyQ2xpY2sgIT09IGB1bmRlZmluZWRgKSBwb2ludGVyQ2xpY2soeCwgeSk7CiAgfQp9OwoKX19jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigKICBgcG9pbnRlcnVwYCwKICAoeyBvZmZzZXRYLCBvZmZzZXRZLCBwb2ludGVyVHlwZTogdHlwZSB9KSA9PiB7CiAgICBpZiAoX19maW5pc2hlZF9zZXR1cCkgewogICAgICBjb25zdCB7IHgsIHkgfSA9IHNjcmVlblRvV29ybGQob2Zmc2V0WCwgb2Zmc2V0WSk7CiAgICAgIE9iamVjdC5hc3NpZ24ocG9pbnRlciwgeyB4LCB5LCB0eXBlLCBkb3duOiBmYWxzZSwgbWFyazogZmFsc2UgfSk7CiAgICAgIF9fcG9pbnRlclVwKHgsIHkpOwogICAgfQogIH0KKTsKCmNvbnN0IF9fcG9pbnRlck1vdmUgPSAoeCwgeSkgPT4gewogIGxldCBwb2ludE1vdmVkID0gZmFsc2U7CiAgaWYgKHBvaW50ZXIuZG93biAmJiBjdXJyZW50UG9pbnQpIHsKICAgIGlmIChjdXJyZW50UG9pbnRbMF0pIHsKICAgICAgY3VycmVudFBvaW50WzBdID0geCArIGN1cnJlbnRQb2ludC5fZHg7CiAgICAgIGN1cnJlbnRQb2ludFsxXSA9IHkgKyBjdXJyZW50UG9pbnQuX2R5OwogICAgfSBlbHNlIHsKICAgICAgY3VycmVudFBvaW50LnggPSB4ICsgY3VycmVudFBvaW50Ll9keDsKICAgICAgY3VycmVudFBvaW50LnkgPSB5ICsgY3VycmVudFBvaW50Ll9keTsKICAgIH0KICAgIHBvaW50TW92ZWQgPSB0cnVlOwogIH0KCiAgaWYgKHR5cGVvZiBwb2ludGVyTW92ZSAhPT0gYHVuZGVmaW5lZGApIHsKICAgIHBvaW50ZXJNb3ZlKHgsIHkpOwogICAgcG9pbnRlci5kcmFnID0gZmFsc2U7CiAgICBpZiAocG9pbnRlci5kb3duICYmIHR5cGVvZiBwb2ludGVyRHJhZyAhPT0gYHVuZGVmaW5lZGApIHsKICAgICAgcG9pbnRlci5kcmFnID0gdHJ1ZTsKICAgICAgcG9pbnRlckRyYWcoeCwgeSk7CiAgICB9CiAgfQogIGlmIChwb2ludE1vdmVkICYmICFwbGF5aW5nKSByZWRyYXcoKTsKfTsKCl9fY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoCiAgYHBvaW50ZXJtb3ZlYCwKICAoeyBvZmZzZXRYLCBvZmZzZXRZLCBwb2ludGVyVHlwZTogdHlwZSB9KSA9PiB7CiAgICBpZiAoX19maW5pc2hlZF9zZXR1cCkgewogICAgICBjb25zdCB7IHgsIHkgfSA9IHNjcmVlblRvV29ybGQob2Zmc2V0WCwgb2Zmc2V0WSk7CiAgICAgIE9iamVjdC5hc3NpZ24ocG9pbnRlciwgeyB4LCB5LCB0eXBlIH0pOwogICAgICBpZiAoIXBvaW50ZXIuZG93bikgX19jaGVja0ZvckN1cnJlbnRQb2ludCh4LCB5LCB0eXBlKTsKICAgICAgX19wb2ludGVyTW92ZSh4LCB5KTsKICAgIH0KICB9Cik7CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0ga2V5IGV2ZW50IGhhbmRsaW5nIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmNvbnN0IF9fc2FmZWx5SW50ZXJjZXB0S2V5ID0gKGV2dCkgPT4gewogIC8vIFdlIGRvbid0IHdhbnQgdG8gaW50ZXJmZXJlIHdpdGggdGhlIGJyb3dzZXIsIHNvIHdlJ3JlIG9ubHkKICAvLyBnb2luZyB0byBhbGxvdyB1bm1vZGlmaWVkIGtleXMsIG9yIHNoaWZ0LW1vZGlmaWVkIGtleXMsCiAgLy8gYW5kIHRhYiBoYXMgdG8gYWx3YXlzIHdvcmsuIEZvciBvYnZpb3VzIHJlYXNvbnMuCiAgY29uc3QgdGFiID0gZXZ0LmtleSAhPT0gIlRhYiI7CiAgY29uc3QgZnVuY3Rpb25LZXkgPSBldnQua2V5Lm1hdGNoKC9GXGQrLykgPT09IG51bGw7CiAgY29uc3Qgc3BlY2lmaWNDaGVjayA9IHRhYiAmJiBmdW5jdGlvbktleTsKICBpZiAoIWV2dC5hbHRLZXkgJiYgIWV2dC5jdHJsS2V5ICYmICFldnQubWV0YUtleSAmJiBzcGVjaWZpY0NoZWNrKSB7CiAgICBpZiAoZXZ0LnRhcmdldCA9PT0gX19jYW52YXMpIHsKICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTsKICAgIH0KICB9Cn07Cgpjb25zdCBfX2tleURvd24gPSAoa2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5KSA9PiB7CiAga2V5Ym9hcmRba2V5XSA9IERhdGUubm93KCk7CiAgaWYgKHR5cGVvZiBrZXlEb3duICE9PSBgdW5kZWZpbmVkYCkKICAgIGtleURvd24oa2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5KTsKfTsKCl9fY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoYGtleWRvd25gLCAoZXZ0KSA9PiB7CiAgX19zYWZlbHlJbnRlcmNlcHRLZXkoZXZ0KTsKICBjb25zdCB7IGtleSwgc2hpZnRLZXksIGFsdEtleSwgY3RybEtleSwgbWV0YUtleSB9ID0gZXZ0OwogIGlmIChfX2ZpbmlzaGVkX3NldHVwKSBfX2tleURvd24oa2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5KTsKfSk7Cgpjb25zdCBfX2tleVVwID0gKGtleSwgc2hpZnRLZXksIGFsdEtleSwgY3RybEtleSwgbWV0YUtleSkgPT4gewogIGRlbGV0ZSBrZXlib2FyZFtrZXldOwogIGlmICh0eXBlb2Yga2V5VXAgIT09IGB1bmRlZmluZWRgKQogICAga2V5VXAoa2V5LCBzaGlmdEtleSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5KTsKfTsKCl9fY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoYGtleXVwYCwgKGV2dCkgPT4gewogIF9fc2FmZWx5SW50ZXJjZXB0S2V5KGV2dCk7CiAgY29uc3QgeyBrZXksIHNoaWZ0S2V5LCBhbHRLZXksIGN0cmxLZXksIG1ldGFLZXkgfSA9IGV2dDsKICBpZiAoX19maW5pc2hlZF9zZXR1cCkgX19rZXlVcChrZXksIHNoaWZ0S2V5LCBhbHRLZXksIGN0cmxLZXksIG1ldGFLZXkpOwp9KTsKCi8vIC0tLS0tLS0tLS0tLS0tLS0gc2xpZGVyIGZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmNvbnN0IGFkZFNsaWRlciA9IChwcm9wTGFiZWwsIGFzc2lnbiwgb3B0aW9ucyA9IHt9KSA9PiB7CiAgbGV0IHsKICAgIG1pbiwKICAgIG1heCwKICAgIHN0ZXAsCiAgICB2YWx1ZSwKICAgIGNsYXNzZXMgPSBgc2xpZGVyYCwKICAgIHRyYW5zZm9ybSA9ICh2KSA9PiB2LAogIH0gPSBvcHRpb25zOwoKICBtaW4gPSBtaW4gPT09IHVuZGVmaW5lZCA/IDAgOiBtaW47CiAgbWF4ID0gbWF4ID09PSB1bmRlZmluZWQgPyAxIDogbWF4OwogIHN0ZXAgPSBzdGVwID09PSB1bmRlZmluZWQgPyAobWF4IC0gbWluKSAvIDEwIDogc3RlcDsKICB2YWx1ZSA9IHZhbHVlID09PSB1bmRlZmluZWQgPyAobWF4IC0gbWluKSAvIDIgOiB2YWx1ZTsKCiAgLy8gY3VzdG9tICJyb3VuZGluZyIsIHB1cmVseSBmb3Igc3RyaW5ncwogIGNvbnN0IHJvdW5kID0gKHYsIGQgPSA0KSA9PiB7CiAgICB2ID0gYCR7dn1gOwogICAgY29uc3QgZnMgPSB2LmluZGV4T2YoYC5gKTsKICAgIGlmIChmcyAhPT0gLTEpIHsKICAgICAgbGV0IHByZWMgPSBkIC0gZnMgPiAwID8gZCAtIGZzIDogMDsKICAgICAgdiA9IHYuc3Vic3RyaW5nKDAsIGZzICsgcHJlYyk7CiAgICB9CiAgICByZXR1cm4gdjsKICB9OwoKICBjb25zdCBjcmVhdGUgPSAodGFnKSA9PiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyk7CgogIGxldCBzbGlkZXIgPSBjcmVhdGUoYGlucHV0YCk7CiAgc2xpZGVyLnR5cGUgPSBgcmFuZ2VgOwogIHNsaWRlci5taW4gPSBtaW47CiAgc2xpZGVyLm1heCA9IG1heDsKICBzbGlkZXIuc3RlcCA9IHN0ZXA7CiAgc2xpZGVyLnNldEF0dHJpYnV0ZShgdmFsdWVgLCB2YWx1ZSk7CiAgc2xpZGVyLnNldEF0dHJpYnV0ZShgY2xhc3NgLCBjbGFzc2VzKTsKCiAgY29uc3QgdXBkYXRlID0gKHsgdmFsdWUgfSkgPT4gewogICAgdmFsdWVGaWVsZC50ZXh0Q29udGVudCA9IHJvdW5kKHZhbHVlKTsKICAgIGFzc2lnbih0cmFuc2Zvcm0ocGFyc2VGbG9hdCh2YWx1ZSkpKTsKICAgIGlmICghcGxheWluZykgcmVkcmF3KCk7CiAgfTsKCiAgc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoYGlucHV0YCwgKHsgdGFyZ2V0IH0pID0+IHVwZGF0ZSh0YXJnZXQpKTsKCiAgbGV0IHRhYmxlID0gX19lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYHRhYmxlLnNsaWRlci13cmFwcGVyYCk7CiAgaWYgKCF0YWJsZSkgewogICAgdGFibGUgPSBjcmVhdGUoYHRhYmxlYCk7CiAgICB0YWJsZS5jbGFzc0xpc3QuYWRkKGBzbGlkZXItd3JhcHBlcmApOwogICAgX19lbGVtZW50LnByZXBlbmQodGFibGUpOwogIH0KICBsZXQgdHIgPSBjcmVhdGUoYHRyYCk7CgogIGxldCB0ZCA9IGNyZWF0ZShgdGRgKTsKICBsZXQgbGFiZWwgPSBjcmVhdGUoYGxhYmVsYCk7CiAgbGFiZWwuY2xhc3NMaXN0LmFkZChgc2xpZGVyLWxhYmVsYCk7CiAgbGFiZWwuaW5uZXJIVE1MID0gcHJvcExhYmVsCiAgICAucmVwbGFjZSgvXyguKykkLywgYDxzdWI+JDE8L3N1Yj5gKQogICAgLnJlcGxhY2UoLyhcZCspLywgYDxzdWI+JDE8L3N1Yj5gKTsKICB0ZC5hcHBlbmQobGFiZWwpOwogIHRyLmFwcGVuZCh0ZCk7CgogIHRkID0gY3JlYXRlKGB0ZGApOwogIHRkLmNsYXNzTGlzdC5hZGQoYHNsaWRlci1taW5gKTsKICB0ZC50ZXh0Q29udGVudCA9IHJvdW5kKHNsaWRlci5taW4pOwogIHRyLmFwcGVuZCh0ZCk7CgogIHRkID0gY3JlYXRlKGB0ZGApOwogIHRkLndpZHRoID0gYCpgOwogIHRkLmFwcGVuZChzbGlkZXIpOwogIHRyLmFwcGVuZCh0ZCk7CgogIHRkID0gY3JlYXRlKGB0ZGApOwogIHRkLmNsYXNzTGlzdC5hZGQoYHNsaWRlci1tYXhgKTsKICB0ZC50ZXh0Q29udGVudCA9IHJvdW5kKHNsaWRlci5tYXgpOwogIHRyLmFwcGVuZCh0ZCk7CgogIHRkID0gY3JlYXRlKGB0ZGApOwogIHZhciB2YWx1ZUZpZWxkID0gY3JlYXRlKGBsYWJlbGApOyAvLyBmdW5jdGlvbiBzY29wZWQKICB2YWx1ZUZpZWxkLmNsYXNzTGlzdC5hZGQoYHNsaWRlci12YWx1ZWApOwogIHRkLmFwcGVuZCh2YWx1ZUZpZWxkKTsKICB0ci5hcHBlbmQodGQpOwogIHRkLmFkZEV2ZW50TGlzdGVuZXIoYHBvaW50ZXJkb3duYCwgKCkgPT4gewogICAgY29uc3QgdmFsdWUgPSBwcm9tcHQoYG5ldyB2YWx1ZT9gLCBzbGlkZXIudmFsdWUpOwogICAgaWYgKHZhbHVlICE9PSBudWxsKSB7CiAgICAgIHNsaWRlci52YWx1ZSA9IHZhbHVlOwogICAgICB1cGRhdGUoeyB2YWx1ZSB9KTsKICAgIH0KICB9KTsKCiAgdGFibGUuYXBwZW5kKHRyKTsKCiAgdXBkYXRlKHNsaWRlcik7CiAgcmV0dXJuIHNsaWRlcjsKfTsKCmNvbnN0IGNsZWFyU2xpZGVycyA9ICgpID0+IHsKICBjb25zdCB0YWJsZSA9IF9fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGB0YWJsZS5zbGlkZXItd3JhcHBlcmApOwogIGlmICh0YWJsZSkgdGFibGUuaW5uZXJIVE1MID0gYGA7Cn07Cgpjb25zdCBhZGRCdXR0b24gPSAobGFiZWwsIG9uQ2xpY2spID0+IHsKICBjb25zdCBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBidXR0b25gKTsKICBidG4uY2xhc3NMaXN0LmFkZChgZ3JhcGhpY3MtZWxlbWVudC1idXR0b25gKTsKICBidG4udGV4dENvbnRlbnQgPSBsYWJlbDsKICBidG4uYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCAoKSA9PiBvbkNsaWNrKGJ0bikpOwogIF9fZWxlbWVudC5wcmVwZW5kKGJ0bik7CiAgcmV0dXJuIGJ0bjsKfTsKCmNvbnN0IGNsZWFyQnV0dG9ucyA9ICgpID0+IHsKICBfX2VsZW1lbnQKICAgIC5xdWVyeVNlbGVjdG9yQWxsKGBidXR0b24uZ3JhcGhpY3MtZWxlbWVudC1idXR0b25gKQogICAgLmZvckVhY2goKGUpID0+IGUucmVtb3ZlKCkpOwp9OwoKLy8gLS0tLS0tLS0tLSBnZW5lcmFsIGZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tCgpjb25zdCBjbGVhck1vdmFibGUgPSAoKSA9PiB7CiAgX19tb3ZhYmxlX3BvaW50cy5zcGxpY2UoMCwgX19tb3ZhYmxlX3BvaW50cy5sZW5ndGgpOwp9OwoKY29uc3QgY29weSA9ICgpID0+IHsKICBjb25zdCBjb3B5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgY2FudmFzYCk7CiAgY29weS53aWR0aCA9IHdpZHRoOwogIGNvcHkuaGVpZ2h0ID0gaGVpZ2h0OwogIGNvbnN0IGN0eCA9IGNvcHkuZ2V0Q29udGV4dChgMmRgKTsKICBjdHguZHJhd0ltYWdlKF9fY2FudmFzLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICByZXR1cm4gY29weTsKfTsKCmNvbnN0IGNvbG9yID0gKGggPSBfX2N1cnJlbnRfaHVlLCBzID0gNTAsIGwgPSA1MCwgYSA9IDEpID0+IHsKICByZXR1cm4gYGhzbGEoJHtofSwke3N9JSwke2x9JSwke2F9KWA7Cn07Cgpjb25zdCBoaWdobGlnaHQgPSAoY29sb3IpID0+IHsKICBfX2hpZ2hsaWdodF9jb2xvciA9IGNvbG9yOwogIHJlZHJhdygpOwp9OwoKY29uc3QgbWlsbGlzID0gKCkgPT4gewogIHJldHVybiBEYXRlLm5vdygpIC0gX19zdGFydF90aW1lOwp9OwoKY29uc3QgcGF1c2UgPSAoKSA9PiB7CiAgcGxheWluZyA9IGZhbHNlOwp9OwoKY29uc3QgcGxheSA9ICgpID0+IHsKICBwbGF5aW5nID0gdHJ1ZTsKICBfX2RyYXcoKTsKfTsKCmNvbnN0IHJhbmRvbUNvbG9yID0gKGEgPSAxLjAsIGN5Y2xlID0gdHJ1ZSkgPT4gewogIGlmIChjeWNsZSkgX19jdXJyZW50X2h1ZSA9IChfX2N1cnJlbnRfaHVlICsgNzMpICUgMzYwOwogIHJldHVybiBgaHNsYSgke19fY3VycmVudF9odWV9LDUwJSw1MCUsJHthfSlgOwp9OwoKY29uc3Qgc2V0TW92YWJsZSA9IChwb2ludHMpID0+IHsKICAvLyBUT0RPOiBzaGFwZXMKICBpZiAoIXBvaW50cy5mb3JFYWNoKSB7CiAgICBwb2ludHMgPSBbcG9pbnRzXTsKICB9CiAgcG9pbnRzLmZvckVhY2goKHApID0+IHsKICAgIGlmIChfX21vdmFibGVfcG9pbnRzLmluZGV4T2YocCkgPT09IC0xKSB7CiAgICAgIF9fbW92YWJsZV9wb2ludHMucHVzaChwKTsKICAgIH0KICB9KTsKfTsKCmNvbnN0IHJlc3RvcmUgPSAoKSA9PiB7CiAgX19jdHgucmVzdG9yZSgpOwp9OwoKLyoqCiAqIFNhdmUgdGhlIGNhbnZhcyBjb250ZXh0LgogKi8KY29uc3Qgc2F2ZSA9ICgpID0+IHsKICBfX2N0eC5zYXZlKCk7Cn07Cgpjb25zdCB0b0RhdGFVUkwgPSAoKSA9PiB7CiAgcmV0dXJuIF9fY2FudmFzLnRvRGF0YVVSTCgpOwp9OwoKY29uc3QgdG9nZ2xlUGxheSA9ICgpID0+IHsKICBwbGF5aW5nID8gcGF1c2UoKSA6IHBsYXkoKTsKICByZXR1cm4gcGxheWluZzsKfTsKCi8vIC0tLS0tLS0tLS0gZHJhdyBmdW5jdGlvbnMgLS0tLS0tLS0tLS0tLQoKY29uc3QgYXJjID0gKHgsIHksIHIsIHMgPSAwLCBlID0gVEFVLCB3ZWRnZSA9IGZhbHNlKSA9PiB7CiAgc3RhcnQoKTsKICBpZiAod2VkZ2UpIF9fY3R4Lm1vdmVUbyh4LCB5KTsKICBfX2N0eC5hcmMoeCwgeSwgciwgcywgZSk7CiAgaWYgKHdlZGdlKSBfX2N0eC5saW5lVG8oeCwgeSk7CiAgZW5kKCk7Cn07Cgpjb25zdCBheGVzID0gKAogIGhMYWJlbCwKICBocywKICBoZSwKICB2TGFiZWwsCiAgdnMsCiAgdmUsCiAgaHNMYWJlbCA9IGZhbHNlLAogIGhlTGFiZWwgPSBmYWxzZSwKICB2c0xhYmVsID0gZmFsc2UsCiAgdmVMYWJlbCA9IGZhbHNlCikgPT4gewogIGxpbmUoaHMsIDAsIGhlLCAwKTsKICBsaW5lKDAsIHZzLCAwLCB2ZSk7CgogIGNvbnN0IGhwb3MgPSAwIC0gNTsKICB0ZXh0KGAke2hMYWJlbH0g4oaSYCwgd2lkdGggLyAyLCBocG9zLCBDRU5URVIpOwogIHRleHQoaHNMYWJlbCA/IGhzTGFiZWwgOiBocywgaHMsIGhwb3MsIENFTlRFUik7CiAgdGV4dChoZUxhYmVsID8gaGVMYWJlbCA6IGhlLCBoZSwgaHBvcywgQ0VOVEVSKTsKCiAgY29uc3QgdnBvcyA9IC01OwogIHRleHQoYCR7dkxhYmVsfWAsIHZwb3MsIGhlaWdodCAvIDIsIFJJR0hUKTsKICB0ZXh0KGDihpNgLCB2cG9zLCBoZWlnaHQgLyAyICsgMTYsIFJJR0hUKTsKICB0ZXh0KHZzTGFiZWwgPyB2c0xhYmVsIDogdnMsIHZwb3MsIHZzICsgNSwgUklHSFQpOwogIHRleHQodmVMYWJlbCA/IHZlTGFiZWwgOiB2ZSwgdnBvcywgdmUsIFJJR0hUKTsKfTsKCmNvbnN0IGJlemllciA9IChwb2ludHMpID0+IHsKICBjb25zdCBbZmlyc3QsIC4uLnJlc3RdID0gcG9pbnRzOwogIHN0YXJ0KCk7CiAgdmVydGV4KGZpcnN0LngsIGZpcnN0LnkpOwogIGZvciAobGV0IGkgPSAwLCBlID0gcmVzdC5sZW5ndGg7IGkgPCBlOyBpICs9IDMpIHsKICAgIGxldCBbcDEsIHAyLCBwM10gPSByZXN0LnNsaWNlKGksIGkgKyAzKTsKICAgIGlmIChwMSAmJiBwMiAmJiBwMykgX19jdHguYmV6aWVyQ3VydmVUbyhwMS54LCBwMS55LCBwMi54LCBwMi55LCBwMy54LCBwMy55KTsKICB9CiAgZW5kKCk7Cn07Cgpjb25zdCBic3BsaW5lID0gKHBvaW50cywgb3BlbiA9IHRydWUpID0+IHsKICBzdGFydCgpOwogIG5ldyBCU3BsaW5lKHBvaW50cywgb3BlbikuZ2V0TFVUKCkuZm9yRWFjaCgocCkgPT4gdmVydGV4KHAueCwgcC55KSk7CiAgZW5kKCk7Cn07Cgpjb25zdCBjaXJjbGUgPSAoeCwgeSwgcikgPT4gewogIGFyYyh4LCB5LCByKTsKfTsKCmNvbnN0IGNsZWFyID0gKGNvbG9yID0gYHdoaXRlYCkgPT4gewogIHNhdmUoKTsKICBfX2NhbnZhcy5zdHlsZS5iYWNrZ3JvdW5kID0gY29sb3I7CiAgX19jYW52YXMud2lkdGggPSB3aWR0aDsKICBfX2N0eCA9IF9fY2FudmFzLmdldENvbnRleHQoYDJkYCk7CiAgaWYgKF9fZHJhd19ncmlkKSBncmlkKCk7CiAgcmVzdG9yZSgpOwp9OwoKY29uc3QgZW5kID0gKGNsb3NlID0gZmFsc2UpID0+IHsKICBpZiAoY2xvc2UpIF9fY3R4LmNsb3NlUGF0aCgpOwogIF9fY3R4LmZpbGwoKTsKICBfX2N0eC5zdHJva2UoKTsKICBpZiAoX19jdHgubGluZVdpZHRoICUgMiA9PT0gMSkgewogICAgX19jdHgudHJhbnNsYXRlKC0wLjUsIC0wLjUpOwogIH0KfTsKCmNvbnN0IGdyaWQgPSAoKSA9PiB7CiAgc2F2ZSgpOwogIHNldExpbmVXaWR0aCgwLjUpOwogIG5vRmlsbCgpOwogIHNldFN0cm9rZShfX2dyaWRfY29sb3IpOwogIGZvciAoCiAgICBsZXQgeCA9ICgtMC41ICsgX19ncmlkX3NwYWNpbmcgLyAyKSB8IDA7CiAgICB4IDwgd2lkdGg7CiAgICB4ICs9IF9fZ3JpZF9zcGFjaW5nCiAgKSB7CiAgICBsaW5lKHgsIDAsIHgsIGhlaWdodCk7CiAgfQogIGZvciAoCiAgICBsZXQgeSA9ICgtMC41ICsgX19ncmlkX3NwYWNpbmcgLyAyKSB8IDA7CiAgICB5IDwgaGVpZ2h0OwogICAgeSArPSBfX2dyaWRfc3BhY2luZwogICkgewogICAgbGluZSgwLCB5LCB3aWR0aCwgeSk7CiAgfQogIHJlc3RvcmUoKTsKfTsKCmNvbnN0IGltYWdlID0gYXN5bmMgKGltZywgeCA9IDAsIHkgPSAwLCB3LCBoKSA9PiB7CiAgaWYgKHR5cGVvZiBpbWcgPT09IGBzdHJpbmdgKSB7CiAgICBpbWcgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGNvbnN0IHRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYGltZ2ApOwogICAgICB0YWcub25sb2FkID0gKCkgPT4gcmVzb2x2ZSh0YWcpOwogICAgICB0YWcub25lcnJvciA9ICgpID0+IHJlamVjdCgpOwogICAgICB0YWcuc3JjID0gaW1nOwogICAgfSk7CiAgfQogIF9fY3R4LmRyYXdJbWFnZShpbWcsIHgsIHksIHcgfHwgaW1nLndpZHRoLCBoIHx8IGltZy5oZWlnaHQpOwp9OwoKY29uc3QgbGluZSA9ICh4MSwgeTEsIHgyLCB5MikgPT4gewogIHN0YXJ0KCk7CiAgdmVydGV4KHgxLCB5MSk7CiAgdmVydGV4KHgyLCB5Mik7CiAgZW5kKCk7Cn07Cgpjb25zdCBwbG90ID0gKGYsIGEgPSAwLCBiID0gMSwgc3RlcHMgPSAyNCwgeHNjYWxlID0gMSwgeXNjYWxlID0gMSkgPT4gewogIGNvbnN0IGludGVydmFsID0gYiAtIGE7CiAgc3RhcnQoKTsKICBmb3IgKGxldCBpID0gMCwgZSA9IHN0ZXBzIC0gMSwgeCwgeSwgdjsgaSA8IHN0ZXBzOyBpKyspIHsKICAgIHggPSBhICsgaW50ZXJ2YWwgKiAoaSAvIGUpOwogICAgeSA9IGYoeCk7CiAgICB2ZXJ0ZXgoeCAqIHhzY2FsZSwgeSAqIHlzY2FsZSk7CiAgfQogIGVuZCgpOwp9OwoKY29uc3QgcGxvdERhdGEgPSAoZGF0YSwgeCwgeSkgPT4gewogIHN0YXJ0KCk7CiAgZGF0YS5mb3JFYWNoKChwKSA9PiB2ZXJ0ZXgocFt4XSwgcFt5XSkpOwogIGVuZCgpOwp9OwoKY29uc3QgcG9pbnQgPSAoeCwgeSkgPT4gewogIGNpcmNsZSh4LCB5LCAzKTsKfTsKCmNvbnN0IHJlY3QgPSAoeCwgeSwgdywgaCkgPT4gewogIHN0YXJ0KCk7CiAgdmVydGV4KHgsIHkpOwogIHZlcnRleCh4ICsgd2lkdGgsIHkpOwogIHZlcnRleCh4ICsgd2lkdGgsIHkgKyBoZWlnaHQpOwogIHZlcnRleCh4LCB5ICsgaGVpZ2h0KTsKICB2ZXJ0ZXgoeCwgeSk7CiAgZW5kKCk7Cn07CgovLyBkcmF3IGEgY2FyZGluYWwgc3BsaW5lIHdpdGggdmlydHVhbCBzdGFydCBhbmQgZW5kIHBvaW50CmNvbnN0IHNwbGluZSA9IChwb2ludHMsIHZpcnR1YWwgPSB0cnVlLCB0aWdodG5lc3MgPSAxLCBUID0gdGlnaHRuZXNzKSA9PiB7CiAgbGV0IGNwb2ludHMgPSBwb2ludHM7CiAgaWYgKHZpcnR1YWwpIHsKICAgIGNvbnN0IGYwID0gcG9pbnRzWzBdLAogICAgICBmMSA9IHBvaW50c1sxXSwKICAgICAgZjIgPSBwb2ludHNbMl0sCiAgICAgIGZzbSA9IG5ldyBWZWN0b3IoZjAueCAvIDIgKyBmMi54IC8gMiwgZjAueSAvIDIgKyBmMi55IC8gMiksCiAgICAgIGYwciA9IG5ldyBWZWN0b3IoZjApLnJlZmxlY3QoZjEpLAogICAgICBmc3IgPSBmc20ucmVmbGVjdChmMSksCiAgICAgIGZuID0gbmV3IFZlY3RvcihmMHIueCAvIDIgKyBmc3IueCAvIDIsIGYwci55IC8gMiArIGZzci55IC8gMiksCiAgICAgIGwyID0gcG9pbnRzLmF0KC0zKSwKICAgICAgbDEgPSBwb2ludHMuYXQoLTIpLAogICAgICBsMCA9IHBvaW50cy5hdCgtMSksCiAgICAgIGxzbSA9IG5ldyBWZWN0b3IobDAueCAvIDIgKyBsMi54IC8gMiwgbDAueSAvIDIgKyBsMi55IC8gMiksCiAgICAgIGwwciA9IG5ldyBWZWN0b3IobDApLnJlZmxlY3QobDEpLAogICAgICBsbiA9IG5ldyBWZWN0b3IobDByLnggLyAyICsgbHNtLnggLyAyLCBsMHIueSAvIDIgKyBsc20ueSAvIDIpOwogICAgY3BvaW50cyA9IFtmbiwgLi4ucG9pbnRzLCBsbl07CiAgfQoKICAvLyBmb3VyIHBvaW50IHNsaWRpbmcgd2luZG93IG92ZXIgdGhlIHNlZ21lbnQKICBzdGFydCgpOwogIF9fY3R4Lm1vdmVUbyhjcG9pbnRzWzFdLngsIGNwb2ludHNbMV0ueSk7CiAgZm9yIChsZXQgaSA9IDAsIGUgPSBjcG9pbnRzLmxlbmd0aCAtIDM7IGkgPCBlOyBpKyspIHsKICAgIGxldCBbYzEsIGMyLCBjMywgYzRdID0gY3BvaW50cy5zbGljZShpLCBpICsgNCk7CiAgICBsZXQgcDIgPSB7CiAgICAgIHg6IGMyLnggKyAoYzMueCAtIGMxLngpIC8gKDYgKiBUKSwKICAgICAgeTogYzIueSArIChjMy55IC0gYzEueSkgLyAoNiAqIFQpLAogICAgfTsKICAgIGxldCBwMyA9IHsKICAgICAgeDogYzMueCAtIChjNC54IC0gYzIueCkgLyAoNiAqIFQpLAogICAgICB5OiBjMy55IC0gKGM0LnkgLSBjMi55KSAvICg2ICogVCksCiAgICB9OwogICAgX19jdHguYmV6aWVyQ3VydmVUbyhwMi54LCBwMi55LCBwMy54LCBwMy55LCBjMy54LCBjMy55KTsKICB9CiAgZW5kKCk7Cn07Cgpjb25zdCBzdGFydCA9ICgpID0+IHsKICBpZiAoX19jdHgubGluZVdpZHRoICUgMiA9PT0gMSkgewogICAgX19jdHgudHJhbnNsYXRlKDAuNSwgMC41KTsKICB9CiAgX19jdHguYmVnaW5QYXRoKCk7CiAgX19maXJzdCA9IGZhbHNlOwp9OwoKY29uc3QgdGV4dCA9IChzdHIsIHgsIHksIHhhbGlnbiwgeWFsaWduID0gYGluaGVyaXRgKSA9PiB7CiAgc2F2ZSgpOwogIGlmICh4YWxpZ24pIHsKICAgIHNldFRleHRBbGlnbih4YWxpZ24sIHlhbGlnbik7CiAgfQogIF9fY3R4LmZpbGxUZXh0KHN0ciwgeCwgeSk7CiAgaWYgKF9fdGV4dFN0cm9rZSkgewogICAgc2V0U3Ryb2tlKF9fdGV4dFN0cm9rZSk7CiAgICBfX2N0eC5zdHJva2VUZXh0KHN0ciwgeCwgeSk7CiAgfQogIHJlc3RvcmUoKTsKfTsKCmNvbnN0IHRyaWFuZ2xlID0gKHgxLCB5MSwgeDIsIHkyLCB4MywgeTMpID0+IHsKICBzdGFydCgpOwogIHZlcnRleCh4MSwgeTEpOwogIHZlcnRleCh4MiwgeTIpOwogIHZlcnRleCh4MywgeTMpOwogIHZlcnRleCh4MSwgeTEpOwogIGVuZCgpOwp9OwoKY29uc3QgdmVydGV4ID0gKHgsIHkpID0+IHsKICBpZiAoX19maXJzdCkgewogICAgX19jdHgubGluZVRvKHgsIHkpOwogIH0gZWxzZSB7CiAgICBfX2ZpcnN0ID0geyB4LCB5IH07CiAgICBfX2N0eC5tb3ZlVG8oeCwgeSk7CiAgfQp9OwoKLy8gLS0tLS0tLS0tLSB0cmFuc2Zvcm0gZnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0KCmNvbnN0IHJlc2V0VHJhbnNmb3JtID0gKCkgPT4gewogIF9fY3R4LnJlc2V0VHJhbnNmb3JtKCk7Cn07Cgpjb25zdCByb3RhdGUgPSAoYW5nbGUgPSAwKSA9PiB7CiAgX19jdHgucm90YXRlKGFuZ2xlKTsKfTsKCmNvbnN0IHNjYWxlID0gKHggPSAxLCB5ID0geCkgPT4gewogIF9fY3R4LnNjYWxlKHgsIHkpOwp9OwoKY29uc3Qgc2NyZWVuVG9Xb3JsZCA9ICh4LCB5KSA9PiB7CiAgaWYgKHkgPT09IHVuZGVmaW5lZCkgewogICAgeSA9IHgueTsKICAgIHggPSB4Lng7CiAgfQoKICBsZXQgTSA9IF9fY3R4LmdldFRyYW5zZm9ybSgpLmludmVydFNlbGYoKTsKCiAgbGV0IHJldCA9IHsKICAgIHg6IHggKiBNLmEgKyB5ICogTS5jICsgTS5lLAogICAgeTogeCAqIE0uYiArIHkgKiBNLmQgKyBNLmYsCiAgfTsKCiAgcmV0dXJuIHJldDsKfTsKCi8qKgogKiB0cmFuc2Zvcm1zOiB1bml2ZXJzYWwgZnJlZSB0cmFuc2Zvcm0gYmFzZWQgb24gYXBwbHlpbmcKICoKICogICAgICAgfCBhIGIgYyB8CiAqICAgbSA9IHwgZCBlIGYgfAogKiAgICAgICB8IDAgMCAxIHwKICovCmNvbnN0IHRyYW5zZm9ybSA9IChhID0gMSwgYiA9IDAsIGMgPSAwLCBkID0gMCwgZSA9IDEsIGYgPSAwKSA9PiB7CiAgX19jdHgudHJhbnNmb3JtKGEsIGIsIGMsIGQsIGUsIGYpOwp9OwoKY29uc3QgdHJhbnNsYXRlID0gKHggPSAwLCB5ID0gMCkgPT4gewogIF9fY3R4LnRyYW5zbGF0ZSh4LCB5KTsKfTsKCmNvbnN0IHdvcmxkVG9TY3JlZW4gPSAoeCwgeSkgPT4gewogIGlmICh5ID09PSB1bmRlZmluZWQpIHsKICAgIHkgPSB4Lnk7CiAgICB4ID0geC54OwogIH0KCiAgbGV0IE0gPSBfX2N0eC5nZXRUcmFuc2Zvcm0oKTsKCiAgbGV0IHJldCA9IHsKICAgIHg6IHggKiBNLmEgKyB5ICogTS5jICsgTS5lLAogICAgeTogeCAqIE0uYiArIHkgKiBNLmQgKyBNLmYsCiAgfTsKCiAgcmV0dXJuIHJldDsKfTsKCi8vIC0tLS0tLS0tLS0tLS0tLS0gc2V0dGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tCgpjb25zdCBzZXRCb3JkZXIgPSAod2lkdGggPSAxLCBjb2xvciA9IGBibGFja2ApID0+IHsKICBpZiAoIXdpZHRoKSB7CiAgICBfX2NhbnZhcy5zdHlsZS5ib3JkZXIgPSBgbm9uZWA7CiAgfSBlbHNlIHsKICAgIF9fY2FudmFzLnN0eWxlLmJvcmRlciA9IGAke3dpZHRofXB4IHNvbGlkICR7Y29sb3J9YDsKICB9Cn07Cgpjb25zdCBzZXRDb2xvciA9IChjb2xvcikgPT4gewogIHNldEZpbGwoY29sb3IpOwogIHNldFN0cm9rZShjb2xvcik7Cn07Cgpjb25zdCBzZXRDcmlzcCA9IChlbmFibGVkID0gdHJ1ZSkgPT4gewogIF9fY2FudmFzLmNsYXNzTGlzdC50b2dnbGUoYGNyaXNwYCwgZW5hYmxlZCk7Cn07Cgpjb25zdCBzZXRDdXJzb3IgPSAodHlwZSkgPT4gewogIF9fY3VycmVudF9jdXJzb3IgPSB0eXBlOwogIF9fY2FudmFzLnN0eWxlLmN1cnNvciA9IF9fY3VycmVudF9jdXJzb3I7Cn07Cgpjb25zdCBzZXRGaWxsID0gKGNvbG9yID0gYGJsYWNrYCkgPT4gewogIGlmIChDU1NfQ09MT1JfTUFQW2NvbG9yXSA9PT0gX19oaWdobGlnaHRfY29sb3IpIHsKICAgIGNvbG9yID0gX19jdXJyZW50X2hpZ2hsaWdodF9jb2xvcjsKICB9CiAgX19jdHguZmlsbFN0eWxlID0gY29sb3I7Cn07Cgpjb25zdCBzZXRGb250ID0gKGZvbnQpID0+IHsKICBfX2N0eC5mb250ID0gZm9udCB8fCBgJHtfX2ZvbnQud2VpZ2h0fSAke19fZm9udC5zaXplfXB4ICR7X19mb250LmZhbWlseX1gOwp9OwoKY29uc3Qgc2V0Rm9udEZhbWlseSA9IChuYW1lKSA9PiB7CiAgX19mb250LmZhbWlseSA9IG5hbWU7CiAgc2V0Rm9udCgpOwp9Owpjb25zdCBzZXRGb250U2l6ZSA9IChweCkgPT4gewogIF9fZm9udC5zaXplID0gcHg7CiAgc2V0Rm9udCgpOwp9OwoKY29uc3Qgc2V0Rm9udFdlaWdodCA9ICh2YWwpID0+IHsKICBfX2ZvbnQud2VpZ2h0ID0gdmFsOwogIHNldEZvbnQoKTsKfTsKCmNvbnN0IHNldEdyaWQgPSAoc3BhY2luZyA9IDIwLCBjb2xvciA9IGBsaWdodGdyZXlgKSA9PiB7CiAgX19kcmF3X2dyaWQgPSB0cnVlOwogIF9fZ3JpZF9zcGFjaW5nID0gc3BhY2luZzsKICBfX2dyaWRfY29sb3IgPSBjb2xvcjsKfTsKCmNvbnN0IHNldEhpZ2hsaWdodENvbG9yID0gKGNvbG9yKSA9PiB7CiAgX19jdXJyZW50X2hpZ2hsaWdodF9jb2xvciA9IGNvbG9yOwp9OwoKY29uc3Qgc2V0TGluZURhc2ggPSAoLi4udmFsdWVzKSA9PiB7CiAgX19jdHguc2V0TGluZURhc2godmFsdWVzKTsKfTsKCmNvbnN0IHNldExpbmVXaWR0aCA9ICh3aWR0aCA9IDEpID0+IHsKICBfX2N0eC5saW5lV2lkdGggPSB3aWR0aDsKfTsKCmNvbnN0IHNldFN0cm9rZSA9IChjb2xvciA9IGBibGFja2ApID0+IHsKICBpZiAoQ1NTX0NPTE9SX01BUFtjb2xvcl0gPT09IF9faGlnaGxpZ2h0X2NvbG9yKSB7CiAgICBjb2xvciA9IF9fY3VycmVudF9oaWdobGlnaHRfY29sb3I7CiAgfQogIF9fY3R4LnN0cm9rZVN0eWxlID0gY29sb3I7Cn07Cgpjb25zdCBzZXRUZXh0QWxpZ24gPSAoeGFsaWduLCB5YWxpZ24gPSBBTFBIQUJFVElDKSA9PiB7CiAgX19jdHgudGV4dEFsaWduID0geGFsaWduOwogIF9fY3R4LnRleHRCYXNlTGluZSA9IHlhbGlnbjsKfTsKCmNvbnN0IHNldFRleHREaXJlY3Rpb24gPSAoZGlyID0gYGluaGVyaXRgKSA9PiB7CiAgX19jdHguZGlyZWN0aW9uID0gZGlyOwp9OwoKY29uc3Qgc2V0VGV4dFN0cm9rZSA9IChjb2xvciwgd2lkdGgpID0+IHsKICBfX3RleHRTdHJva2UgPSBjb2xvcjsKICBzZXRMaW5lV2lkdGgod2lkdGgpOwp9OwoKLy8gLS0tLS0tLS0tLS0tLS0tLSAibm8gLi4uIiAtLS0tLS0tLS0tLS0tLS0tLS0tCgpjb25zdCBub0JvcmRlciA9ICgpID0+IHsKICBzZXRCb3JkZXIoZmFsc2UpOwp9OwoKY29uc3Qgbm9Db2xvciA9ICgpID0+IHsKICBub0ZpbGwoKTsKICBub1N0cm9rZSgpOwp9OwoKY29uc3Qgbm9DdXJzb3IgPSAoKSA9PiB7CiAgX19jYW52YXMuc3R5bGUuY3Vyc29yID0gYG5vbmVgOwp9OwoKY29uc3Qgbm9GaWxsID0gKCkgPT4gewogIHNldEZpbGwoYHRyYW5zcGFyZW50YCk7Cn07Cgpjb25zdCBub0dyaWQgPSAoKSA9PiB7CiAgX19kcmF3X2dyaWQgPSBmYWxzZTsKfTsKCmNvbnN0IG5vTGluZURhc2ggPSAoKSA9PiB7CiAgX19jdHguc2V0TGluZURhc2goW10pOwp9OwoKY29uc3Qgbm9NYXJnaW5nID0gKCkgPT4gewogIHNldE1hcmdpbigwKTsKfTsKCmNvbnN0IG5vU2hhZG93ID0gKCkgPT4gewogIHNldFNoYWRvdyhgdHJhbnNwYXJlbnRgLCAwKTsKfTsKCmNvbnN0IG5vU3Ryb2tlID0gKCkgPT4gewogIHNldFN0cm9rZShgdHJhbnNwYXJlbnRgKTsKfTsKCmNvbnN0IG5vVGV4dFN0cm9rZSA9ICgpID0+IHsKICBzZXRUZXh0U3Ryb2tlKGZhbHNlLCB1bmRlZmluZWQpOwp9Owo="),y=class extends u{static{s(this,"GraphicsElement")}constructor(){super(),this.label=document.createElement("label"),this.title||(this.title=""),this.label.textContent=this.title}handleAttributeChange(...e){}handleChildChanges(...e){}connectedCallback(){super.connectedCallback(),k(this)?this.loadSource():new IntersectionObserver((e,r)=>e.forEach(t=>{t.isIntersecting&&(this.loadSource(),r.disconnect())}),{threshold:.1,rootMargin:`${window.innerHeight}px`}).observe(this)}getStyle(){return`
:host([hidden]) { display: none; }
style { display: none; }
.top-title { display: flex; flex-direction: row; justify-content: space-between; }
canvas { touch-action: none; user-select: none; position: relative; z-index: 1; display: block; margin: auto; border-radius: 0; box-sizing: content-box !important; border: 1px solid lightgrey;
&.crisp { image-rendering: -moz-crisp-edges; image-rendering: -webkit-crisp-edges; image-rendering: pixelated; image-rendering: crisp-edges; }
&:focus { border: 1px solid red; }}
a { &.view-source { font-size: 60%; text-decoration: none;
&.plus { padding-left: 0.5em; }}}
button.reset { font-size: 0.5em; top: -0.35em; position: relative; }
label:not(:empty) { display: block; font-style: italic; font-size: 0.9em; text-align: right; padding-right: 1em; margin-top: 0.35em; }
`}async loadSource(e,r=this.width,t=this.height){!r&&!t&&(r=parseFloat(this.getAttribute("width")),t=parseFloat(this.getAttribute("height")),isNaN(r)&&(r=void 0),isNaN(t)&&(t=void 0));let x=0;if(!e){if(this.userCode)e=this.userCode;else{let o=this.getAttribute("src");o?e=await(await fetch(o)).text():e=`function setup() {
}
function draw() {
}
`}let n=this.querySelectorAll("source");x=n.length,x>0&&(n=await Promise.all(Array.from(n).map(o=>fetch(o.src).then(f=>f.text()))),e+=`
`+n.map((o,f)=>o.replace("function setup()",`function setup${f+1}()`).replace("function draw()",`function draw${f+1}()`))+`
function __more_setup() { ${[...new Array(x)].map((o,f)=>`setup${f+1}();`).join(`
`)} }
function __more_draw() { ${[...new Array(x)].map((o,f)=>`draw${f+1}();`).join(`
`)} }
`)}this.userCode=e;let a=e.matchAll(/addSlider\(['"`](.*)['"`]/g),g=[];for(let n of a)g.push(n[1]),e=e.replace(n[0],n[0]+`, (v) => (${n[1]} = v)`);if(g.length&&(e="let "+g.join(", ")+`;
`+e),e=e.replaceAll(/ from ['"].([^'"]+)['"]/g,` from "${C(location.href)}/$1"`),e.includes("function setup()")||(e=`function setup() {
}
`+e),!e.includes("setSize(")){let n="setSize();";r&&t&&(n=`setSize(${r}, ${t});`),e=e.replace("function setup() {",`function setup() {
  ${n}`)}import(`data:text/javascript;base64,${M(['"use strict";',`import { BSpline, Point, Circle, Vector, Matrix, CSS_COLOR_MAP } from "${P}";`,`const __randomId = "${Date.now()}";`,_,e,"export { reset as start, __canvas as canvas, halt, highlight }"].join(`
`))}`).then(async n=>{let{start:o,canvas:f,halt:c,highlight:E}=n;this.canvas=f,this.halt=()=>c(),this.highlight=p=>E(p),this.render();let{width:l,height:h}=await o(this);l&&h&&(this.style.width="",this.style.height="",this.width=l,this.height=h,this.setAttribute("width",l),this.setAttribute("height",h)),this.dispatchEvent(new CustomEvent("load")),this.onload&&this.onload()})}reset(e){this.halt(),this.crosslinked=!1,this.querySelector("button.remove-color")?.remove(),this.loadSource(e||this.userCode,this.width,this.height)}render(){super.render();let e=this._slot.parentNode;this.canvas&&e.insertBefore(this.canvas,this._slot),this.label&&e.insertBefore(this.label,this._slot);let r=document.createElement("div");r.classList.add("top-title");let t=document.createElement("span");t.classList.add("sources"),r.append(t);let x=document.createElement("button");x.classList.add("reset"),x.textContent=this.getAttribute("reset")||"reset",x.addEventListener("click",()=>this.reset()),r.append(x);let a=this.getAttribute("src");if(a){let $=document.createElement("a");$.classList.add("view-source"),$.textContent=this.getAttribute("viewSource")||"view source",$.href=a,$.target="_blank",t.append($)}let g=this.querySelectorAll("source");g.length&&g.forEach(($,n)=>{let{src:o}=$,f=document.createElement("a");f.classList.add("view-source","plus"),f.textContent=`[+${n+1}]`,f.href=o,f.target="_blank",t.append(f)}),this.label&&e.insertBefore(r,this.canvas),this.crosslink()}crosslink(){if(this.crosslinked)return;this.crosslinked=!0;let e=!1;if(this.querySelectorAll("p").forEach(r=>{r.querySelectorAll("*").forEach(t=>{if(!S.includes(t.tagName))return;e=!0;let x;t.classList.remove("calm"),t.addEventListener("pointerenter",()=>{x??=getComputedStyle(t)["-webkit-text-stroke-color"],this.highlight(x)}),t.addEventListener("pointerleave",()=>this.highlight(!1))})}),e){let r=document.createElement("button");r.textContent="remove colors",r.classList.add("remove-color"),r.addEventListener("click",()=>{this.querySelectorAll("p").forEach(t=>{t.querySelectorAll("*").forEach(x=>{S.includes(x.tagName)&&x.classList.add("calm")})}),r.remove()}),this.append(r)}}};await u.register(y);export{A as BSpline,U as CSS_COLOR_MAP,N as Circle,R as Matrix,L as Point,m as Vector};
