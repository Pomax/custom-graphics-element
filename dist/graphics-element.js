var P=Object.defineProperty;var o=(n,e)=>P(n,"name",{value:e,configurable:!0});var v="registered as custom element";function M(n,e){console.warn(`missing implementation for ${e}(...data) in ${n.__proto__.constructor.name}`)}o(M,"NotImplemented");function H(n){return n.prototype.constructor.name.replace(/([A-Z])([a-z])/g,(e,r,t,x)=>{let $=`${r.toLowerCase()}${t}`;return x>0?`-${$}`:$})}o(H,"getElementTagName");var m=class extends HTMLElement{static{o(this,"CustomElement")}static register(e){if(!e[v]){let r=e.tagName||H(e);return customElements.define(r,e),e[v]=!0,customElements.whenDefined(r)}return Promise.resolve()}static get tagName(){return H(this)}constructor(e={}){super(),customElements.resolveScope||(customElements.resolveScope=function(x){try{return x.getRootNode().host}catch($){console.warn($)}return window}),this._options=e;let r={childList:x=>{this.handleChildChanges(Array.from(x.addedNodes),Array.from(x.removedNodes)),this.render()},attributes:x=>{this.handleAttributeChange(x.attributeName,x.oldValue,this.getAttribute(x.attributeName)),this.render()}};this._observer=new MutationObserver(x=>{this.isConnected&&x.forEach($=>{r[$.type]($)})}),this._observer.observe(this,{childList:!0,attributes:!0});let t={mode:"open"};this._shadow=this.attachShadow(t),this._style=document.createElement("style"),this._style.textContent=this.getStyle(),this._options.header!==!1&&(this._header=document.createElement("header")),this._options.slot!==!1&&this._options.void!==!0&&(this._slot=document.createElement("slot")),this._options.footer!==!1&&(this._footer=document.createElement("footer"))}connectedCallback(){this.render()}handleChildChanges(e,r){this._options.void||M(this,"handleChildChanges")}handleAttributeChange(e,r,t){M(this,"handleAttributeChange")}getStyle(){return""}render(){this._shadow.innerHTML="",this._shadow.append(this._style),this._options.header!==!1&&this._shadow.append(this._header),this._options.slot!==!1&&this._shadow.append(this._slot),this._options.footer!==!1&&this._shadow.append(this._footer)}};var D=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","transparent","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","ALICEBLUE","ANTIQUEWHITE","AQUA","AQUAMARINE","AZURE","BEIGE","BISQUE","BLACK","BLANCHEDALMOND","BLUE","BLUEVIOLET","BROWN","BURLYWOOD","CADETBLUE","CHARTREUSE","CHOCOLATE","CORAL","CORNFLOWERBLUE","CORNSILK","CRIMSON","CYAN","DARKBLUE","DARKCYAN","DARKGOLDENROD","DARKGRAY","DARKGREEN","DARKGREY","DARKKHAKI","DARKMAGENTA","DARKOLIVEGREEN","DARKORANGE","DARKORCHID","DARKRED","DARKSALMON","DARKSEAGREEN","DARKSLATEBLUE","DARKSLATEGRAY","DARKSLATEGREY","DARKTURQUOISE","DARKVIOLET","DEEPPINK","DEEPSKYBLUE","DIMGRAY","DIMGREY","DODGERBLUE","FIREBRICK","FLORALWHITE","FORESTGREEN","FUCHSIA","GAINSBORO","GHOSTWHITE","GOLD","GOLDENROD","GRAY","GREEN","GREENYELLOW","GREY","HONEYDEW","HOTPINK","INDIANRED","INDIGO","IVORY","KHAKI","LAVENDER","LAVENDERBLUSH","LAWNGREEN","LEMONCHIFFON","LIGHTBLUE","LIGHTCORAL","LIGHTCYAN","LIGHTGOLDENRODYELLOW","LIGHTGRAY","LIGHTGREEN","LIGHTGREY","LIGHTPINK","LIGHTSALMON","LIGHTSEAGREEN","LIGHTSKYBLUE","LIGHTSLATEGRAY","LIGHTSLATEGREY","LIGHTSTEELBLUE","LIGHTYELLOW","LIME","LIMEGREEN","LINEN","MAGENTA","MAROON","MEDIUMAQUAMARINE","MEDIUMBLUE","MEDIUMORCHID","MEDIUMPURPLE","MEDIUMSEAGREEN","MEDIUMSLATEBLUE","MEDIUMSPRINGGREEN","MEDIUMTURQUOISE","MEDIUMVIOLETRED","MIDNIGHTBLUE","MINTCREAM","MISTYROSE","MOCCASIN","NAVAJOWHITE","NAVY","OLDLACE","OLIVE","OLIVEDRAB","ORANGE","ORANGERED","ORCHID","PALEGOLDENROD","PALEGREEN","PALETURQUOISE","PALEVIOLETRED","PAPAYAWHIP","PEACHPUFF","PERU","PINK","PLUM","POWDERBLUE","PURPLE","REBECCAPURPLE","RED","ROSYBROWN","ROYALBLUE","SADDLEBROWN","SALMON","SANDYBROWN","SEAGREEN","SEASHELL","SIENNA","SILVER","SKYBLUE","SLATEBLUE","SLATEGRAY","SLATEGREY","SNOW","SPRINGGREEN","STEELBLUE","TAN","TEAL","THISTLE","TOMATO","TRANSPARENT","TURQUOISE","VIOLET","WHEAT","WHITE","WHITESMOKE","YELLOW","YELLOWGREEN"],K={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",aqua:"rgb(0, 255, 255)",aquamarine:"rgb(127, 255, 212)",azure:"rgb(240, 255, 255)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",black:"rgb(0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb(0, 0, 255)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",burlywood:"rgb(222, 184, 135)",cadetblue:"rgb(95, 158, 160)",chartreuse:"rgb(127, 255, 0)",chocolate:"rgb(210, 105, 30)",coral:"rgb(255, 127, 80)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",crimson:"rgb(220, 20, 60)",cyan:"rgb(0, 255, 255)",darkblue:"rgb(0, 0, 139)",darkcyan:"rgb(0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb(0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb(85, 107, 47)",darkorange:"rgb(255, 140, 0)",darkorchid:"rgb(153, 50, 204)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkslateblue:"rgb(72, 61, 139)",darkslategray:"rgb(47, 79, 79)",darkslategrey:"rgb(47, 79, 79)",darkturquoise:"rgb(0, 206, 209)",darkviolet:"rgb(148, 0, 211)",deeppink:"rgb(255, 20, 147)",deepskyblue:"rgb(0, 191, 255)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb(30, 144, 255)",firebrick:"rgb(178, 34, 34)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb(34, 139, 34)",fuchsia:"rgb(255, 0, 255)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",goldenrod:"rgb(218, 165, 32)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",greenyellow:"rgb(173, 255, 47)",grey:"rgb(128, 128, 128)",honeydew:"rgb(240, 255, 240)",hotpink:"rgb(255, 105, 180)",indianred:"rgb(205, 92, 92)",indigo:"rgb(75, 0, 130)",ivory:"rgb(255, 255, 240)",khaki:"rgb(240, 230, 140)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lightblue:"rgb(173, 216, 230)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightsalmon:"rgb(255, 160, 122)",lightseagreen:"rgb(32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightyellow:"rgb(255, 255, 224)",lime:"rgb(0, 255, 0)",limegreen:"rgb(50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",maroon:"rgb(128, 0, 0)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb(0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumpurple:"rgb(147, 112, 219)",mediumseagreen:"rgb(60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb(0, 250, 154)",mediumturquoise:"rgb(72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb(25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navy:"rgb(0, 0, 128)",oldlace:"rgb(253, 245, 230)",olive:"rgb(128, 128, 0)",olivedrab:"rgb(107, 142, 35)",orange:"rgb(255, 165, 0)",orangered:"rgb(255, 69, 0)",orchid:"rgb(218, 112, 214)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",paleturquoise:"rgb(175, 238, 238)",palevioletred:"rgb(219, 112, 147)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",plum:"rgb(221, 160, 221)",powderblue:"rgb(176, 224, 230)",purple:"rgb(128, 0, 128)",rebeccapurple:"rgb(102, 51, 153)",red:"rgb(255, 0, 0)",rosybrown:"rgb(188, 143, 143)",royalblue:"rgb(65, 105, 225)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb(46, 139, 87)",seashell:"rgb(255, 245, 238)",sienna:"rgb(160, 82, 45)",silver:"rgb(192, 192, 192)",skyblue:"rgb(135, 206, 235)",slateblue:"rgb(106, 90, 205)",slategray:"rgb(112, 128, 144)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",springgreen:"rgb(0, 255, 127)",steelblue:"rgb(70, 130, 180)",tan:"rgb(210, 180, 140)",teal:"rgb(0, 128, 128)",thistle:"rgb(216, 191, 216)",tomato:"rgb(255, 99, 71)",transparent:"rgba(0,0,0,0)",turquoise:"rgb(64, 224, 208)",violet:"rgb(238, 130, 238)",wheat:"rgb(245, 222, 179)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellowgreen:"rgb(154, 205, 50)",ALICEBLUE:"rgb(240, 248, 255)",ANTIQUEWHITE:"rgb(250, 235, 215)",AQUA:"rgb(0, 255, 255)",AQUAMARINE:"rgb(127, 255, 212)",AZURE:"rgb(240, 255, 255)",BEIGE:"rgb(245, 245, 220)",BISQUE:"rgb(255, 228, 196)",BLACK:"rgb(0, 0, 0)",BLANCHEDALMOND:"rgb(255, 235, 205)",BLUE:"rgb(0, 0, 255)",BLUEVIOLET:"rgb(138, 43, 226)",BROWN:"rgb(165, 42, 42)",BURLYWOOD:"rgb(222, 184, 135)",CADETBLUE:"rgb(95, 158, 160)",CHARTREUSE:"rgb(127, 255, 0)",CHOCOLATE:"rgb(210, 105, 30)",CORAL:"rgb(255, 127, 80)",CORNFLOWERBLUE:"rgb(100, 149, 237)",CORNSILK:"rgb(255, 248, 220)",CRIMSON:"rgb(220, 20, 60)",CYAN:"rgb(0, 255, 255)",DARKBLUE:"rgb(0, 0, 139)",DARKCYAN:"rgb(0, 139, 139)",DARKGOLDENROD:"rgb(184, 134, 11)",DARKGRAY:"rgb(169, 169, 169)",DARKGREEN:"rgb(0, 100, 0)",DARKGREY:"rgb(169, 169, 169)",DARKKHAKI:"rgb(189, 183, 107)",DARKMAGENTA:"rgb(139, 0, 139)",DARKOLIVEGREEN:"rgb(85, 107, 47)",DARKORANGE:"rgb(255, 140, 0)",DARKORCHID:"rgb(153, 50, 204)",DARKRED:"rgb(139, 0, 0)",DARKSALMON:"rgb(233, 150, 122)",DARKSEAGREEN:"rgb(143, 188, 143)",DARKSLATEBLUE:"rgb(72, 61, 139)",DARKSLATEGRAY:"rgb(47, 79, 79)",DARKSLATEGREY:"rgb(47, 79, 79)",DARKTURQUOISE:"rgb(0, 206, 209)",DARKVIOLET:"rgb(148, 0, 211)",DEEPPINK:"rgb(255, 20, 147)",DEEPSKYBLUE:"rgb(0, 191, 255)",DIMGRAY:"rgb(105, 105, 105)",DIMGREY:"rgb(105, 105, 105)",DODGERBLUE:"rgb(30, 144, 255)",FIREBRICK:"rgb(178, 34, 34)",FLORALWHITE:"rgb(255, 250, 240)",FORESTGREEN:"rgb(34, 139, 34)",FUCHSIA:"rgb(255, 0, 255)",GAINSBORO:"rgb(220, 220, 220)",GHOSTWHITE:"rgb(248, 248, 255)",GOLD:"rgb(255, 215, 0)",GOLDENROD:"rgb(218, 165, 32)",GRAY:"rgb(128, 128, 128)",GREEN:"rgb(0, 128, 0)",GREENYELLOW:"rgb(173, 255, 47)",GREY:"rgb(128, 128, 128)",HONEYDEW:"rgb(240, 255, 240)",HOTPINK:"rgb(255, 105, 180)",INDIANRED:"rgb(205, 92, 92)",INDIGO:"rgb(75, 0, 130)",IVORY:"rgb(255, 255, 240)",KHAKI:"rgb(240, 230, 140)",LAVENDER:"rgb(230, 230, 250)",LAVENDERBLUSH:"rgb(255, 240, 245)",LAWNGREEN:"rgb(124, 252, 0)",LEMONCHIFFON:"rgb(255, 250, 205)",LIGHTBLUE:"rgb(173, 216, 230)",LIGHTCORAL:"rgb(240, 128, 128)",LIGHTCYAN:"rgb(224, 255, 255)",LIGHTGOLDENRODYELLOW:"rgb(250, 250, 210)",LIGHTGRAY:"rgb(211, 211, 211)",LIGHTGREEN:"rgb(144, 238, 144)",LIGHTGREY:"rgb(211, 211, 211)",LIGHTPINK:"rgb(255, 182, 193)",LIGHTSALMON:"rgb(255, 160, 122)",LIGHTSEAGREEN:"rgb(32, 178, 170)",LIGHTSKYBLUE:"rgb(135, 206, 250)",LIGHTSLATEGRAY:"rgb(119, 136, 153)",LIGHTSLATEGREY:"rgb(119, 136, 153)",LIGHTSTEELBLUE:"rgb(176, 196, 222)",LIGHTYELLOW:"rgb(255, 255, 224)",LIME:"rgb(0, 255, 0)",LIMEGREEN:"rgb(50, 205, 50)",LINEN:"rgb(250, 240, 230)",MAGENTA:"rgb(255, 0, 255)",MAROON:"rgb(128, 0, 0)",MEDIUMAQUAMARINE:"rgb(102, 205, 170)",MEDIUMBLUE:"rgb(0, 0, 205)",MEDIUMORCHID:"rgb(186, 85, 211)",MEDIUMPURPLE:"rgb(147, 112, 219)",MEDIUMSEAGREEN:"rgb(60, 179, 113)",MEDIUMSLATEBLUE:"rgb(123, 104, 238)",MEDIUMSPRINGGREEN:"rgb(0, 250, 154)",MEDIUMTURQUOISE:"rgb(72, 209, 204)",MEDIUMVIOLETRED:"rgb(199, 21, 133)",MIDNIGHTBLUE:"rgb(25, 25, 112)",MINTCREAM:"rgb(245, 255, 250)",MISTYROSE:"rgb(255, 228, 225)",MOCCASIN:"rgb(255, 228, 181)",NAVAJOWHITE:"rgb(255, 222, 173)",NAVY:"rgb(0, 0, 128)",OLDLACE:"rgb(253, 245, 230)",OLIVE:"rgb(128, 128, 0)",OLIVEDRAB:"rgb(107, 142, 35)",ORANGE:"rgb(255, 165, 0)",ORANGERED:"rgb(255, 69, 0)",ORCHID:"rgb(218, 112, 214)",PALEGOLDENROD:"rgb(238, 232, 170)",PALEGREEN:"rgb(152, 251, 152)",PALETURQUOISE:"rgb(175, 238, 238)",PALEVIOLETRED:"rgb(219, 112, 147)",PAPAYAWHIP:"rgb(255, 239, 213)",PEACHPUFF:"rgb(255, 218, 185)",PERU:"rgb(205, 133, 63)",PINK:"rgb(255, 192, 203)",PLUM:"rgb(221, 160, 221)",POWDERBLUE:"rgb(176, 224, 230)",PURPLE:"rgb(128, 0, 128)",REBECCAPURPLE:"rgb(102, 51, 153)",RED:"rgb(255, 0, 0)",ROSYBROWN:"rgb(188, 143, 143)",ROYALBLUE:"rgb(65, 105, 225)",SADDLEBROWN:"rgb(139, 69, 19)",SALMON:"rgb(250, 128, 114)",SANDYBROWN:"rgb(244, 164, 96)",SEAGREEN:"rgb(46, 139, 87)",SEASHELL:"rgb(255, 245, 238)",SIENNA:"rgb(160, 82, 45)",SILVER:"rgb(192, 192, 192)",SKYBLUE:"rgb(135, 206, 235)",SLATEBLUE:"rgb(106, 90, 205)",SLATEGRAY:"rgb(112, 128, 144)",SLATEGREY:"rgb(112, 128, 144)",SNOW:"rgb(255, 250, 250)",SPRINGGREEN:"rgb(0, 255, 127)",STEELBLUE:"rgb(70, 130, 180)",TAN:"rgb(210, 180, 140)",TEAL:"rgb(0, 128, 128)",THISTLE:"rgb(216, 191, 216)",TOMATO:"rgb(255, 99, 71)",TRANSPARENT:"rgba(0,0,0,0)",TURQUOISE:"rgb(64, 224, 208)",VIOLET:"rgb(238, 130, 238)",WHEAT:"rgb(245, 222, 179)",WHITE:"rgb(255, 255, 255)",WHITESMOKE:"rgb(245, 245, 245)",YELLOW:"rgb(255, 255, 0)",YELLOWGREEN:"rgb(154, 205, 50)"};var b=class n{static{o(this,"Vector")}constructor(e,r,t){arguments.length===1&&(t=e.z,r=e.y,e=e.x),this.x=e,this.y=r,t!==void 0&&(this.z=t)}dist(e,r,t=0){r!==void 0&&(e={x:e,y:r,z:t});let x=0;x+=(this.x-e.x)**2,x+=(this.y-e.y)**2;let $=this.z?this.z:0,s=e.z?e.z:0;return x+=($-s)**2,x**.5}normalize(e){let r=this.dist(0,0,0);return new n(e*this.x/r,e*this.y/r,e*this.z/r)}getAngle(){return-Math.atan2(this.y,this.x)}reflect(e){let r=new n(e.x-this.x,e.y-this.y);return e.z!==void 0&&(r.z=e.z,this.z!==void 0&&(r.z-=this.z)),this.subtract(r)}add(e){let r=new n(this.x+e.x,this.y+e.y);return this.z!==void 0&&(r.z=this.z,e.z!==void 0&&(r.z+=e.z)),r}subtract(e){let r=new n(this.x-e.x,this.y-e.y);return this.z!==void 0&&(r.z=this.z,e.z!==void 0&&(r.z-=e.z)),r}scale(e=1){if(e===0)return new n(0,0,this.z===void 0?void 0:0);let r=new n(this.x*e,this.y*e);return this.z!==void 0&&(r.z=this.z*e),r}};function A(n,e,r,t){return W(n.x,n.y,e.x,e.y,r.x,r.y,t.x,t.y)}o(A,"lli");function W(n,e,r,t,x,$,s,i){let a=(n*t-e*r)*(x-s)-(n-r)*(x*i-$*s),g=(n*t-e*r)*($-i)-(e-t)*(x*i-$*s),f=(n-r)*($-i)-(e-t)*(x-s);return f==0?null:new b(a/f,g/f)}o(W,"__lli");var p=class{static{o(this,"Projector")}XY=new b(1,1,0);XZ=new b(1,0,1);YZ=new b(0,1,1);getPoints(e){throw new Error("getPoints() is not defined for Projector superclass")}getAxes(e){throw new Error("getAxes() is not defined for Projector superclass")}project(e,r,t=0){return project(new b(e,r,t))}projectXY(e,r,t){let x=e;return x instanceof b||(x=new b(e,r,0)),project(x.times(this.XY))}projectXZ(e,r,t){let x=e;return x instanceof b||(x=new b(e,0,t)),project(x.times(this.XZ))}projectYZ(e,r,t){let x=e;return x instanceof b||(x=new b(0,r,t)),project(x.times(YZ))}},S=class extends p{static{o(this,"CabinetProjector")}constructor(e=new b(0,0),r=-Math.PI/6){super(),this.offset=e,this.phi=r}getPoints(e){throw new Error("getPoints() is not defined for CabinetProjector class")}getAxes(e){throw new Error("getAxes() is not defined for CabinetProjector class")}project(e){let{offset:r,phi:t}=this,x=e.y,$=-e.z,s=-e.x/2;return new b(r.x+x+s*Math.cos(t),r.y+$+s*Math.sin(t))}},T=class extends p{static{o(this,"PerspectiveProjector")}perspectiveFactor=1.25;threePoint=!1;constructor(e,r,t){super(),this.O=e,this.X=t[0],this.Z=t[1],t.length===3&&(this.threePoint=!0,this.X=t[0],this.Y=t[1],this.Z=t[2]),this.HO=A(O,O.plus(0,10),Z,X),this.threePoint?this.perspectiveFactor=r:(this.dyO=O.y-HO.y,this.yFactor=dyO/r)}getPoints(e){return[X,Y!=null?Y:e.minus(new b(0,yFactor)),Z,O,HO]}getAxes(e){let r=getPoints(e);return[r[0].minus(e).normalize(),r[1].minus(e).normalize(),r[2].minus(e).normalize()]}stepToDistanceRatio(e){return 1-1/(1+this.perspectiveFactor*this.step)}project(e,r,t){let x=e;return x instanceof b&&(e=x.x,r=x.y,t=x.z),this.threePoint?this.get3(e,r,t):this.get2(e,r,t)}get3(e,r,t){if(e===0&&r===0&&t===0)return x;let{O:x,X:$,Y:s,Z:i}=this,a=x.to($,this.stepToDistanceRatio(e)),g=x.to(i,this.stepToDistanceRatio(t));if(r===0)return A($,g,i,a);let f=x.to(s,this.stepToDistanceRatio(r));return YZ=A(s,g,i,f),XY=A(s,a,$,f),A(XY,i,$,YZ)}get2(e,r,t){if(e===0&&r===0&&t===0)return x;let{O:x,X:$,Z:s,yFactor:i}=this,a=e==0?x:x.to($,this.stepToDistanceRatio(e)),g=t==0?x:x.to(s,this.stepToDistanceRatio(t)),f=A($,g,s,a);if(r===0)return f;let l=f.x<x.x,d=l?(f.x-s.x)/(x.x-s.x):($.x-f.x)/($.x-x.x),E=A(l?s:$,x,f,f.plus(0,10)),u=(f.y-HO.y)/(E.y-HO.y);return f.minus(0,d*u*r*i)}};function y(n,e,r,t,x,R,s){var i,a,g,f,l=r.length,d=r[0].length;if(e<1)throw new Error("degree must be at least 1 (linear)");if(e>l-1)throw new Error("degree must be less than or equal to point count - 1");if(!x)for(x=[],i=0;i<l;i++)x[i]=1;if(x.length<r.length&&(x=x.concat(x.slice(0,e))),t){if(t.length!==l+e+1)throw new Error("bad knot vector length")}else{var t=[];for(i=0;i<l+e+1;i++)t[i]=i}t.length===r.length&&(t=t.concat(t.slice(0,e)));var E=[e,t.length-1-e],u=t[E[0]],L=t[E[1]];if(s||(n=n*(L-u)+u),n<u||n>L)throw new Error("out of bounds");for(g=E[0];g<E[1]&&!(n>=t[g]&&n<=t[g+1]);g++);var h=[];for(i=0;i<l;i++){for(h[i]=[],a=0;a<d;a++)h[i][a]=r[i][a]*x[i];h[i][d]=x[i]}var N;for(f=1;f<=e+1;f++)for(i=g;i>g-e-1+f;i--)for(N=(n-t[i])/(t[i+e+1-f]-t[i]),a=0;a<d+1;a++)h[i][a]=(1-N)*h[i-1][a]+N*h[i][a];var R=R||[];for(i=0;i<d;i++)R[i]=h[g][i]/h[g][d];return R}o(y,"interpolate");var c=3,G=class{static{o(this,"BSpline")}constructor(e,r=!0){this.points=e,this.points=e.map(t=>t instanceof Array?t:[t.x,t.y]),this.formKnots(r),this.formWeights()}getLUT(e=100){let r=e-1;return[...new Array(e)].map((t,x)=>{let $=y(x/r,c,this.points,this.knots,this.weights);return{x:$[0],y:$[1]}})}formKnots(e=!1){if(!e)return this.formUniformKnots();let r=[],t=this.points.length,x=t-c;for(let $=1;$<t-c;$++)r.push($+c);for(let $=0;$<=c;$++)r=[c].concat(r);for(let $=0;$<=c;$++)r.push(x+c);return this.knots=r}formUniformKnots(){return this.knots=[...new Array(this.points.length+c+1)].map((e,r)=>r)}formWeights(){return this.weights=this.points.map(e=>1)}};var I=class{static{o(this,"Point")}constructor(e,r){this.x=e,this.y=r}},w=class extends I{static{o(this,"Circle")}constructor(e,r,t){super(e,r),this.r=t}};function _(n){if(n.length!==n[0].length){console.log("not square");return}var e=0,r=0,t=0,x=n.length,$=0,s=0,i=[],a=[];for(e=0;e<x;e+=1)for(i[i.length]=[],a[a.length]=[],t=0;t<x;t+=1)e==t?i[e][t]=1:i[e][t]=0,a[e][t]=n[e][t];for(e=0;e<x;e+=1){if($=a[e][e],$==0){for(r=e+1;r<x;r+=1)if(a[r][e]!=0){for(t=0;t<x;t++)$=a[e][t],a[e][t]=a[r][t],a[r][t]=$,$=i[e][t],i[e][t]=i[r][t],i[r][t]=$;break}if($=a[e][e],$==0)return}for(t=0;t<x;t++)a[e][t]=a[e][t]/$,i[e][t]=i[e][t]/$;for(r=0;r<x;r++)if(r!=e)for($=a[r][e],t=0;t<x;t++)a[r][t]-=$*a[e][t],i[r][t]-=$*i[e][t]}return i}o(_,"invert");function z(n,e){var r=[],t=k(e);return n.forEach((x,$)=>{r[$]=[],t.forEach((s,i)=>{r[$][i]=x.map((a,g)=>s[g]*a).reduce((a,g)=>a+g,0)})}),r}o(z,"multiply");function k(n){return n[0].map((e,r)=>n.map(t=>t[r]))}o(k,"transpose");var U=class n{static{o(this,"Matrix")}constructor(e,r,t){t=e instanceof Array?e:t,this.data=t??[...new Array(e)].map(x=>[...new Array(r)].map($=>0)),this.rows=this.data.length,this.cols=this.data[0].length}setData(e){this.data=e}get(e,r){return this.data[e][r]}set(e,r,t){this.data[e][r]=t}row(e){return this.data[e]}col(e){var r=this.data,t=[];for(let x=0,$=r.length;x<$;x++)t.push(r[x][e]);return t}multiply(e){return new n(z(this.data,e.data))}invert(){return new n(_(this.data))}transpose(){return new n(k(this.data))}};var B=String(import.meta.url),V=B.replace("element.js","api.js"),j=await fetch(V),q=await j.text();function F(n){let e=/^(.*)\/([^.]+(\.([^\/?#]+))+)(\?[^#]*)?(#.*)?$/,r=n.match(e);if(r!==null){let{[1]:t,[2]:x,[4]:$}=r;console.log(`URL is for a file "${x}", with extension "${$}"`),n=t}return n}o(F,"getURLbase");function Q(n){if(typeof window>"u"||typeof document>"u")return!0;var e=n.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}o(Q,"isInViewport");var C=class extends m{static{o(this,"GraphicsElement")}constructor(){super(),this.label=document.createElement("label"),this.title||(this.title=""),this.label.textContent=this.title}handleAttributeChange(...e){}handleChildChanges(...e){}connectedCallback(){super.connectedCallback(),Q(this)?this.loadSource():new IntersectionObserver((e,r)=>e.forEach(t=>{t.isIntersecting&&(this.loadSource(),r.disconnect())}),{threshold:.1,rootMargin:`${window.innerHeight}px`}).observe(this)}getStyle(){return`
      :host([hidden]) {
        display: none;
      }
      :host style {
        display: none;
      }
      :host .top-title {
        display: flex;
        flex-direction: row-reverse;
        justify-content: space-between;
      }
      :host canvas {
        touch-action: none;
        user-select: none;
        position: relative;
        z-index: 1;
        display: block;
        margin: auto;
        border-radius: 0;
        box-sizing: content-box!important;
        border: 1px solid lightgrey;
      }
      :host canvas.crisp {
        image-rendering: -moz-crisp-edges;
        image-rendering: -webkit-crisp-edges;
        image-rendering: pixelated;
        image-rendering: crisp-edges;
      }
      :host canvas:focus {
        border: 1px solid red;
      }
      :host a.view-source {
        font-size: 60%;
        text-decoration: none;
      }
      :host button.reset {
        font-size: 0.5em;
        top: -0.35em;
        position: relative;
      }
      :host label:not(:empty) {
        display: block;
        font-style:italic;
        font-size: 0.9em;
        text-align: right;
        padding-right: 1em;
        margin-top: 0.35em;
      }
    `}async loadSource(e,r){e&&r&&(this.style.width=e,this.style.height=r);let t=this.getAttribute("src"),x=await(await fetch(t)).text(),$=x.matchAll(/addSlider\(['"`](.*)['"`],\s*/g),s=[];for(let f of $)s.push(f[1]),x=x.replace(f[0],f[0]+`(v) => (${f[1]} = v), `);s.length&&(x="let "+s.join(", ")+`;
`+x),x=x.replaceAll(/ from ['"].([^'"]+)['"]/g,` from "${F(location.href)}/$1"`);let i=this.getAttribute("width"),a=this.getAttribute("height");i&&a&&(x=x.replace("function setup() {",`function setup() {
  setSize(${i}, ${a});`)),import(`data:text/javascript;base64,${J([`import { CabinetProjector, PerspectiveProjector, BSpline, Point, Circle, Vector, Matrix, CSS_COLOR_MAP } from "${B}";`,`const __randomId = "${Date.now()}";`,q,x,"export { reset as start, __canvas as canvas, halt, highlight }"].join(`
`))}`).then(f=>{let{start:l,canvas:d,halt:E,highlight:u}=f;this.canvas=d,this.halt=()=>E(),this.highlight=L=>u(L),this.render(),e&&r&&(this.style.width="",this.style.height=""),l(this),this.dispatchEvent(new CustomEvent("load")),this.onload&&this.onload()})}render(){super.render();let e=this._slot.parentNode;this.canvas&&e.insertBefore(this.canvas,this._slot),this.label&&e.insertBefore(this.label,this._slot);let r=document.createElement("div");r.classList.add("top-title");let t=document.createElement("button");t.classList.add("reset"),t.textContent=this.getAttribute("reset")||"reset",t.addEventListener("click",()=>{let{width:$,height:s}=this.halt();this.crosslinked=!1,this.querySelector("button.remove-color")?.remove(),this.loadSource($,s)}),r.append(t);let x=this.getAttribute("src");if(x){let $=document.createElement("a");$.classList.add("view-source"),$.textContent=this.getAttribute("viewSource")||"view source",$.href=x,$.target="_blank",r.append($)}this.label&&e.insertBefore(r,this.canvas),this.crosslink()}crosslink(){if(this.crosslinked)return;this.crosslinked=!0;let e=!1;if(this.querySelectorAll("p").forEach(r=>{r.querySelectorAll("*").forEach(t=>{if(!D.includes(t.tagName))return;e=!0;let x;t.classList.remove("calm"),t.addEventListener("pointerenter",()=>{x??=getComputedStyle(t)["-webkit-text-stroke-color"],this.highlight(x)}),t.addEventListener("pointerleave",()=>this.highlight(!1))})}),e){let r=document.createElement("button");r.textContent="remove colors",r.classList.add("remove-color"),r.addEventListener("click",()=>{this.querySelectorAll("p").forEach(t=>{t.querySelectorAll("*").forEach(x=>{D.includes(x.tagName)&&x.classList.add("calm")})}),r.remove()}),this.append(r)}}};function J(n){let e=new TextEncoder().encode(n),r=String.fromCodePoint(...e);return btoa(r)}o(J,"base64");await m.register(C);export{G as BSpline,K as CSS_COLOR_MAP,S as CabinetProjector,w as Circle,U as Matrix,T as PerspectiveProjector,I as Point,b as Vector};
